<!DOCTYPE "html"> 
<html lang="en">
<head>
<meta charset="utf-8" />
<style type="text/css">
body {
background-color: #040724;
color: white;
font-family: sans-serif;
width: 800px;
font-size: 120%;
}
.tta {background: #ffff00}
.timestamp {font-size: x-small}
td, table, tr, th {
border-collapse: collapse;
border: solid black 1px;
padding: 3px;
}
.species {font-style: italic}
.genus {font-style: italic}
a:link, a:visited, a:active {color: blue; text-decoration: none}
a:hover {color: magenta; text-decoration: none}
</style>
</head>

<!--
% Introduction to R
% January 2023
% Sun 22 Jan 2023
-->
<!-- vim: tw=60 nosmartindent fmr=<<<,>>> cms=<!--%s-->
<!-- set tw=60 nosmartindent fmr=<<<,>>> cms=<!--%s -->
<!-- <<< readme.md -->
<h1 id="readme.md">readme.md</h1>
<h1 id="advanced-r-30-jan-and-1-feb-2023">Advanced R 30 Jan and 1 Feb 2023</h1>
<h1 id="httpsbit.ly3ppbwwc"><a href="https://bit.ly/3pPBwwC">https://bit.ly/3pPBwwC</a></h1>
<h2 id="timings-for-both-mon-30-jan-and-wed-1-feb-2023">Timings for both Mon 30 Jan and Wed 1 Feb 2023</h2>
<table>
<tbody>
<tr class="odd">
<td style="text-align: left;">Course</td>
<td>0930 to 1100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Coffee break</td>
<td>1100 to 1130</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Course</td>
<td>1130 to 1300</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lunch</td>
<td>1300 to 1400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Course</td>
<td>1400 to 1530</td>
</tr>
<tr class="even">
<td style="text-align: left;">Coffee break</td>
<td>1530 to 1600</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Course</td>
<td>1600 to 1730</td>
</tr>
</tbody>
</table>
<h2 id="as-soon-as-you-arrive">As soon as you arrive</h2>
<ul>
<li><p>Login to a PC in the training theatre using your institute identity. This will ensure that everything you do during this course will be available to you after the course.</p></li>
<li><p>Point your web browser to the url shown at the top which is <a href="https://bit.ly/3pPBwwC">https://bit.ly/3pPBwwC</a> which is the same as <a href="https://streptomyces.github.io/advancedR/">https://streptomyces.github.io/advancedR/</a>.</p></li>
</ul>
<h2 id="how-will-this-course-work">How will this course work?</h2>
<ul>
<li>I will talk about commands and syntax.</li>
<li>You will run some commands along with me to see them in action.</li>
<li>I will explain the commands and the syntax you have just seen in action.</li>
</ul>
<h3 id="sometimes-there-will-be-things-for-you-to-do-on-your-own.">Sometimes there will be things for you to do on your own.</h3>
<ul>
<li>These tasks will be described in plain english.</li>
<li>You will have to think how to achieve them in R using as many steps as you need.</li>
<li>Finally, I will show you how I would have done the tasks but keep in mind that, if you got the right results, your way of doing them may also be correct.</li>
</ul>
<h2 id="limitations">Limitations</h2>
<ul>
<li>The focus of this course is on R syntax and techniques rather than statistics.</li>
<li>The aim is to clarify the workings of R so that you can build your own data analysis solutions and workflows.</li>
</ul>
<p><a href="rstudio.html">Preparations</a></p>
<p><a href="readme.html">.</a></p>
<!-- >>> -->
<!-- <<< rstudio.md -->
<h1 id="rstudio.md">rstudio.md</h1>
<h1 id="rstudio">RStudio</h1>
<ul>
<li>Start RStudio.</li>
</ul>
<h2 id="getting-the-scripts-and-data-we-will-be-using">Getting the scripts and data we will be using</h2>
<p>In Rstudio, use the drop down menu to do</p>
<pre><code>File -&gt; New File -&gt; R Script</code></pre>
<p>In the blank R script we will write and run the lines of code shown below. Please do this with me so I can explain each step.</p>
<pre><code>setwd(&quot;u:/&quot;)
unlink(&quot;Rtrain&quot;, recursive = TRUE)
dir.create(&quot;Rtrain&quot;)

setwd(&quot;Rtrain&quot;)

getwd()

unlink(&quot;*&quot;)

list.files()

download.file(&quot;https://github.com/streptomyces/advancedR/raw/jan2023/adr.zip&quot;, &quot;adr.zip&quot;)
# download.file(&quot;https://streptomyces.s3.eu-west-1.amazonaws.com/adr.zip&quot;, &quot;adr.zip&quot;);

list.files()

unzip(&quot;adr.zip&quot;)

setwd(&quot;adr&quot;)

list.files()</code></pre>
<h3 id="four-panes">Four panes</h3>
<ul>
<li>Source editor</li>
<li>Console</li>
<li>Environment and History</li>
<li>File, Plots, Help etc.</li>
</ul>
<h3 id="getting-started">Getting started</h3>
<ul>
<li><p>Type commands in the <em>source</em> editor.</p></li>
<li><p>To run a command from the <em>source</em> editor place the cursor anywhere on that line and press <code>Control-Enter</code>.</p></li>
<li><p>You can also select multiple lines and then press <code>Control-Enter</code> to run all the selected lines.</p></li>
<li><p>Finally, you can use <code>Control-Shift-Enter</code> to <em>source</em> (i.e. run) the entire script.</p></li>
<li><p>The action happens in the <em>Console</em> pane. i.e. any output from R is shown in the console frame. You can also type commands directly in the console.</p></li>
<li><p>R keeps a history of your commands which you can see in the history tab of RStudio.</p></li>
<li><p>You can select and run commands from the history tab as well. Just press enter on the current line or select some lines and press enter.</p></li>
<li><p>However you run a command, it is like typing it into the console and pressing Enter.</p></li>
<li><p>Matching parentheses and quotes are automatically inserted. You can disable this in options. I do. (<code>Tools -&gt; Global Options -&gt; Code -&gt; Editing</code>)</p></li>
</ul>
<h4 id="my-preferred-arrangement-of-rstudio-panes">My preferred arrangement of RStudio panes</h4>
<p>Use the drop down menus to do the following.</p>
<pre><code>Tools -&gt; Global Options -&gt; Pane layout</code></pre>
<p>Arrange to have <em>Source</em> on the top left and <em>Console</em> on the top right. With this arrangement we can minimise two bottom panes most of the time and have more of screen space.</p>
<!-- >>> -->
<!-- <<< r.md -->
<h1 id="r.md">r.md</h1>
<h1 id="r">R</h1>
<ul>
<li>Comments begin with #. Everything after a # until the end of the line is ignored by R.</li>
</ul>
<h3 id="some-syntax-identifying-features">Some syntax identifying features</h3>
<pre><code>&lt;- and =        Assignment                  x &lt;- 42            
                                            x = 42

-&gt;              Rightward assignment        42 -&gt; x

Function        Unquoted word followed      mean()
call            by parentheses

Object name     Unquoted word               gene.lens

String          Quoted alphanumeric         &quot;whiA&quot;
literals        characters

Numeric         Unquoted digits and         2345, 42L, 3.14
literals        scientific notation         1e6, 1e-6</code></pre>
<ul>
<li><p>Parentheses, (), are required in function calls even if you are not passing any arguments to the function being called. <code>ls()</code> works but <code>ls</code> shows you the definition of the function <code>ls</code>.</p></li>
<li>The other two bracketing characters are
<ul>
<li>Brackets or square brackets <code>[]</code></li>
<li>Braces or curly braces <code>{}</code></li>
</ul></li>
<li><p>The parentheses makes it easy to identify individual function calls in long and complex R statements where function calls are embedded within other function calls.</p></li>
<li><p>Unquoted words which are not reserved words are assumed to be object names.</p></li>
<li><p>Almost no restrictions on names but see <code>help("Quotes")</code> and <code>help("make.names")</code>. Use meaningful names.</p></li>
</ul>
<pre><code>    mean &lt;- c(2,3,4,5); # example of bad name.
    mean(mean);</code></pre>
<ul>
<li><p>Commands can continue over multiple lines.</p></li>
<li><p>Semicolons are only needed if you put two commands on one line.</p></li>
</ul>
<pre><code>    x &lt;- 3; y &lt;- x * 3; x; y</code></pre>
<ul>
<li>If you get inside a complicated command which you cannot finish, try Escape (Control-C in Linux) to bail out. This usually happens because of unmatched parentheses or quotes.</li>
</ul>
<h2 id="names-are-free">Names are free!</h2>
<ul>
<li><p>While doing the tasks during this course you will not always be explicitly asked name your objects.</p></li>
<li><p>Name your objects as needed. e.g. if a task says make a vector of the numbers 1 to 10 do</p></li>
</ul>
<pre><code>x &lt;- seq(1,10);</code></pre>
<p>instead of</p>
<pre><code>seq(1,10);</code></pre>
<ul>
<li><p>Then you will have a named object you can use in the following steps of the task.</p></li>
<li><p>Use as many intermediate objects as you need to complete the task.</p></li>
<li><p>For example, if asked to generate 20 normally distributed numbers, take their log2 and, find the median.</p></li>
</ul>
<pre><code>x &lt;- rnorm(20, mean = 30, sd = 1.2)
xl2 &lt;- log2(x);
median(xl2);</code></pre>
<p>The same in one step.</p>
<pre><code>median(log2(rnorm(20, mean = 30, sd = 1.2)))</code></pre>
<p><em>Work at a level of complexity that you are comfortable with.</em></p>
<h2 id="data-analysis-cycle">Data analysis cycle</h2>
<h4 id="experiment">Experiment</h4>
<ol type="1">
<li>Experiment</li>
<li>Data</li>
<li>Data analysis</li>
<li>Go to 1.</li>
</ol>
<h4 id="data-analysis">Data analysis</h4>
<ol type="1">
<li>Data file(s) from experiment</li>
<li>Cleaning up and formatting</li>
<li>Reading into objects</li>
<li>Apply functions to manipulate the objects</li>
<li>Repeat above as required</li>
<li>Make plots</li>
<li>Write out to files for further work or communication</li>
</ol>
<h4 id="keep-your-environment-clean">Keep your environment clean</h4>
<p>I will start the code in almost every topic with <code>rm(list = ls())</code>. This is to make sure that there are no old variables lying around to mess with the current task.</p>
<p>This is also important during actual work.</p>
<!-- >>> -->
<!-- <<< datatypes.r -->
<h1 id="datatypes">Datatypes</h1>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="co">########################</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co">### Basic data types </span><span class="al">###</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co">########################</span></a>
<a class="sourceLine" id="cb11-5" title="5"></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co"># Character (strings of characters)</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co"># Numbers</span></a>
<a class="sourceLine" id="cb11-8" title="8">  <span class="co">## Integers</span></a>
<a class="sourceLine" id="cb11-9" title="9">  <span class="co">## Real (double precision floating point numbers)</span></a>
<a class="sourceLine" id="cb11-10" title="10"><span class="co"># Logical. TRUE or FALSE only.</span></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co"># Complex</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co"># Raw</span></a>
<a class="sourceLine" id="cb11-13" title="13"></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co"># We will not bother with the Complex and Raw types.</span></a>
<a class="sourceLine" id="cb11-15" title="15"></a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co"># Mostly we don&#39;t have to worry whether our numbers</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="co"># are integers or doubles but there are some situations</span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="co"># where we should. There are functions to coerce one</span></a>
<a class="sourceLine" id="cb11-19" title="19"><span class="co"># into another if needed.</span></a>
<a class="sourceLine" id="cb11-20" title="20"></a>
<a class="sourceLine" id="cb11-21" title="21"><span class="co"># Explain x &lt;- 42L</span></a>
<a class="sourceLine" id="cb11-22" title="22"></a>
<a class="sourceLine" id="cb11-23" title="23">x &lt;-<span class="st"> </span><span class="dv">42</span>;</a>
<a class="sourceLine" id="cb11-24" title="24"></a>
<a class="sourceLine" id="cb11-25" title="25">y &lt;-<span class="st"> </span>42L;</a>
<a class="sourceLine" id="cb11-26" title="26"></a>
<a class="sourceLine" id="cb11-27" title="27"><span class="kw">typeof</span>(x);</a>
<a class="sourceLine" id="cb11-28" title="28"></a>
<a class="sourceLine" id="cb11-29" title="29"><span class="kw">typeof</span>(y);</a>
<a class="sourceLine" id="cb11-30" title="30"></a>
<a class="sourceLine" id="cb11-31" title="31"><span class="co">### More data types </span><span class="al">###</span></a>
<a class="sourceLine" id="cb11-32" title="32"></a>
<a class="sourceLine" id="cb11-33" title="33"><span class="co"># Lists</span></a>
<a class="sourceLine" id="cb11-34" title="34"><span class="co"># Functions (closures)</span></a>
<a class="sourceLine" id="cb11-35" title="35"><span class="co"># Environments</span></a>
<a class="sourceLine" id="cb11-36" title="36"><span class="co"># Builtin</span></a>
<a class="sourceLine" id="cb11-37" title="37"></a></code></pre></div>
<!-- >>> -->
<!-- <<< objects.r -->
<h1 id="objects">Objects</h1>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#######################</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="co">### Data structures </span><span class="al">###</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">#######################</span></a>
<a class="sourceLine" id="cb12-5" title="5"></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co"># Types which are combinations of the basic data types.</span></a>
<a class="sourceLine" id="cb12-7" title="7"></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co"># Can be arbitrarily complex.</span></a>
<a class="sourceLine" id="cb12-9" title="9"></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co"># Several provided by R as classes.</span></a>
<a class="sourceLine" id="cb12-11" title="11"></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="co">###############</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="co">### Classes </span><span class="al">###</span></a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">###############</span></a>
<a class="sourceLine" id="cb12-15" title="15"></a>
<a class="sourceLine" id="cb12-16" title="16"><span class="co"># Data structures with associated functions (methods).</span></a>
<a class="sourceLine" id="cb12-17" title="17"></a>
<a class="sourceLine" id="cb12-18" title="18"><span class="co"># A class is a recipe for making objects and &quot;constructor&quot;</span></a>
<a class="sourceLine" id="cb12-19" title="19"><span class="co"># methods are usually provided.</span></a>
<a class="sourceLine" id="cb12-20" title="20"></a>
<a class="sourceLine" id="cb12-21" title="21"><span class="co">###############</span></a>
<a class="sourceLine" id="cb12-22" title="22"><span class="co">### Objects </span><span class="al">###</span></a>
<a class="sourceLine" id="cb12-23" title="23"><span class="co">###############</span></a>
<a class="sourceLine" id="cb12-24" title="24"></a>
<a class="sourceLine" id="cb12-25" title="25"><span class="co"># Objects are &quot;instances&quot; of classes.</span></a>
<a class="sourceLine" id="cb12-26" title="26"></a>
<a class="sourceLine" id="cb12-27" title="27"><span class="co"># Objects of a class have all the methods of the class</span></a>
<a class="sourceLine" id="cb12-28" title="28"><span class="co"># available to them.</span></a>
<a class="sourceLine" id="cb12-29" title="29"></a>
<a class="sourceLine" id="cb12-30" title="30"><span class="co"># Objects can be of more than one class. Then they have</span></a>
<a class="sourceLine" id="cb12-31" title="31"><span class="co"># methods of all the classes available to them.</span></a>
<a class="sourceLine" id="cb12-32" title="32"></a>
<a class="sourceLine" id="cb12-33" title="33"><span class="co"># There are no simple variables in R. Everything is an object i.e.</span></a>
<a class="sourceLine" id="cb12-34" title="34"><span class="co"># belongs to one class or another.</span></a>
<a class="sourceLine" id="cb12-35" title="35"></a>
<a class="sourceLine" id="cb12-36" title="36"><span class="co"># Even if you need to store just one value you use an object</span></a>
<a class="sourceLine" id="cb12-37" title="37"><span class="co"># that is capable of storing multiple values.</span></a>
<a class="sourceLine" id="cb12-38" title="38"></a>
<a class="sourceLine" id="cb12-39" title="39"><span class="co"># Function ls() will list all objects in existence.</span></a>
<a class="sourceLine" id="cb12-40" title="40"></a>
<a class="sourceLine" id="cb12-41" title="41"><span class="kw">ls</span>()</a></code></pre></div>
<!-- >>> -->
<!-- <<< variables.r -->
<h1 id="variables">Variables</h1>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="co">####################################</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="co">### Names, symbols and, bindings </span><span class="al">###</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="co">####################################</span></a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="co"># Names (or symbols) are handles or labels for objects</span></a>
<a class="sourceLine" id="cb13-7" title="7"><span class="co"># through which we can access the objects.</span></a>
<a class="sourceLine" id="cb13-8" title="8"></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co"># After an assignment like below.</span></a>
<a class="sourceLine" id="cb13-10" title="10"></a>
<a class="sourceLine" id="cb13-11" title="11">x &lt;-<span class="st"> </span><span class="dv">42</span>;</a>
<a class="sourceLine" id="cb13-12" title="12"></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co">#     the name &quot;x&quot; has the value 42.</span></a>
<a class="sourceLine" id="cb13-14" title="14"></a>
<a class="sourceLine" id="cb13-15" title="15"><span class="co">#     the value 42 has a label attached to it with &quot;x&quot;</span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="co">#     written on the label.</span></a>
<a class="sourceLine" id="cb13-17" title="17"></a>
<a class="sourceLine" id="cb13-18" title="18"><span class="co">#     The name &quot;x&quot; is bound to the value 42.</span></a>
<a class="sourceLine" id="cb13-19" title="19"></a>
<a class="sourceLine" id="cb13-20" title="20"><span class="co">#     Explain unbound (non-existent) names.</span></a>
<a class="sourceLine" id="cb13-21" title="21"></a>
<a class="sourceLine" id="cb13-22" title="22"><span class="co"># It is not accurate to imagine x to be a container</span></a>
<a class="sourceLine" id="cb13-23" title="23"><span class="co"># containing the value 42.</span></a>
<a class="sourceLine" id="cb13-24" title="24"></a>
<a class="sourceLine" id="cb13-25" title="25"><span class="co"># Nothing prevents two different names from refering to</span></a>
<a class="sourceLine" id="cb13-26" title="26"><span class="co"># the same object. In fact this is what happens after</span></a>
<a class="sourceLine" id="cb13-27" title="27"></a>
<a class="sourceLine" id="cb13-28" title="28">y &lt;-<span class="st"> </span>x;</a>
<a class="sourceLine" id="cb13-29" title="29"></a>
<a class="sourceLine" id="cb13-30" title="30"><span class="co"># What happens when rm is invoked?</span></a>
<a class="sourceLine" id="cb13-31" title="31"></a>
<a class="sourceLine" id="cb13-32" title="32"><span class="kw">rm</span>(x);</a></code></pre></div>
<!-- >>> -->
<!-- <<< vectors.r -->
<h1 id="vectors">Vectors</h1>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="co">###############</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="co">### Vectors </span><span class="al">###</span></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co">###############</span></a>
<a class="sourceLine" id="cb14-5" title="5"></a>
<a class="sourceLine" id="cb14-6" title="6"><span class="co"># Strictly speaking, &quot;atomic vectors&quot;.</span></a>
<a class="sourceLine" id="cb14-7" title="7"></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co"># Ordered collection of values.</span></a>
<a class="sourceLine" id="cb14-9" title="9"></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co"># Contiguous cells containing data.</span></a>
<a class="sourceLine" id="cb14-11" title="11"></a>
<a class="sourceLine" id="cb14-12" title="12"><span class="co"># All values have to be of the same type.</span></a>
<a class="sourceLine" id="cb14-13" title="13"></a>
<a class="sourceLine" id="cb14-14" title="14"><span class="co"># They can hold values of any of the basic types.</span></a>
<a class="sourceLine" id="cb14-15" title="15"></a>
<a class="sourceLine" id="cb14-16" title="16"><span class="co"># One way of making a vector is by using the c() function.</span></a>
<a class="sourceLine" id="cb14-17" title="17"><span class="co"># (concatenate).</span></a>
<a class="sourceLine" id="cb14-18" title="18"></a>
<a class="sourceLine" id="cb14-19" title="19"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb14-20" title="20"></a>
<a class="sourceLine" id="cb14-21" title="21">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb14-22" title="22"></a>
<a class="sourceLine" id="cb14-23" title="23"><span class="co"># Cells are accessible through subscripting / indexing.</span></a>
<a class="sourceLine" id="cb14-24" title="24"><span class="co"># e.g. if vector x contains 10, 20 and 30 then</span></a>
<a class="sourceLine" id="cb14-25" title="25"></a>
<a class="sourceLine" id="cb14-26" title="26">x[<span class="dv">1</span>] <span class="co"># refers to 10,</span></a>
<a class="sourceLine" id="cb14-27" title="27">x[<span class="dv">2</span>] <span class="co"># refers to 20 and,</span></a>
<a class="sourceLine" id="cb14-28" title="28">x[<span class="dv">3</span>] <span class="co"># refers to 30</span></a>
<a class="sourceLine" id="cb14-29" title="29"></a>
<a class="sourceLine" id="cb14-30" title="30"><span class="co"># Indexing begins from one, not zero.</span></a>
<a class="sourceLine" id="cb14-31" title="31"></a>
<a class="sourceLine" id="cb14-32" title="32"></a>
<a class="sourceLine" id="cb14-33" title="33">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.9</span>, <span class="fl">4.1</span>, <span class="fl">3.9</span>, <span class="fl">4.5</span>, <span class="fl">3.7</span>, <span class="fl">45.3</span>, <span class="fl">21.6</span>);</a>
<a class="sourceLine" id="cb14-34" title="34"></a>
<a class="sourceLine" id="cb14-35" title="35">x;</a>
<a class="sourceLine" id="cb14-36" title="36"></a>
<a class="sourceLine" id="cb14-37" title="37">x[<span class="dv">1</span>];</a>
<a class="sourceLine" id="cb14-38" title="38"></a>
<a class="sourceLine" id="cb14-39" title="39">x[<span class="dv">7</span>];</a>
<a class="sourceLine" id="cb14-40" title="40"></a>
<a class="sourceLine" id="cb14-41" title="41">x[<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>]   <span class="co"># &quot;:&quot; is the range operator. Step by 1 only.</span></a>
<a class="sourceLine" id="cb14-42" title="42"></a>
<a class="sourceLine" id="cb14-43" title="43"></a>
<a class="sourceLine" id="cb14-44" title="44"><span class="co"># The simplest data type in R is a vector.</span></a>
<a class="sourceLine" id="cb14-45" title="45"></a>
<a class="sourceLine" id="cb14-46" title="46">y &lt;-<span class="st"> </span><span class="fl">5.4</span>; <span class="co"># is the same as y &lt;- c(5.4);</span></a>
<a class="sourceLine" id="cb14-47" title="47"></a>
<a class="sourceLine" id="cb14-48" title="48">y;</a>
<a class="sourceLine" id="cb14-49" title="49"></a>
<a class="sourceLine" id="cb14-50" title="50">y[<span class="dv">1</span>];</a>
<a class="sourceLine" id="cb14-51" title="51"></a>
<a class="sourceLine" id="cb14-52" title="52">z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ftsZ&quot;</span>, <span class="st">&quot;sigE&quot;</span>, <span class="st">&quot;bldN&quot;</span>, <span class="st">&quot;whiA&quot;</span>, <span class="st">&quot;whiB&quot;</span>, <span class="st">&quot;rdlA&quot;</span>, <span class="st">&quot;chpA&quot;</span>);</a>
<a class="sourceLine" id="cb14-53" title="53">z;</a>
<a class="sourceLine" id="cb14-54" title="54">z[<span class="dv">3</span>];</a>
<a class="sourceLine" id="cb14-55" title="55"></a>
<a class="sourceLine" id="cb14-56" title="56"><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb14-57" title="57"><span class="kw">length</span>(z)</a>
<a class="sourceLine" id="cb14-58" title="58"></a>
<a class="sourceLine" id="cb14-59" title="59"></a>
<a class="sourceLine" id="cb14-60" title="60"><span class="co">### Named Vectors </span><span class="al">###</span></a>
<a class="sourceLine" id="cb14-61" title="61"></a>
<a class="sourceLine" id="cb14-62" title="62"><span class="co"># Elements of a vector can be named</span></a>
<a class="sourceLine" id="cb14-63" title="63"></a>
<a class="sourceLine" id="cb14-64" title="64"><span class="kw">names</span>(x) &lt;-<span class="st"> </span>z;</a>
<a class="sourceLine" id="cb14-65" title="65">x;</a>
<a class="sourceLine" id="cb14-66" title="66"><span class="kw">names</span>(x);</a>
<a class="sourceLine" id="cb14-67" title="67"></a>
<a class="sourceLine" id="cb14-68" title="68"><span class="co"># Several functions can act as getters and setters.</span></a>
<a class="sourceLine" id="cb14-69" title="69"></a>
<a class="sourceLine" id="cb14-70" title="70"><span class="kw">names</span>(x)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;rsiG&quot;</span>;</a>
<a class="sourceLine" id="cb14-71" title="71"><span class="kw">names</span>(x);</a>
<a class="sourceLine" id="cb14-72" title="72"></a>
<a class="sourceLine" id="cb14-73" title="73"></a>
<a class="sourceLine" id="cb14-74" title="74">x[<span class="st">&quot;whiA&quot;</span>]; <span class="co"># is the same as x[4];</span></a>
<a class="sourceLine" id="cb14-75" title="75"></a>
<a class="sourceLine" id="cb14-76" title="76">v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;whiA&quot;</span>, <span class="st">&quot;rdlA&quot;</span>);</a>
<a class="sourceLine" id="cb14-77" title="77"></a>
<a class="sourceLine" id="cb14-78" title="78">x[v];</a>
<a class="sourceLine" id="cb14-79" title="79"></a>
<a class="sourceLine" id="cb14-80" title="80"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb14-81" title="81"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb14-82" title="82"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb14-83" title="83"></a>
<a class="sourceLine" id="cb14-84" title="84"><span class="co"># 1. Make the vectors x and z as discussed above.</span></a>
<a class="sourceLine" id="cb14-85" title="85"></a>
<a class="sourceLine" id="cb14-86" title="86"><span class="co"># 2. Name the elements of x as the strings in z.</span></a>
<a class="sourceLine" id="cb14-87" title="87"></a>
<a class="sourceLine" id="cb14-88" title="88"><span class="co"># 3. Examine the output of</span></a>
<a class="sourceLine" id="cb14-89" title="89"></a>
<a class="sourceLine" id="cb14-90" title="90"><span class="kw">unname</span>(x)</a></code></pre></div>
<!-- >>> -->
<!-- <<< functions.r -->
<h1 id="functions">Functions</h1>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="co">#################</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co">### Functions </span><span class="al">###</span></a>
<a class="sourceLine" id="cb15-4" title="4"><span class="co">#################</span></a>
<a class="sourceLine" id="cb15-5" title="5"></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co"># Functions do things for us.</span></a>
<a class="sourceLine" id="cb15-7" title="7"></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co"># Need arguments to work on.</span></a>
<a class="sourceLine" id="cb15-9" title="9"></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co"># May assume default arguments if none are provided.</span></a>
<a class="sourceLine" id="cb15-11" title="11"></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co"># May return something which you may wish to store as a</span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co"># new object.</span></a>
<a class="sourceLine" id="cb15-14" title="14"></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co"># If you are not assigning the returned value to an object</span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co"># then the returned value may be printed on the console.</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="co"># invisible()</span></a>
<a class="sourceLine" id="cb15-18" title="18"></a>
<a class="sourceLine" id="cb15-19" title="19"><span class="co"># Some functions are used primarily for their</span></a>
<a class="sourceLine" id="cb15-20" title="20"><span class="co"># side-effects rather than their return value.</span></a>
<a class="sourceLine" id="cb15-21" title="21"></a>
<a class="sourceLine" id="cb15-22" title="22"><span class="co"># User defined functions.</span></a>
<a class="sourceLine" id="cb15-23" title="23"></a>
<a class="sourceLine" id="cb15-24" title="24"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb15-25" title="25"></a>
<a class="sourceLine" id="cb15-26" title="26">bmi &lt;-<span class="st"> </span><span class="cf">function</span>(kilograms, metres) {</a>
<a class="sourceLine" id="cb15-27" title="27">  <span class="kw">return</span>(kilograms <span class="op">/</span><span class="st"> </span>metres <span class="op">**</span><span class="st"> </span><span class="dv">2</span>);</a>
<a class="sourceLine" id="cb15-28" title="28">}</a>
<a class="sourceLine" id="cb15-29" title="29"></a>
<a class="sourceLine" id="cb15-30" title="30"><span class="kw">bmi</span>(<span class="dv">65</span>, <span class="fl">1.65</span>);</a>
<a class="sourceLine" id="cb15-31" title="31"></a>
<a class="sourceLine" id="cb15-32" title="32"><span class="co">### Components of functions </span><span class="al">###</span></a>
<a class="sourceLine" id="cb15-33" title="33"></a>
<a class="sourceLine" id="cb15-34" title="34"><span class="co">#  1. Formal argument list.</span></a>
<a class="sourceLine" id="cb15-35" title="35"><span class="co">#  2. Body</span></a>
<a class="sourceLine" id="cb15-36" title="36"><span class="co">#  3. Environment</span></a>
<a class="sourceLine" id="cb15-37" title="37"></a>
<a class="sourceLine" id="cb15-38" title="38"><span class="co">### Arguments</span></a>
<a class="sourceLine" id="cb15-39" title="39"></a>
<a class="sourceLine" id="cb15-40" title="40"><span class="co"># Arguments are values or objects a function acts on. The</span></a>
<a class="sourceLine" id="cb15-41" title="41"><span class="co"># process of getting arguments into functions is called</span></a>
<a class="sourceLine" id="cb15-42" title="42"><span class="co"># argument passing.</span></a>
<a class="sourceLine" id="cb15-43" title="43"></a>
<a class="sourceLine" id="cb15-44" title="44"><span class="co"># Supplied arguments are matched to formal arguments in a</span></a>
<a class="sourceLine" id="cb15-45" title="45"><span class="co"># three pass process.</span></a>
<a class="sourceLine" id="cb15-46" title="46"></a>
<a class="sourceLine" id="cb15-47" title="47"><span class="co">#  1. Exact matching on tags</span></a>
<a class="sourceLine" id="cb15-48" title="48"><span class="co">#  2. Partial matching on tags</span></a>
<a class="sourceLine" id="cb15-49" title="49"><span class="co">#  3. Positional matching.</span></a>
<a class="sourceLine" id="cb15-50" title="50"></a>
<a class="sourceLine" id="cb15-51" title="51"><span class="co"># We will use the seq() function of R as an example.</span></a>
<a class="sourceLine" id="cb15-52" title="52"></a>
<a class="sourceLine" id="cb15-53" title="53"><span class="co"># positional arguments</span></a>
<a class="sourceLine" id="cb15-54" title="54"><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>);</a>
<a class="sourceLine" id="cb15-55" title="55"></a>
<a class="sourceLine" id="cb15-56" title="56"><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dv">2</span>);</a>
<a class="sourceLine" id="cb15-57" title="57"></a>
<a class="sourceLine" id="cb15-58" title="58"><span class="co"># Positional and named arguments</span></a>
<a class="sourceLine" id="cb15-59" title="59"><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>);</a>
<a class="sourceLine" id="cb15-60" title="60"></a>
<a class="sourceLine" id="cb15-61" title="61"><span class="co"># Named arguments only</span></a>
<a class="sourceLine" id="cb15-62" title="62"><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>);</a>
<a class="sourceLine" id="cb15-63" title="63"></a>
<a class="sourceLine" id="cb15-64" title="64"><span class="co"># Positional and named arguments</span></a>
<a class="sourceLine" id="cb15-65" title="65"><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>);</a>
<a class="sourceLine" id="cb15-66" title="66"></a>
<a class="sourceLine" id="cb15-67" title="67"><span class="co"># Positional and named arguments</span></a>
<a class="sourceLine" id="cb15-68" title="68"><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dt">by =</span> <span class="dv">2</span>, <span class="dv">10</span>);</a>
<a class="sourceLine" id="cb15-69" title="69"></a>
<a class="sourceLine" id="cb15-70" title="70"><span class="co"># Partial matching of argument names</span></a>
<a class="sourceLine" id="cb15-71" title="71"><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dt">fr =</span> <span class="dv">4</span>, <span class="dt">to =</span> <span class="dv">20</span>);</a>
<a class="sourceLine" id="cb15-72" title="72"></a>
<a class="sourceLine" id="cb15-73" title="73"></a>
<a class="sourceLine" id="cb15-74" title="74"><span class="co">#######################################</span></a>
<a class="sourceLine" id="cb15-75" title="75"><span class="co">### Calling bmi() is different ways </span><span class="al">###</span></a>
<a class="sourceLine" id="cb15-76" title="76"><span class="co">#######################################</span></a>
<a class="sourceLine" id="cb15-77" title="77"><span class="kw">bmi</span>(<span class="dv">65</span>, <span class="fl">1.68</span>);</a>
<a class="sourceLine" id="cb15-78" title="78"><span class="kw">bmi</span>(<span class="dt">kilograms =</span> <span class="dv">65</span>, <span class="dt">metres =</span> <span class="fl">1.68</span>)</a>
<a class="sourceLine" id="cb15-79" title="79"><span class="kw">bmi</span>(<span class="dt">metres =</span> <span class="fl">1.68</span>, <span class="dt">kilograms =</span> <span class="dv">65</span>)</a>
<a class="sourceLine" id="cb15-80" title="80"><span class="kw">bmi</span>(<span class="dt">kilo =</span> <span class="dv">65</span>, <span class="dt">met =</span> <span class="fl">1.68</span>)</a>
<a class="sourceLine" id="cb15-81" title="81"><span class="kw">bmi</span>(<span class="dt">m =</span> <span class="fl">1.68</span>, <span class="dt">k =</span> <span class="dv">65</span>)</a>
<a class="sourceLine" id="cb15-82" title="82"><span class="kw">bmi</span>(<span class="dt">m =</span> <span class="fl">1.68</span>, <span class="dv">65</span>)</a>
<a class="sourceLine" id="cb15-83" title="83"></a>
<a class="sourceLine" id="cb15-84" title="84"></a>
<a class="sourceLine" id="cb15-85" title="85"><span class="co">####################################</span></a>
<a class="sourceLine" id="cb15-86" title="86"><span class="co">### Return values from functions </span><span class="al">###</span></a>
<a class="sourceLine" id="cb15-87" title="87"><span class="co">####################################</span></a>
<a class="sourceLine" id="cb15-88" title="88"></a>
<a class="sourceLine" id="cb15-89" title="89"><span class="co"># If a function returns something and you want to keep it</span></a>
<a class="sourceLine" id="cb15-90" title="90"><span class="co"># you have to assign it to a (new) object.</span></a>
<a class="sourceLine" id="cb15-91" title="91"></a>
<a class="sourceLine" id="cb15-92" title="92">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>);</a>
<a class="sourceLine" id="cb15-93" title="93">x;</a>
<a class="sourceLine" id="cb15-94" title="94">y =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">3</span>, <span class="dv">30</span>, <span class="dt">by =</span> <span class="dv">3</span>);</a>
<a class="sourceLine" id="cb15-95" title="95">y;</a>
<a class="sourceLine" id="cb15-96" title="96"></a>
<a class="sourceLine" id="cb15-97" title="97"></a>
<a class="sourceLine" id="cb15-98" title="98"><span class="co"># Some functions do not return anything (NULL).</span></a>
<a class="sourceLine" id="cb15-99" title="99">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">5</span>);</a>
<a class="sourceLine" id="cb15-100" title="100"><span class="kw">cat</span>(x, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb15-101" title="101">catret &lt;-<span class="st"> </span><span class="kw">cat</span>(x, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb15-102" title="102">catret;</a>
<a class="sourceLine" id="cb15-103" title="103"></a>
<a class="sourceLine" id="cb15-104" title="104"><span class="co"># Demonstrate invisible here.</span></a>
<a class="sourceLine" id="cb15-105" title="105"></a>
<a class="sourceLine" id="cb15-106" title="106">bmii &lt;-<span class="st"> </span><span class="cf">function</span>(kilograms, metres) {</a>
<a class="sourceLine" id="cb15-107" title="107">  <span class="kw">invisible</span>(kilograms <span class="op">/</span><span class="st"> </span>metres <span class="op">**</span><span class="st"> </span><span class="dv">2</span>);</a>
<a class="sourceLine" id="cb15-108" title="108">}</a>
<a class="sourceLine" id="cb15-109" title="109"></a>
<a class="sourceLine" id="cb15-110" title="110"><span class="kw">bmi</span>(<span class="dt">m =</span> <span class="fl">1.65</span>, <span class="dv">65</span>);</a>
<a class="sourceLine" id="cb15-111" title="111"><span class="kw">bmii</span>(<span class="dt">m =</span> <span class="fl">1.65</span>, <span class="dv">65</span>);</a>
<a class="sourceLine" id="cb15-112" title="112">bmx &lt;-<span class="st"> </span><span class="kw">bmii</span>(<span class="dt">m =</span> <span class="fl">1.65</span>, <span class="dv">65</span>);</a>
<a class="sourceLine" id="cb15-113" title="113">bmx</a>
<a class="sourceLine" id="cb15-114" title="114"></a>
<a class="sourceLine" id="cb15-115" title="115"><span class="co">##############################################</span></a>
<a class="sourceLine" id="cb15-116" title="116"><span class="co">### A note about assignment operators in R </span><span class="al">###</span></a>
<a class="sourceLine" id="cb15-117" title="117"><span class="co">##############################################</span></a>
<a class="sourceLine" id="cb15-118" title="118"></a>
<a class="sourceLine" id="cb15-119" title="119">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">5</span>);</a>
<a class="sourceLine" id="cb15-120" title="120">x</a>
<a class="sourceLine" id="cb15-121" title="121"><span class="co"># Works, but for the wrong reason.</span></a>
<a class="sourceLine" id="cb15-122" title="122">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, by &lt;-<span class="st"> </span><span class="dv">5</span>);</a>
<a class="sourceLine" id="cb15-123" title="123">x</a>
<a class="sourceLine" id="cb15-124" title="124"></a>
<a class="sourceLine" id="cb15-125" title="125"><span class="co"># Fails. Wrong sign in by argument.</span></a>
<a class="sourceLine" id="cb15-126" title="126"><span class="kw">rm</span>(x);</a>
<a class="sourceLine" id="cb15-127" title="127">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, by &lt;-<span class="st"> </span><span class="dv">5</span>, <span class="dv">100</span>);</a>
<a class="sourceLine" id="cb15-128" title="128">x</a>
<a class="sourceLine" id="cb15-129" title="129"></a>
<a class="sourceLine" id="cb15-130" title="130"><span class="co"># Works. But unintended result.</span></a>
<a class="sourceLine" id="cb15-131" title="131"><span class="kw">rm</span>(x);</a>
<a class="sourceLine" id="cb15-132" title="132">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, by &lt;-<span class="st"> </span><span class="dv">5</span>, <span class="dv">-1</span>);</a>
<a class="sourceLine" id="cb15-133" title="133">x</a>
<a class="sourceLine" id="cb15-134" title="134"></a>
<a class="sourceLine" id="cb15-135" title="135"><span class="co"># Alt-minus key combination gives you the</span></a>
<a class="sourceLine" id="cb15-136" title="136"><span class="co"># assignment operator in RStudio</span></a>
<a class="sourceLine" id="cb15-137" title="137"> </a>
<a class="sourceLine" id="cb15-138" title="138"><span class="co"># Use &lt;- or = on the command line.</span></a>
<a class="sourceLine" id="cb15-139" title="139"><span class="co"># Always use = in function calls and function definitions.</span></a>
<a class="sourceLine" id="cb15-140" title="140"></a>
<a class="sourceLine" id="cb15-141" title="141"><span class="co"># Function calls as arguments</span></a>
<a class="sourceLine" id="cb15-142" title="142"></a>
<a class="sourceLine" id="cb15-143" title="143"><span class="kw">rep</span>(<span class="dv">4</span>, <span class="dt">times =</span> <span class="dv">4</span>);</a>
<a class="sourceLine" id="cb15-144" title="144"></a>
<a class="sourceLine" id="cb15-145" title="145"><span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="dt">times =</span> <span class="dv">4</span>);</a>
<a class="sourceLine" id="cb15-146" title="146"></a>
<a class="sourceLine" id="cb15-147" title="147"><span class="kw">rep</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>), <span class="dt">each =</span> <span class="dv">4</span>);</a>
<a class="sourceLine" id="cb15-148" title="148"></a>
<a class="sourceLine" id="cb15-149" title="149"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb15-150" title="150"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb15-151" title="151"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb15-152" title="152"></a>
<a class="sourceLine" id="cb15-153" title="153"><span class="co"># 1. Run the code below.</span></a>
<a class="sourceLine" id="cb15-154" title="154"></a>
<a class="sourceLine" id="cb15-155" title="155">x &lt;-<span class="st"> </span>y &lt;-<span class="st"> </span>z &lt;-<span class="st"> </span><span class="dv">42</span></a>
<a class="sourceLine" id="cb15-156" title="156"></a>
<a class="sourceLine" id="cb15-157" title="157"><span class="co"># 2. Check the values of x, y and z.</span></a>
<a class="sourceLine" id="cb15-158" title="158"></a>
<a class="sourceLine" id="cb15-159" title="159"></a>
<a class="sourceLine" id="cb15-160" title="160"><span class="co"># 1. Generate the sequence -20 to 50 increasing in steps</span></a>
<a class="sourceLine" id="cb15-161" title="161"><span class="co"># of 5 and name it ds.</span></a>
<a class="sourceLine" id="cb15-162" title="162"></a>
<a class="sourceLine" id="cb15-163" title="163"><span class="co"># 2. Check the value of ds.</span></a>
<a class="sourceLine" id="cb15-164" title="164"></a>
<a class="sourceLine" id="cb15-165" title="165"><span class="co">######################################################</span></a>
<a class="sourceLine" id="cb15-166" title="166"></a>
<a class="sourceLine" id="cb15-167" title="167"><span class="co"># 1. Write a function named cel2fah which takes one</span></a>
<a class="sourceLine" id="cb15-168" title="168"><span class="co"># argument, the temperature in degrees Celsius, and returns</span></a>
<a class="sourceLine" id="cb15-169" title="169"><span class="co"># the same temperature in Fahrenheit.</span></a>
<a class="sourceLine" id="cb15-170" title="170"></a>
<a class="sourceLine" id="cb15-171" title="171"><span class="co"># 2. Hints:</span></a>
<a class="sourceLine" id="cb15-172" title="172"><span class="co"># - Multiply Celsius by 1.8 then add 32 to get Fahrenheit.</span></a>
<a class="sourceLine" id="cb15-173" title="173"></a>
<a class="sourceLine" id="cb15-174" title="174"><span class="co">### Write your function here </span><span class="al">###</span></a>
<a class="sourceLine" id="cb15-175" title="175"></a>
<a class="sourceLine" id="cb15-176" title="176"></a>
<a class="sourceLine" id="cb15-177" title="177"><span class="co"># 3. Test your function by calling it as below.</span></a>
<a class="sourceLine" id="cb15-178" title="178"></a>
<a class="sourceLine" id="cb15-179" title="179"><span class="co">#    a. cel2fah(100)</span></a>
<a class="sourceLine" id="cb15-180" title="180"><span class="co">#    b. cel2fah(0)</span></a>
<a class="sourceLine" id="cb15-181" title="181"><span class="co">#    c. cel2fah(seq(0,100))</span></a>
<a class="sourceLine" id="cb15-182" title="182"></a>
<a class="sourceLine" id="cb15-183" title="183"><span class="co"># Discuss call c. above.</span></a>
<a class="sourceLine" id="cb15-184" title="184"></a>
<a class="sourceLine" id="cb15-185" title="185"><span class="co"># You cannot do cel2fah(0,10).</span></a>
<a class="sourceLine" id="cb15-186" title="186"></a>
<a class="sourceLine" id="cb15-187" title="187"><span class="co"># 4. Try the below.</span></a>
<a class="sourceLine" id="cb15-188" title="188"></a>
<a class="sourceLine" id="cb15-189" title="189"><span class="kw">curve</span>(cel2fah, <span class="dv">-50</span>, <span class="dv">50</span>, <span class="dt">xlab =</span> <span class="st">&quot;Celsius&quot;</span>,</a>
<a class="sourceLine" id="cb15-190" title="190">      <span class="dt">ylab =</span> <span class="st">&quot;Fahrenheit&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">col =</span> <span class="st">&quot;royalblue&quot;</span>)</a>
<a class="sourceLine" id="cb15-191" title="191"></a>
<a class="sourceLine" id="cb15-192" title="192"><span class="co"># Functions are objects. We passed a function as an argument</span></a>
<a class="sourceLine" id="cb15-193" title="193"><span class="co"># to another function.</span></a>
<a class="sourceLine" id="cb15-194" title="194"></a>
<a class="sourceLine" id="cb15-195" title="195"><span class="kw">class</span>(cel2fah)</a>
<a class="sourceLine" id="cb15-196" title="196"><span class="kw">typeof</span>(cel2fah)</a>
<a class="sourceLine" id="cb15-197" title="197"></a>
<a class="sourceLine" id="cb15-198" title="198"><span class="co"># Another example of passing a function as an argument to</span></a>
<a class="sourceLine" id="cb15-199" title="199"><span class="co"># another function. Trignometric functions such as sin()</span></a>
<a class="sourceLine" id="cb15-200" title="200"><span class="co"># or cos() take their arguments in radians. But I am more</span></a>
<a class="sourceLine" id="cb15-201" title="201"><span class="co"># comfortable thinking in degrees.</span></a>
<a class="sourceLine" id="cb15-202" title="202"></a>
<a class="sourceLine" id="cb15-203" title="203">deg2rad &lt;-<span class="st"> </span><span class="cf">function</span>(deg) {</a>
<a class="sourceLine" id="cb15-204" title="204"><span class="kw">return</span>(deg <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi <span class="op">/</span><span class="st"> </span><span class="dv">360</span>);</a>
<a class="sourceLine" id="cb15-205" title="205">}</a>
<a class="sourceLine" id="cb15-206" title="206"><span class="kw">curve</span>(sin, <span class="kw">deg2rad</span>(<span class="dv">0</span>), <span class="kw">deg2rad</span>(<span class="dv">360</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb15-207" title="207">      <span class="dt">ylab =</span> <span class="st">&quot;f(x)&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x in radians&quot;</span>);</a>
<a class="sourceLine" id="cb15-208" title="208"><span class="kw">curve</span>(cos, <span class="kw">deg2rad</span>(<span class="dv">0</span>), <span class="kw">deg2rad</span>(<span class="dv">360</span>), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>, <span class="dt">add =</span> T);</a>
<a class="sourceLine" id="cb15-209" title="209"></a>
<a class="sourceLine" id="cb15-210" title="210"></a>
<a class="sourceLine" id="cb15-211" title="211"><span class="co">########################</span></a>
<a class="sourceLine" id="cb15-212" title="212"><span class="co">### ... (three dots) </span><span class="al">###</span></a>
<a class="sourceLine" id="cb15-213" title="213"><span class="co">########################</span></a>
<a class="sourceLine" id="cb15-214" title="214"></a>
<a class="sourceLine" id="cb15-215" title="215">dotdemo1 &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...) {</a>
<a class="sourceLine" id="cb15-216" title="216">  <span class="kw">cat</span>(<span class="st">&quot;x is: &quot;</span>, x, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb15-217" title="217">  vargs &lt;-<span class="st"> </span><span class="kw">list</span>(...);</a>
<a class="sourceLine" id="cb15-218" title="218">  <span class="kw">cat</span>(<span class="st">&quot;Then: &quot;</span>, vargs[[<span class="dv">1</span>]], <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb15-219" title="219">}</a>
<a class="sourceLine" id="cb15-220" title="220"><span class="kw">dotdemo1</span>(<span class="st">&quot;stuff&quot;</span>, <span class="st">&quot;morestuff&quot;</span>);</a>
<a class="sourceLine" id="cb15-221" title="221"></a>
<a class="sourceLine" id="cb15-222" title="222"></a>
<a class="sourceLine" id="cb15-223" title="223">dotdemo2 &lt;-<span class="st"> </span><span class="cf">function</span>(x, ...) {</a>
<a class="sourceLine" id="cb15-224" title="224">  <span class="kw">cat</span>(<span class="st">&quot;x is: &quot;</span>, x, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb15-225" title="225">  vargs &lt;-<span class="st"> </span><span class="kw">list</span>(...);</a>
<a class="sourceLine" id="cb15-226" title="226">  <span class="kw">cat</span>(<span class="st">&quot;y as named: &quot;</span>, vargs<span class="op">$</span>y, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb15-227" title="227">  <span class="kw">cat</span>(<span class="st">&quot;y as positional: &quot;</span>, vargs[[<span class="dv">1</span>]], <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb15-228" title="228">  <span class="kw">cat</span>(<span class="st">&quot;Then: &quot;</span>, vargs[[<span class="dv">2</span>]], <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb15-229" title="229">}</a>
<a class="sourceLine" id="cb15-230" title="230"><span class="kw">dotdemo2</span>(<span class="dt">x =</span> <span class="st">&quot;stuff&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;morestuff&quot;</span>, <span class="dv">23</span>);</a>
<a class="sourceLine" id="cb15-231" title="231"></a>
<a class="sourceLine" id="cb15-232" title="232"></a>
<a class="sourceLine" id="cb15-233" title="233"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb15-234" title="234"><span class="co">### Operators as functions </span><span class="al">###</span></a>
<a class="sourceLine" id="cb15-235" title="235"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb15-236" title="236"></a>
<a class="sourceLine" id="cb15-237" title="237">x &lt;-<span class="st"> </span><span class="dv">2</span>;</a>
<a class="sourceLine" id="cb15-238" title="238">y &lt;-<span class="st"> </span><span class="dv">3</span>;</a>
<a class="sourceLine" id="cb15-239" title="239"></a>
<a class="sourceLine" id="cb15-240" title="240">x <span class="op">+</span><span class="st"> </span>y</a>
<a class="sourceLine" id="cb15-241" title="241"></a>
<a class="sourceLine" id="cb15-242" title="242"><span class="st">&#39;+&#39;</span>(x,y)</a>
<a class="sourceLine" id="cb15-243" title="243"><span class="st">&#39;*&#39;</span>(x,y)</a>
<a class="sourceLine" id="cb15-244" title="244"></a>
<a class="sourceLine" id="cb15-245" title="245">vecx &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.9</span>, <span class="fl">4.1</span>, <span class="fl">3.9</span>, <span class="fl">4.5</span>, <span class="fl">3.7</span>, <span class="fl">45.3</span>, <span class="fl">21.6</span>);</a>
<a class="sourceLine" id="cb15-246" title="246">z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ftsZ&quot;</span>, <span class="st">&quot;sigE&quot;</span>, <span class="st">&quot;bldN&quot;</span>, <span class="st">&quot;whiA&quot;</span>, <span class="st">&quot;whiB&quot;</span>, <span class="st">&quot;rdlA&quot;</span>, <span class="st">&quot;chpA&quot;</span>);</a>
<a class="sourceLine" id="cb15-247" title="247"><span class="kw">names</span>(vecx) &lt;-<span class="st"> </span>z;</a>
<a class="sourceLine" id="cb15-248" title="248"></a>
<a class="sourceLine" id="cb15-249" title="249"><span class="st">&#39;[&#39;</span>(vecx, <span class="dv">4</span>);</a>
<a class="sourceLine" id="cb15-250" title="250"><span class="st">&#39;[&#39;</span>(vecx, <span class="st">&quot;whiA&quot;</span>);</a></code></pre></div>
<!-- >>> -->
<!-- <<< scopeenv.r -->
<h1 id="scope-and-environment">Scope and Environment</h1>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">### Scope and Environments </span><span class="al">###</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb16-5" title="5"></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="co"># Scope of a variable is where, in a running program, it is</span></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co"># accessible.</span></a>
<a class="sourceLine" id="cb16-8" title="8"></a>
<a class="sourceLine" id="cb16-9" title="9"><span class="co"># Functions and environments define the scope of variables</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co"># in them. In an R session the default environment is the global</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="co"># environment named .GlobalEnv</span></a>
<a class="sourceLine" id="cb16-12" title="12"></a>
<a class="sourceLine" id="cb16-13" title="13"><span class="co"># Lexical scope: Functions are evaluated in the environment</span></a>
<a class="sourceLine" id="cb16-14" title="14"><span class="co"># in which they are defined.</span></a>
<a class="sourceLine" id="cb16-15" title="15"><span class="co">#</span></a>
<a class="sourceLine" id="cb16-16" title="16"><span class="co"># Closures</span></a>
<a class="sourceLine" id="cb16-17" title="17"><span class="co">#</span></a>
<a class="sourceLine" id="cb16-18" title="18"><span class="co"># The environment provides values for any unbound symbols in</span></a>
<a class="sourceLine" id="cb16-19" title="19"><span class="co"># in the body of a function when the function is evaluated.</span></a>
<a class="sourceLine" id="cb16-20" title="20"></a>
<a class="sourceLine" id="cb16-21" title="21"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb16-22" title="22"></a>
<a class="sourceLine" id="cb16-23" title="23">rate &lt;-<span class="st"> </span><span class="fl">0.2</span>;</a>
<a class="sourceLine" id="cb16-24" title="24">withvat &lt;-<span class="st"> </span><span class="cf">function</span>(exvat) {</a>
<a class="sourceLine" id="cb16-25" title="25">  <span class="kw">return</span>(exvat <span class="op">+</span><span class="st"> </span>(exvat <span class="op">*</span><span class="st"> </span>rate))</a>
<a class="sourceLine" id="cb16-26" title="26">}</a>
<a class="sourceLine" id="cb16-27" title="27"></a>
<a class="sourceLine" id="cb16-28" title="28"><span class="kw">withvat</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb16-29" title="29">rate &lt;-<span class="st"> </span><span class="fl">0.3</span>;</a>
<a class="sourceLine" id="cb16-30" title="30"><span class="kw">withvat</span>(<span class="dv">100</span>);</a>
<a class="sourceLine" id="cb16-31" title="31"></a>
<a class="sourceLine" id="cb16-32" title="32">vatfuncgen &lt;-<span class="st"> </span><span class="cf">function</span>(vatrate) {</a>
<a class="sourceLine" id="cb16-33" title="33">  vatfun &lt;-<span class="st"> </span><span class="cf">function</span>(exvat) {</a>
<a class="sourceLine" id="cb16-34" title="34">    <span class="kw">return</span>(exvat <span class="op">+</span><span class="st"> </span>(exvat <span class="op">*</span><span class="st"> </span>vatrate))</a>
<a class="sourceLine" id="cb16-35" title="35">  }</a>
<a class="sourceLine" id="cb16-36" title="36">  <span class="kw">return</span>(vatfun)</a>
<a class="sourceLine" id="cb16-37" title="37">}</a>
<a class="sourceLine" id="cb16-38" title="38"></a>
<a class="sourceLine" id="cb16-39" title="39">standard &lt;-<span class="st"> </span><span class="kw">vatfuncgen</span>(<span class="fl">0.2</span>);</a>
<a class="sourceLine" id="cb16-40" title="40">reduced &lt;-<span class="st"> </span><span class="kw">vatfuncgen</span>(<span class="fl">0.1</span>);</a>
<a class="sourceLine" id="cb16-41" title="41"></a>
<a class="sourceLine" id="cb16-42" title="42"><span class="kw">standard</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb16-43" title="43"><span class="kw">reduced</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb16-44" title="44"></a>
<a class="sourceLine" id="cb16-45" title="45"><span class="kw">environment</span>(withvat);</a>
<a class="sourceLine" id="cb16-46" title="46"><span class="kw">environment</span>(standard);</a>
<a class="sourceLine" id="cb16-47" title="47"><span class="kw">environment</span>(reduced);</a>
<a class="sourceLine" id="cb16-48" title="48"></a>
<a class="sourceLine" id="cb16-49" title="49"><span class="kw">ls</span>(<span class="dt">envir =</span> <span class="kw">environment</span>(standard));</a>
<a class="sourceLine" id="cb16-50" title="50"><span class="kw">ls</span>(<span class="dt">envir =</span> <span class="kw">environment</span>(reduced));</a>
<a class="sourceLine" id="cb16-51" title="51"><span class="kw">ls</span>(<span class="dt">envir =</span> .GlobalEnv);</a>
<a class="sourceLine" id="cb16-52" title="52"></a>
<a class="sourceLine" id="cb16-53" title="53"><span class="kw">parent.env</span>(<span class="kw">environment</span>(standard));</a>
<a class="sourceLine" id="cb16-54" title="54"></a>
<a class="sourceLine" id="cb16-55" title="55">superlow &lt;-<span class="st"> </span>standard;</a>
<a class="sourceLine" id="cb16-56" title="56">sl.env &lt;-<span class="st"> </span><span class="kw">new.env</span>();</a>
<a class="sourceLine" id="cb16-57" title="57">sl.env<span class="op">$</span>vatrate &lt;-<span class="st"> </span><span class="fl">0.05</span>;</a>
<a class="sourceLine" id="cb16-58" title="58"><span class="kw">environment</span>(superlow) &lt;-<span class="st"> </span>sl.env;</a>
<a class="sourceLine" id="cb16-59" title="59"></a>
<a class="sourceLine" id="cb16-60" title="60"><span class="kw">superlow</span>(<span class="dv">100</span>);</a>
<a class="sourceLine" id="cb16-61" title="61"></a>
<a class="sourceLine" id="cb16-62" title="62"><span class="co">### assign() and get() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb16-63" title="63"></a>
<a class="sourceLine" id="cb16-64" title="64"><span class="co"># Standard VAT goes up to 0.25.</span></a>
<a class="sourceLine" id="cb16-65" title="65"></a>
<a class="sourceLine" id="cb16-66" title="66"><span class="kw">assign</span>(<span class="st">&quot;vatrate&quot;</span>, <span class="fl">0.25</span>, <span class="dt">envir =</span> <span class="kw">environment</span>(standard));</a>
<a class="sourceLine" id="cb16-67" title="67"></a>
<a class="sourceLine" id="cb16-68" title="68"><span class="kw">standard</span>(<span class="dv">100</span>);</a>
<a class="sourceLine" id="cb16-69" title="69"></a>
<a class="sourceLine" id="cb16-70" title="70"><span class="kw">get</span>(<span class="st">&quot;vatrate&quot;</span>, <span class="dt">envir =</span> <span class="kw">environment</span>(superlow));</a>
<a class="sourceLine" id="cb16-71" title="71"></a>
<a class="sourceLine" id="cb16-72" title="72"><span class="co"># The effective environment is almost always a nesting of</span></a>
<a class="sourceLine" id="cb16-73" title="73"><span class="co"># environments.</span></a>
<a class="sourceLine" id="cb16-74" title="74"></a>
<a class="sourceLine" id="cb16-75" title="75"><span class="kw">parent.env</span>(<span class="kw">environment</span>(superlow));</a>
<a class="sourceLine" id="cb16-76" title="76"><span class="kw">parent.env</span>(<span class="kw">parent.env</span>(<span class="kw">environment</span>(superlow)));</a>
<a class="sourceLine" id="cb16-77" title="77"><span class="kw">parent.env</span>(<span class="kw">parent.env</span>(<span class="kw">parent.env</span>(<span class="kw">environment</span>(superlow))));</a>
<a class="sourceLine" id="cb16-78" title="78"></a>
<a class="sourceLine" id="cb16-79" title="79"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb16-80" title="80"><span class="co">### The search path. search() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb16-81" title="81"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb16-82" title="82"></a>
<a class="sourceLine" id="cb16-83" title="83"><span class="kw">search</span>();</a>
<a class="sourceLine" id="cb16-84" title="84"></a>
<a class="sourceLine" id="cb16-85" title="85"><span class="kw">attach</span>(<span class="kw">environment</span>(standard));</a>
<a class="sourceLine" id="cb16-86" title="86"></a>
<a class="sourceLine" id="cb16-87" title="87"><span class="kw">search</span>();</a>
<a class="sourceLine" id="cb16-88" title="88"></a>
<a class="sourceLine" id="cb16-89" title="89"><span class="kw">ls</span>(); <span class="co"># Notice that there is no vatfun in the listing.</span></a>
<a class="sourceLine" id="cb16-90" title="90"></a>
<a class="sourceLine" id="cb16-91" title="91"><span class="kw">vatfun</span>(<span class="dv">100</span>); <span class="co"># But you can still call vatfun.</span></a></code></pre></div>
<!-- >>> -->
<!-- <<< queryingobjects.r -->
<h1 id="querying-objects">Querying Objects</h1>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="co">######################################</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">### Querying the nature of objects </span><span class="al">###</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">######################################</span></a>
<a class="sourceLine" id="cb17-5" title="5"></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co"># Mode</span></a>
<a class="sourceLine" id="cb17-7" title="7"></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co"># The mode of an object signifies the type of data in it.</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co"># numeric, character, logical, complex and raw.</span></a>
<a class="sourceLine" id="cb17-10" title="10"></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb17-12" title="12"></a>
<a class="sourceLine" id="cb17-13" title="13">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.5</span>);</a>
<a class="sourceLine" id="cb17-14" title="14"><span class="kw">mode</span>(x);</a>
<a class="sourceLine" id="cb17-15" title="15">y &lt;-<span class="st"> </span><span class="kw">as.integer</span>(x);</a>
<a class="sourceLine" id="cb17-16" title="16"><span class="kw">mode</span>(y);</a>
<a class="sourceLine" id="cb17-17" title="17"></a>
<a class="sourceLine" id="cb17-18" title="18"><span class="co"># Type and Storage mode</span></a>
<a class="sourceLine" id="cb17-19" title="19"></a>
<a class="sourceLine" id="cb17-20" title="20"><span class="co"># These two are approximately the same.</span></a>
<a class="sourceLine" id="cb17-21" title="21"><span class="kw">storage.mode</span>(x);</a>
<a class="sourceLine" id="cb17-22" title="22"><span class="kw">typeof</span>(x);</a>
<a class="sourceLine" id="cb17-23" title="23"></a>
<a class="sourceLine" id="cb17-24" title="24"><span class="kw">storage.mode</span>(y);</a>
<a class="sourceLine" id="cb17-25" title="25"><span class="kw">typeof</span>(y);</a>
<a class="sourceLine" id="cb17-26" title="26"></a>
<a class="sourceLine" id="cb17-27" title="27"><span class="co"># Class</span></a>
<a class="sourceLine" id="cb17-28" title="28"></a>
<a class="sourceLine" id="cb17-29" title="29"><span class="co"># The class of an object is the class that the object is an</span></a>
<a class="sourceLine" id="cb17-30" title="30"><span class="co"># instance of. For vectors it is the same as the mode. list,</span></a>
<a class="sourceLine" id="cb17-31" title="31"><span class="co"># data.frame, matrix, function. Class of an object determines what</span></a>
<a class="sourceLine" id="cb17-32" title="32"><span class="co"># methods are available to apply on it and also how those methods</span></a>
<a class="sourceLine" id="cb17-33" title="33"><span class="co"># behave.</span></a>
<a class="sourceLine" id="cb17-34" title="34"></a>
<a class="sourceLine" id="cb17-35" title="35"><span class="kw">class</span>(x);</a>
<a class="sourceLine" id="cb17-36" title="36"><span class="kw">class</span>(y);</a>
<a class="sourceLine" id="cb17-37" title="37"></a>
<a class="sourceLine" id="cb17-38" title="38"><span class="co"># str() is useful to display the internal structure of R objects.</span></a>
<a class="sourceLine" id="cb17-39" title="39"><span class="co"># Especially useful for data frames and more complex objects.</span></a>
<a class="sourceLine" id="cb17-40" title="40"></a>
<a class="sourceLine" id="cb17-41" title="41">hx &lt;-<span class="st"> </span><span class="kw">hist</span>(<span class="kw">rnorm</span>(<span class="dv">300</span>), <span class="dt">plot =</span> F);</a>
<a class="sourceLine" id="cb17-42" title="42"><span class="kw">str</span>(hx)</a>
<a class="sourceLine" id="cb17-43" title="43"></a>
<a class="sourceLine" id="cb17-44" title="44"><span class="kw">methods</span>(<span class="dt">class =</span> <span class="kw">class</span>(hx));</a>
<a class="sourceLine" id="cb17-45" title="45"></a>
<a class="sourceLine" id="cb17-46" title="46"><span class="kw">methods</span>(<span class="dt">class =</span> <span class="st">&quot;data.frame&quot;</span>);</a></code></pre></div>
<!-- >>> -->
<!-- <<< packages.r -->
<h1 id="packages">Packages</h1>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="co">################</span></a>
<a class="sourceLine" id="cb18-3" title="3"><span class="co">### Packages </span><span class="al">###</span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="co">################</span></a>
<a class="sourceLine" id="cb18-5" title="5"></a>
<a class="sourceLine" id="cb18-6" title="6"><span class="co"># R classes and functions written by others for you to</span></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="co"># use.</span></a>
<a class="sourceLine" id="cb18-8" title="8"></a>
<a class="sourceLine" id="cb18-9" title="9"><span class="co"># Provide namespaces which roughly translate into</span></a>
<a class="sourceLine" id="cb18-10" title="10"><span class="co"># environments on the search() hierarchy thus avoiding</span></a>
<a class="sourceLine" id="cb18-11" title="11"><span class="co"># symbol clashes.</span></a>
<a class="sourceLine" id="cb18-12" title="12"></a>
<a class="sourceLine" id="cb18-13" title="13"><span class="co"># Packaged to be loaded on demand to minimise resource</span></a>
<a class="sourceLine" id="cb18-14" title="14"><span class="co"># use.</span></a>
<a class="sourceLine" id="cb18-15" title="15"></a>
<a class="sourceLine" id="cb18-16" title="16"><span class="co"># When you load a package additional functions defined</span></a>
<a class="sourceLine" id="cb18-17" title="17"><span class="co"># in the package become available for you to use.</span></a>
<a class="sourceLine" id="cb18-18" title="18"><span class="co"># Sometimes existing functions might be over-ridden.</span></a>
<a class="sourceLine" id="cb18-19" title="19"></a>
<a class="sourceLine" id="cb18-20" title="20"><span class="co"># CRAN has a repository of R packages.</span></a>
<a class="sourceLine" id="cb18-21" title="21"></a>
<a class="sourceLine" id="cb18-22" title="22"><span class="co"># Bioconductor is a repository of packages for</span></a>
<a class="sourceLine" id="cb18-23" title="23"><span class="co"># bioinformatics. Bioconductor has its own installer.</span></a>
<a class="sourceLine" id="cb18-24" title="24"></a>
<a class="sourceLine" id="cb18-25" title="25"><span class="co"># What packages are installed?</span></a>
<a class="sourceLine" id="cb18-26" title="26"></a>
<a class="sourceLine" id="cb18-27" title="27"><span class="co"># installed.packages() where row names are names of packages.</span></a>
<a class="sourceLine" id="cb18-28" title="28"><span class="co"># To just see the row names of this matrix (e.g. to check whether</span></a>
<a class="sourceLine" id="cb18-29" title="29"><span class="co"># a package is installed).</span></a>
<a class="sourceLine" id="cb18-30" title="30"></a>
<a class="sourceLine" id="cb18-31" title="31"><span class="kw">sort</span>(<span class="kw">rownames</span>(<span class="kw">installed.packages</span>()));</a>
<a class="sourceLine" id="cb18-32" title="32"></a>
<a class="sourceLine" id="cb18-33" title="33"><span class="co"># Character vector of directories where packages are installed.</span></a>
<a class="sourceLine" id="cb18-34" title="34"></a>
<a class="sourceLine" id="cb18-35" title="35"><span class="kw">.libPaths</span>() </a>
<a class="sourceLine" id="cb18-36" title="36"></a>
<a class="sourceLine" id="cb18-37" title="37"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb18-38" title="38"><span class="co">### Using packages. library() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb18-39" title="39"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb18-40" title="40"></a>
<a class="sourceLine" id="cb18-41" title="41"><span class="kw">library</span>(<span class="st">&quot;edgeR&quot;</span>);</a>
<a class="sourceLine" id="cb18-42" title="42"></a>
<a class="sourceLine" id="cb18-43" title="43"><span class="co"># Load the namespace of the package with name</span></a>
<a class="sourceLine" id="cb18-44" title="44"><span class="co"># package and attach it on the search list.</span></a>
<a class="sourceLine" id="cb18-45" title="45"></a>
<a class="sourceLine" id="cb18-46" title="46"><span class="co"># The reverse is</span></a>
<a class="sourceLine" id="cb18-47" title="47"></a>
<a class="sourceLine" id="cb18-48" title="48"><span class="kw">detach</span>(<span class="st">&quot;package:edgeR&quot;</span>, <span class="dt">unload =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-49" title="49"></a>
<a class="sourceLine" id="cb18-50" title="50"><span class="co"># Packaged loaded as dependencies are nor automatically removed.</span></a>
<a class="sourceLine" id="cb18-51" title="51"></a>
<a class="sourceLine" id="cb18-52" title="52"><span class="kw">detach</span>(<span class="st">&quot;package:limma&quot;</span>, <span class="dt">unload =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb18-53" title="53"></a>
<a class="sourceLine" id="cb18-54" title="54"><span class="co"># Sometimes you will see a function being called as</span></a>
<a class="sourceLine" id="cb18-55" title="55"></a>
<a class="sourceLine" id="cb18-56" title="56"><span class="co">#        packagename::funcname()</span></a>
<a class="sourceLine" id="cb18-57" title="57"><span class="co"># e.g.   readxl::read_excel()</span></a>
<a class="sourceLine" id="cb18-58" title="58"></a>
<a class="sourceLine" id="cb18-59" title="59"><span class="co"># In such cases the package is loaded (into memory) but it</span></a>
<a class="sourceLine" id="cb18-60" title="60"><span class="co"># is not attached to the search path. This is good for one</span></a>
<a class="sourceLine" id="cb18-61" title="61"><span class="co"># time use of a function and to avoid namespace conflicts</span></a>
<a class="sourceLine" id="cb18-62" title="62"><span class="co"># resulting in masking.</span></a>
<a class="sourceLine" id="cb18-63" title="63"></a>
<a class="sourceLine" id="cb18-64" title="64"><span class="co"># Also good for accessing masked functions.</span></a>
<a class="sourceLine" id="cb18-65" title="65"></a>
<a class="sourceLine" id="cb18-66" title="66"><span class="co"># e.g. stats::filter() to use the filter function in the</span></a>
<a class="sourceLine" id="cb18-67" title="67"><span class="co"># stats package while it is masked by the one in dplyr</span></a>
<a class="sourceLine" id="cb18-68" title="68"><span class="co"># package.</span></a>
<a class="sourceLine" id="cb18-69" title="69"></a></code></pre></div>
<!-- >>> -->
<!-- <<< documentation.r -->
<h1 id="documentation">Documentation</h1>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co">#############################</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="co">### Reading documentation </span><span class="al">###</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="co">#############################</span></a>
<a class="sourceLine" id="cb19-5" title="5"></a>
<a class="sourceLine" id="cb19-6" title="6"></a>
<a class="sourceLine" id="cb19-7" title="7"><span class="co"># Go to the &quot;Help&quot; tab in the bottom right</span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="co"># pane then search for &quot;seq&quot;. You can also</span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="co"># do the below to see the help in the &quot;Help&quot;</span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="co"># tab.</span></a>
<a class="sourceLine" id="cb19-11" title="11"></a>
<a class="sourceLine" id="cb19-12" title="12"><span class="kw">help</span>(<span class="st">&quot;seq&quot;</span>)</a>
<a class="sourceLine" id="cb19-13" title="13"><span class="kw">help</span>(<span class="st">&quot;plot&quot;</span>)</a>
<a class="sourceLine" id="cb19-14" title="14"></a>
<a class="sourceLine" id="cb19-15" title="15"><span class="co"># plot is a generic function.</span></a>
<a class="sourceLine" id="cb19-16" title="16"><span class="co"># Classes can define their own plot function which will be used if</span></a>
<a class="sourceLine" id="cb19-17" title="17"><span class="co"># the argument to plot is an object of that class.</span></a>
<a class="sourceLine" id="cb19-18" title="18"><span class="co">#</span></a>
<a class="sourceLine" id="cb19-19" title="19"><span class="co"># Otherwise, plot.default</span></a>
<a class="sourceLine" id="cb19-20" title="20"></a>
<a class="sourceLine" id="cb19-21" title="21"><span class="co"># help.search() shows all the packages which</span></a>
<a class="sourceLine" id="cb19-22" title="22"><span class="co"># have anything to do with &quot;sequence&quot;.</span></a>
<a class="sourceLine" id="cb19-23" title="23"></a>
<a class="sourceLine" id="cb19-24" title="24"><span class="kw">help.search</span>(<span class="st">&quot;sequence&quot;</span>)</a>
<a class="sourceLine" id="cb19-25" title="25"></a>
<a class="sourceLine" id="cb19-26" title="26"></a>
<a class="sourceLine" id="cb19-27" title="27"><span class="co">### Sometimes there is runnable example code. </span><span class="al">###</span></a>
<a class="sourceLine" id="cb19-28" title="28"></a>
<a class="sourceLine" id="cb19-29" title="29"><span class="co"># example(&quot;hist&quot;) # Often crashes RStudio!</span></a>
<a class="sourceLine" id="cb19-30" title="30"></a>
<a class="sourceLine" id="cb19-31" title="31"></a>
<a class="sourceLine" id="cb19-32" title="32"><span class="co">### There are lots of bundled example data sets </span><span class="al">###</span></a>
<a class="sourceLine" id="cb19-33" title="33"></a>
<a class="sourceLine" id="cb19-34" title="34"><span class="kw">data</span>() <span class="co"># lists available data sets.</span></a>
<a class="sourceLine" id="cb19-35" title="35"></a>
<a class="sourceLine" id="cb19-36" title="36"><span class="kw">data</span>(<span class="st">&quot;cars&quot;</span>) <span class="co"># loads the named data set.</span></a>
<a class="sourceLine" id="cb19-37" title="37"><span class="kw">ls</span>()</a>
<a class="sourceLine" id="cb19-38" title="38"><span class="kw">head</span>(cars)</a>
<a class="sourceLine" id="cb19-39" title="39"></a>
<a class="sourceLine" id="cb19-40" title="40"><span class="co">### Finding methods </span><span class="al">###</span></a>
<a class="sourceLine" id="cb19-41" title="41"></a>
<a class="sourceLine" id="cb19-42" title="42"><span class="co"># All definitions for a generic method in the search</span></a>
<a class="sourceLine" id="cb19-43" title="43"><span class="co"># path.</span></a>
<a class="sourceLine" id="cb19-44" title="44"></a>
<a class="sourceLine" id="cb19-45" title="45"><span class="kw">methods</span>(<span class="st">&quot;plot&quot;</span>); <span class="co"># plot is a generic function.</span></a>
<a class="sourceLine" id="cb19-46" title="46">?plot.histogram</a>
<a class="sourceLine" id="cb19-47" title="47"></a>
<a class="sourceLine" id="cb19-48" title="48"><span class="co"># All methods available in a class.</span></a>
<a class="sourceLine" id="cb19-49" title="49"><span class="kw">methods</span>(<span class="dt">class =</span> <span class="st">&quot;histogram&quot;</span>);</a>
<a class="sourceLine" id="cb19-50" title="50"><span class="kw">methods</span>(<span class="dt">class =</span> <span class="st">&quot;data.frame&quot;</span>);</a>
<a class="sourceLine" id="cb19-51" title="51"></a>
<a class="sourceLine" id="cb19-52" title="52"><span class="co"># Packages are not the same as classes. Classes are</span></a>
<a class="sourceLine" id="cb19-53" title="53"><span class="co"># defined in packages and more than one may be defined</span></a>
<a class="sourceLine" id="cb19-54" title="54"><span class="co"># in one package.</span></a>
<a class="sourceLine" id="cb19-55" title="55"></a>
<a class="sourceLine" id="cb19-56" title="56"><span class="co"># Before calling library(&quot;edgeR&quot;);</span></a>
<a class="sourceLine" id="cb19-57" title="57"></a>
<a class="sourceLine" id="cb19-58" title="58"><span class="kw">library</span>(<span class="dt">help =</span> <span class="st">&quot;edgeR&quot;</span>)</a>
<a class="sourceLine" id="cb19-59" title="59"></a>
<a class="sourceLine" id="cb19-60" title="60"><span class="co"># Above should tell you what classes and functions are</span></a>
<a class="sourceLine" id="cb19-61" title="61"><span class="co"># available in the edgeR package. Then you can see</span></a>
<a class="sourceLine" id="cb19-62" title="62"><span class="co"># the help for those as below.</span></a>
<a class="sourceLine" id="cb19-63" title="63"></a>
<a class="sourceLine" id="cb19-64" title="64"><span class="kw">help</span>(<span class="st">&quot;DGEList&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;edgeR&quot;</span>)</a>
<a class="sourceLine" id="cb19-65" title="65"><span class="kw">help</span>(<span class="st">&quot;DGEList-class&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;edgeR&quot;</span>)</a>
<a class="sourceLine" id="cb19-66" title="66"></a>
<a class="sourceLine" id="cb19-67" title="67"></a>
<a class="sourceLine" id="cb19-68" title="68"><span class="co"># After calling library(&quot;edgeR&quot;);</span></a>
<a class="sourceLine" id="cb19-69" title="69"><span class="kw">library</span>(<span class="st">&quot;edgeR&quot;</span>);</a>
<a class="sourceLine" id="cb19-70" title="70"><span class="kw">methods</span>(<span class="dt">class =</span> <span class="st">&quot;DGEList&quot;</span>);</a>
<a class="sourceLine" id="cb19-71" title="71"><span class="kw">help</span>(<span class="st">&quot;DGEList-class&quot;</span>)</a>
<a class="sourceLine" id="cb19-72" title="72"><span class="kw">help</span>(<span class="st">&quot;DGEList&quot;</span>)</a>
<a class="sourceLine" id="cb19-73" title="73"><span class="kw">help</span>(<span class="st">&quot;subsetting&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;edgeR&quot;</span>);</a>
<a class="sourceLine" id="cb19-74" title="74"></a>
<a class="sourceLine" id="cb19-75" title="75"><span class="kw">methods</span>(<span class="dt">class =</span> <span class="st">&quot;DGEGLM&quot;</span>);</a>
<a class="sourceLine" id="cb19-76" title="76"><span class="kw">help</span>(<span class="st">&quot;DGEGLM-class&quot;</span>)</a>
<a class="sourceLine" id="cb19-77" title="77"><span class="kw">help</span>(<span class="st">&quot;DGEGLM&quot;</span>)</a>
<a class="sourceLine" id="cb19-78" title="78"></a>
<a class="sourceLine" id="cb19-79" title="79"><span class="co">### Operator Precedence</span></a>
<a class="sourceLine" id="cb19-80" title="80"></a>
<a class="sourceLine" id="cb19-81" title="81"><span class="kw">help</span>(<span class="st">&quot;Syntax&quot;</span>);</a>
<a class="sourceLine" id="cb19-82" title="82"></a>
<a class="sourceLine" id="cb19-83" title="83"><span class="co">### Reserved words</span></a>
<a class="sourceLine" id="cb19-84" title="84"></a>
<a class="sourceLine" id="cb19-85" title="85"><span class="kw">help</span>(<span class="st">&quot;Reserved&quot;</span>);</a></code></pre></div>
<!-- >>> -->
<!-- <<< recycling.r -->
<h1 id="recycling">Recycling</h1>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co">######################################</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co">### Recycling in Vector operations </span><span class="al">###</span></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="co">######################################</span></a>
<a class="sourceLine" id="cb20-5" title="5"></a>
<a class="sourceLine" id="cb20-6" title="6"></a>
<a class="sourceLine" id="cb20-7" title="7"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb20-10" title="10"></a>
<a class="sourceLine" id="cb20-11" title="11"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb20-12" title="12"></a>
<a class="sourceLine" id="cb20-13" title="13"><span class="co"># 1. Store the sequence from 1 to 5 in vector x.</span></a>
<a class="sourceLine" id="cb20-14" title="14"><span class="co"># 2. Store the sequence from 21 to 25 in vector y.</span></a>
<a class="sourceLine" id="cb20-15" title="15"><span class="co"># 3. Examine the result of y * x.</span></a>
<a class="sourceLine" id="cb20-16" title="16"></a>
<a class="sourceLine" id="cb20-17" title="17"><span class="co">#############################################################</span></a>
<a class="sourceLine" id="cb20-18" title="18">  </a>
<a class="sourceLine" id="cb20-19" title="19"><span class="co"># 4. Store the sequence from 21 to 30 in vector z.</span></a>
<a class="sourceLine" id="cb20-20" title="20"><span class="co"># 5. Confirm the lengths of x and z using the function length().</span></a>
<a class="sourceLine" id="cb20-21" title="21"><span class="co"># 6. Examine the result of z * x.</span></a>
<a class="sourceLine" id="cb20-22" title="22"></a>
<a class="sourceLine" id="cb20-23" title="23"><span class="co">#############################################################</span></a>
<a class="sourceLine" id="cb20-24" title="24">  </a>
<a class="sourceLine" id="cb20-25" title="25"><span class="co"># 7. Store the sequence from 1 to 7 in vector u.</span></a>
<a class="sourceLine" id="cb20-26" title="26"><span class="co"># 8. Examine the result of z * u.</span></a>
<a class="sourceLine" id="cb20-27" title="27"></a>
<a class="sourceLine" id="cb20-28" title="28"></a>
<a class="sourceLine" id="cb20-29" title="29"></a>
<a class="sourceLine" id="cb20-30" title="30"><span class="co">#############################################################</span></a>
<a class="sourceLine" id="cb20-31" title="31"><span class="co">#############################################################</span></a>
<a class="sourceLine" id="cb20-32" title="32"><span class="co"># In operations involving two vectors of unequal length, elements of the</span></a>
<a class="sourceLine" id="cb20-33" title="33"><span class="co"># shorter vector get recycled.</span></a>
<a class="sourceLine" id="cb20-34" title="34"><span class="co"># If the longer vector is not an integer multiple of the shorter vector</span></a>
<a class="sourceLine" id="cb20-35" title="35"><span class="co"># you get a warning but the operation is valid and successful.</span></a>
<a class="sourceLine" id="cb20-36" title="36"></a></code></pre></div>
<!-- >>> -->
<!-- <<< commonfunc.r -->
<h1 id="common-functions">Common Functions</h1>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="co">#############################</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="co">### Some Common Functions </span><span class="al">###</span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co">#############################</span></a>
<a class="sourceLine" id="cb21-5" title="5"></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co"># c(): concatenate.</span></a>
<a class="sourceLine" id="cb21-7" title="7"></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb21-9" title="9"></a>
<a class="sourceLine" id="cb21-10" title="10">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.17</span>, <span class="fl">3.14</span>, <span class="dv">13</span>, <span class="dv">29</span>, <span class="fl">48.356</span>);</a>
<a class="sourceLine" id="cb21-11" title="11">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">200</span>,<span class="dv">300</span>);</a>
<a class="sourceLine" id="cb21-12" title="12">z &lt;-<span class="st"> </span><span class="kw">c</span>(x, y);</a>
<a class="sourceLine" id="cb21-13" title="13">z;</a>
<a class="sourceLine" id="cb21-14" title="14"></a>
<a class="sourceLine" id="cb21-15" title="15"><span class="co"># length(): Return the length of the named object.</span></a>
<a class="sourceLine" id="cb21-16" title="16"><span class="kw">length</span>(x);</a>
<a class="sourceLine" id="cb21-17" title="17"><span class="kw">length</span>(y);</a>
<a class="sourceLine" id="cb21-18" title="18"></a>
<a class="sourceLine" id="cb21-19" title="19"><span class="co"># min() and max(): Minimum / Maximum element of an object.</span></a>
<a class="sourceLine" id="cb21-20" title="20"><span class="kw">min</span>(x);</a>
<a class="sourceLine" id="cb21-21" title="21"><span class="kw">min</span>(y);</a>
<a class="sourceLine" id="cb21-22" title="22"></a>
<a class="sourceLine" id="cb21-23" title="23"><span class="co"># mean() and median():</span></a>
<a class="sourceLine" id="cb21-24" title="24"><span class="kw">mean</span>(x);</a>
<a class="sourceLine" id="cb21-25" title="25"><span class="kw">median</span>(y);</a>
<a class="sourceLine" id="cb21-26" title="26"></a>
<a class="sourceLine" id="cb21-27" title="27"><span class="co"># summary(): Some key statistics about an object.</span></a>
<a class="sourceLine" id="cb21-28" title="28"><span class="kw">summary</span>(y);</a>
<a class="sourceLine" id="cb21-29" title="29"></a>
<a class="sourceLine" id="cb21-30" title="30"></a>
<a class="sourceLine" id="cb21-31" title="31"><span class="co">#####################</span></a>
<a class="sourceLine" id="cb21-32" title="32"><span class="co">### Rounding etc. </span><span class="al">###</span></a>
<a class="sourceLine" id="cb21-33" title="33"><span class="co">#####################</span></a>
<a class="sourceLine" id="cb21-34" title="34"></a>
<a class="sourceLine" id="cb21-35" title="35"><span class="co"># round()</span></a>
<a class="sourceLine" id="cb21-36" title="36">pi</a>
<a class="sourceLine" id="cb21-37" title="37"><span class="kw">round</span>(pi)</a>
<a class="sourceLine" id="cb21-38" title="38"><span class="kw">round</span>(pi, <span class="dv">3</span>);</a>
<a class="sourceLine" id="cb21-39" title="39"></a>
<a class="sourceLine" id="cb21-40" title="40"><span class="co"># signif()</span></a>
<a class="sourceLine" id="cb21-41" title="41"><span class="kw">signif</span>(pi)</a>
<a class="sourceLine" id="cb21-42" title="42"><span class="kw">signif</span>(pi, <span class="dv">6</span>);</a>
<a class="sourceLine" id="cb21-43" title="43"><span class="kw">signif</span>(pi, <span class="dv">3</span>);</a>
<a class="sourceLine" id="cb21-44" title="44"></a>
<a class="sourceLine" id="cb21-45" title="45"><span class="co"># floor()</span></a>
<a class="sourceLine" id="cb21-46" title="46"><span class="kw">floor</span>(pi)</a>
<a class="sourceLine" id="cb21-47" title="47"></a>
<a class="sourceLine" id="cb21-48" title="48"><span class="co"># ceiling()</span></a>
<a class="sourceLine" id="cb21-49" title="49"><span class="kw">ceiling</span>(pi)</a>
<a class="sourceLine" id="cb21-50" title="50"></a>
<a class="sourceLine" id="cb21-51" title="51"><span class="co">############################</span></a>
<a class="sourceLine" id="cb21-52" title="52"><span class="co">### paste() and paste0() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb21-53" title="53"><span class="co">############################</span></a>
<a class="sourceLine" id="cb21-54" title="54"></a>
<a class="sourceLine" id="cb21-55" title="55"><span class="co"># Always return a character vector.</span></a>
<a class="sourceLine" id="cb21-56" title="56"></a>
<a class="sourceLine" id="cb21-57" title="57"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb21-58" title="58"></a>
<a class="sourceLine" id="cb21-59" title="59">x &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]</a>
<a class="sourceLine" id="cb21-60" title="60">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>);</a>
<a class="sourceLine" id="cb21-61" title="61"></a>
<a class="sourceLine" id="cb21-62" title="62"><span class="kw">paste</span>(x);</a>
<a class="sourceLine" id="cb21-63" title="63"><span class="kw">paste</span>(y);   <span class="co"># A character vector.</span></a>
<a class="sourceLine" id="cb21-64" title="64"><span class="kw">typeof</span>(<span class="kw">paste</span>(y));</a>
<a class="sourceLine" id="cb21-65" title="65"></a>
<a class="sourceLine" id="cb21-66" title="66"><span class="kw">paste</span>(x, y);</a>
<a class="sourceLine" id="cb21-67" title="67"><span class="kw">paste0</span>(x, y);  <span class="co"># No separator.</span></a>
<a class="sourceLine" id="cb21-68" title="68"></a>
<a class="sourceLine" id="cb21-69" title="69">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>);</a>
<a class="sourceLine" id="cb21-70" title="70"><span class="kw">paste0</span>(x, y);  <span class="co"># y is shorter than x, hence recycling.</span></a>
<a class="sourceLine" id="cb21-71" title="71"></a>
<a class="sourceLine" id="cb21-72" title="72">z &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;.k1&quot;</span>, <span class="st">&quot;.k2&quot;</span>);</a>
<a class="sourceLine" id="cb21-73" title="73"><span class="kw">paste0</span>(x, y, z); <span class="co"># z is also recycled as needed.</span></a>
<a class="sourceLine" id="cb21-74" title="74"></a>
<a class="sourceLine" id="cb21-75" title="75"></a>
<a class="sourceLine" id="cb21-76" title="76"><span class="co"># You can &quot;collapse&quot; the resulting vector to a single</span></a>
<a class="sourceLine" id="cb21-77" title="77"><span class="co"># string.</span></a>
<a class="sourceLine" id="cb21-78" title="78"></a>
<a class="sourceLine" id="cb21-79" title="79"><span class="kw">paste0</span>(x, y, <span class="dt">collapse =</span> <span class="st">&quot; &quot;</span>);</a>
<a class="sourceLine" id="cb21-80" title="80"></a>
<a class="sourceLine" id="cb21-81" title="81"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb21-82" title="82"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb21-83" title="83"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb21-84" title="84"></a>
<a class="sourceLine" id="cb21-85" title="85">mtl &lt;-<span class="st"> </span>LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]</a>
<a class="sourceLine" id="cb21-86" title="86">mtn &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">12</span>)</a>
<a class="sourceLine" id="cb21-87" title="87"></a>
<a class="sourceLine" id="cb21-88" title="88"><span class="co"># Using rep() and paste0() and the two vectors made</span></a>
<a class="sourceLine" id="cb21-89" title="89"><span class="co"># above, make a vector of all the addresses on a 96</span></a>
<a class="sourceLine" id="cb21-90" title="90"><span class="co"># well microtitre plate.</span></a>
<a class="sourceLine" id="cb21-91" title="91"></a>
<a class="sourceLine" id="cb21-92" title="92"><span class="co"># A1 to A12 then B1 to B12 ... H1 to H12.</span></a>
<a class="sourceLine" id="cb21-93" title="93"></a>
<a class="sourceLine" id="cb21-94" title="94"><span class="co"># Hint: call to rep() will go inside the call to paste0()</span></a>
<a class="sourceLine" id="cb21-95" title="95"><span class="co"># and will also use the named argument &quot;each&quot;.</span></a>
<a class="sourceLine" id="cb21-96" title="96"></a>
<a class="sourceLine" id="cb21-97" title="97"></a></code></pre></div>
<!-- >>> -->
<!-- <<< lists.r -->
<h1 id="lists">Lists</h1>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co">#############</span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="co">### Lists </span><span class="al">###</span></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="co">#############</span></a>
<a class="sourceLine" id="cb22-5" title="5"></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="co"># Lists are &quot;generic&quot; vectors.</span></a>
<a class="sourceLine" id="cb22-7" title="7"></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="co"># Individual elements of a list can refer to any type of</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="co"># R object of any complexity, including other lists.</span></a>
<a class="sourceLine" id="cb22-10" title="10"></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="co"># This allows for the creation of objects of arbitrary</span></a>
<a class="sourceLine" id="cb22-12" title="12"><span class="co"># complexity.</span></a>
<a class="sourceLine" id="cb22-13" title="13"></a>
<a class="sourceLine" id="cb22-14" title="14"><span class="co"># Functions returning a lot of related information</span></a>
<a class="sourceLine" id="cb22-15" title="15"><span class="co"># often return their results as lists.</span></a>
<a class="sourceLine" id="cb22-16" title="16"></a>
<a class="sourceLine" id="cb22-17" title="17"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb22-18" title="18"></a>
<a class="sourceLine" id="cb22-19" title="19">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>, <span class="dt">by =</span> <span class="dv">5</span>);</a>
<a class="sourceLine" id="cb22-20" title="20">y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>);</a>
<a class="sourceLine" id="cb22-21" title="21">i &lt;-<span class="st"> </span><span class="kw">list</span>(x, y);</a>
<a class="sourceLine" id="cb22-22" title="22"></a>
<a class="sourceLine" id="cb22-23" title="23">i;</a>
<a class="sourceLine" id="cb22-24" title="24">i[<span class="dv">1</span>];   <span class="co"># list</span></a>
<a class="sourceLine" id="cb22-25" title="25">i[[<span class="dv">1</span>]]; <span class="co"># vector</span></a>
<a class="sourceLine" id="cb22-26" title="26"><span class="kw">class</span>(i[<span class="dv">1</span>]);</a>
<a class="sourceLine" id="cb22-27" title="27"><span class="kw">class</span>(i[[<span class="dv">1</span>]]);</a>
<a class="sourceLine" id="cb22-28" title="28"></a>
<a class="sourceLine" id="cb22-29" title="29"><span class="kw">names</span>(i) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;numbers&quot;</span>, <span class="st">&quot;strings&quot;</span>);</a>
<a class="sourceLine" id="cb22-30" title="30"></a>
<a class="sourceLine" id="cb22-31" title="31">i[<span class="st">&quot;numbers&quot;</span>];</a>
<a class="sourceLine" id="cb22-32" title="32">i[[<span class="st">&quot;numbers&quot;</span>]];</a>
<a class="sourceLine" id="cb22-33" title="33"><span class="kw">names</span>(i);</a>
<a class="sourceLine" id="cb22-34" title="34"></a>
<a class="sourceLine" id="cb22-35" title="35"></a>
<a class="sourceLine" id="cb22-36" title="36">j &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">numbers =</span> x, <span class="dt">strings =</span> y, <span class="dt">serial =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>));</a>
<a class="sourceLine" id="cb22-37" title="37"></a>
<a class="sourceLine" id="cb22-38" title="38">j[[<span class="st">&quot;serial&quot;</span>]][<span class="dv">3</span><span class="op">:</span><span class="dv">10</span>];</a>
<a class="sourceLine" id="cb22-39" title="39">j<span class="op">$</span>serial;</a>
<a class="sourceLine" id="cb22-40" title="40">j<span class="op">$</span>serial[<span class="dv">15</span><span class="op">:</span><span class="dv">20</span>];</a>
<a class="sourceLine" id="cb22-41" title="41"></a>
<a class="sourceLine" id="cb22-42" title="42"><span class="co">################</span></a>
<a class="sourceLine" id="cb22-43" title="43"><span class="co">### unlist() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb22-44" title="44"><span class="co">################</span></a>
<a class="sourceLine" id="cb22-45" title="45"></a>
<a class="sourceLine" id="cb22-46" title="46"><span class="kw">unlist</span>(j); <span class="co"># all atomic components of j in a vector</span></a>
<a class="sourceLine" id="cb22-47" title="47"><span class="co"># Notice coercion above.</span></a>
<a class="sourceLine" id="cb22-48" title="48"></a>
<a class="sourceLine" id="cb22-49" title="49">k &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> <span class="kw">seq</span>(<span class="dv">200</span>, <span class="dv">400</span>, <span class="dt">by =</span> <span class="dv">10</span>));</a>
<a class="sourceLine" id="cb22-50" title="50">k</a>
<a class="sourceLine" id="cb22-51" title="51"><span class="kw">unlist</span>(k)</a>
<a class="sourceLine" id="cb22-52" title="52"><span class="kw">class</span>(<span class="kw">unlist</span>(k))</a>
<a class="sourceLine" id="cb22-53" title="53"></a>
<a class="sourceLine" id="cb22-54" title="54"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb22-55" title="55"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb22-56" title="56"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb22-57" title="57"></a>
<a class="sourceLine" id="cb22-58" title="58"><span class="co"># 1. Make a vector of characters A to N by appropriately</span></a>
<a class="sourceLine" id="cb22-59" title="59"><span class="co"># subsetting LETTERS.</span></a>
<a class="sourceLine" id="cb22-60" title="60"></a>
<a class="sourceLine" id="cb22-61" title="61"><span class="co"># 2. Make a vector of integers from 10 to 20.</span></a>
<a class="sourceLine" id="cb22-62" title="62"></a>
<a class="sourceLine" id="cb22-63" title="63"><span class="co"># 3. Make a list li, with two named elements, alpha</span></a>
<a class="sourceLine" id="cb22-64" title="64"><span class="co"># containing the vector made in step 1 above and, beta</span></a>
<a class="sourceLine" id="cb22-65" title="65"><span class="co"># containing the vector made in step 2 above.</span></a>
<a class="sourceLine" id="cb22-66" title="66"></a>
<a class="sourceLine" id="cb22-67" title="67"><span class="co"># 4. Display the names of the elements in the list made</span></a>
<a class="sourceLine" id="cb22-68" title="68"><span class="co"># above.</span></a>
<a class="sourceLine" id="cb22-69" title="69"></a>
<a class="sourceLine" id="cb22-70" title="70"><span class="co"># 5. In one step, extract the fourth element from the</span></a>
<a class="sourceLine" id="cb22-71" title="71"><span class="co"># alpha member of li.</span></a>
<a class="sourceLine" id="cb22-72" title="72"></a>
<a class="sourceLine" id="cb22-73" title="73"><span class="co"># What does length(li) return?</span></a></code></pre></div>
<!-- >>> -->
<!-- <<< attributes.r -->
<h1 id="attributes">Attributes</h1>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="co">##################</span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="co">### Attributes </span><span class="al">###</span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="co">##################</span></a>
<a class="sourceLine" id="cb23-5" title="5"></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="co"># Objects can have attributes attached to them.</span></a>
<a class="sourceLine" id="cb23-7" title="7"></a>
<a class="sourceLine" id="cb23-8" title="8"><span class="co"># Think of them as arbitrary name = value pairs.</span></a>
<a class="sourceLine" id="cb23-9" title="9"></a>
<a class="sourceLine" id="cb23-10" title="10"><span class="co"># attributes()</span></a>
<a class="sourceLine" id="cb23-11" title="11"></a>
<a class="sourceLine" id="cb23-12" title="12"><span class="co"># attr()</span></a>
<a class="sourceLine" id="cb23-13" title="13"></a>
<a class="sourceLine" id="cb23-14" title="14"><span class="co"># The following are used by R.</span></a>
<a class="sourceLine" id="cb23-15" title="15"></a>
<a class="sourceLine" id="cb23-16" title="16"><span class="co"># 1. Names. names().</span></a>
<a class="sourceLine" id="cb23-17" title="17"></a>
<a class="sourceLine" id="cb23-18" title="18"><span class="co"># 2. Dimensions. dim(). Matrices and Arrays which we</span></a>
<a class="sourceLine" id="cb23-19" title="19"><span class="co"># will see later on are vectors with the dim attribute</span></a>
<a class="sourceLine" id="cb23-20" title="20"><span class="co"># attached to them.</span></a>
<a class="sourceLine" id="cb23-21" title="21"></a>
<a class="sourceLine" id="cb23-22" title="22"><span class="co"># 3. Dimnames. dimnames(). If dimensions are named</span></a>
<a class="sourceLine" id="cb23-23" title="23"><span class="co"># the names are stored in the dimnames attribute of the</span></a>
<a class="sourceLine" id="cb23-24" title="24"><span class="co"># array or matrix.</span></a>
<a class="sourceLine" id="cb23-25" title="25"></a>
<a class="sourceLine" id="cb23-26" title="26"><span class="co"># 4. Class. class(). The name of the class an object</span></a>
<a class="sourceLine" id="cb23-27" title="27"><span class="co"># belongs to is stored in and attribute named class.</span></a>
<a class="sourceLine" id="cb23-28" title="28"></a>
<a class="sourceLine" id="cb23-29" title="29"><span class="co">###################################################</span></a>
<a class="sourceLine" id="cb23-30" title="30"><span class="co">### Step and think through the statements below </span><span class="al">###</span></a>
<a class="sourceLine" id="cb23-31" title="31"><span class="co">###################################################</span></a>
<a class="sourceLine" id="cb23-32" title="32"></a>
<a class="sourceLine" id="cb23-33" title="33"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb23-34" title="34"></a>
<a class="sourceLine" id="cb23-35" title="35">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>);</a>
<a class="sourceLine" id="cb23-36" title="36">x</a>
<a class="sourceLine" id="cb23-37" title="37"><span class="kw">class</span>(x);</a>
<a class="sourceLine" id="cb23-38" title="38"><span class="kw">class</span>(x) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">class</span>(x), <span class="st">&quot;adr&quot;</span>);</a>
<a class="sourceLine" id="cb23-39" title="39"><span class="kw">class</span>(x);</a>
<a class="sourceLine" id="cb23-40" title="40"></a>
<a class="sourceLine" id="cb23-41" title="41"><span class="kw">attr</span>(x, <span class="st">&quot;purpose&quot;</span>)</a>
<a class="sourceLine" id="cb23-42" title="42"><span class="kw">attr</span>(x, <span class="st">&quot;purpose&quot;</span>) &lt;-<span class="st"> &quot;testing&quot;</span>;</a>
<a class="sourceLine" id="cb23-43" title="43"><span class="kw">attr</span>(x, <span class="st">&quot;purpose&quot;</span>)</a>
<a class="sourceLine" id="cb23-44" title="44"><span class="kw">attr</span>(x, <span class="st">&quot;purpose&quot;</span>) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">attr</span>(x, <span class="st">&quot;purpose&quot;</span>), <span class="st">&quot;training&quot;</span>)</a>
<a class="sourceLine" id="cb23-45" title="45"><span class="kw">attr</span>(x, <span class="st">&quot;purpose&quot;</span>)</a>
<a class="sourceLine" id="cb23-46" title="46"></a>
<a class="sourceLine" id="cb23-47" title="47"><span class="kw">attributes</span>(x);</a></code></pre></div>
<!-- >>> -->
<!-- <<< dataframes.r -->
<h1 id="data-frames-and-tibbles">Data Frames and Tibbles</h1>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="co">###############################</span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="co">### Data Frames and tibbles </span><span class="al">###</span></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="co">###############################</span></a>
<a class="sourceLine" id="cb24-5" title="5"></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="co"># Like two dimensional tables where columns are vectors.</span></a>
<a class="sourceLine" id="cb24-7" title="7"></a>
<a class="sourceLine" id="cb24-8" title="8"><span class="co"># Columns can be of different types.</span></a>
<a class="sourceLine" id="cb24-9" title="9"></a>
<a class="sourceLine" id="cb24-10" title="10"><span class="co"># All values in any one column have to be of the same type.</span></a>
<a class="sourceLine" id="cb24-11" title="11"></a>
<a class="sourceLine" id="cb24-12" title="12"><span class="co"># All columns have to be of the same length.</span></a>
<a class="sourceLine" id="cb24-13" title="13"></a>
<a class="sourceLine" id="cb24-14" title="14"><span class="co"># Commonly used for getting data into R from text files.</span></a>
<a class="sourceLine" id="cb24-15" title="15"></a>
<a class="sourceLine" id="cb24-16" title="16"><span class="co"># Tibbles don&#39;t have row names.</span></a>
<a class="sourceLine" id="cb24-17" title="17"></a>
<a class="sourceLine" id="cb24-18" title="18"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb24-19" title="19"><span class="co">### Reading MS Excel files </span><span class="al">###</span></a>
<a class="sourceLine" id="cb24-20" title="20"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb24-21" title="21"></a>
<a class="sourceLine" id="cb24-22" title="22"><span class="co"># Package named readxl provides functions for reading</span></a>
<a class="sourceLine" id="cb24-23" title="23"><span class="co"># Microsoft Excel files.</span></a>
<a class="sourceLine" id="cb24-24" title="24"></a>
<a class="sourceLine" id="cb24-25" title="25"><span class="co"># If the package readxl is not installed then you can</span></a>
<a class="sourceLine" id="cb24-26" title="26"><span class="co"># install it by doing the following.</span></a>
<a class="sourceLine" id="cb24-27" title="27"></a>
<a class="sourceLine" id="cb24-28" title="28"><span class="co"># install.packages(&quot;readxl&quot;);</span></a>
<a class="sourceLine" id="cb24-29" title="29"></a>
<a class="sourceLine" id="cb24-30" title="30"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb24-31" title="31"></a>
<a class="sourceLine" id="cb24-32" title="32"><span class="kw">library</span>(<span class="st">&quot;readxl&quot;</span>);</a>
<a class="sourceLine" id="cb24-33" title="33"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>);</a>
<a class="sourceLine" id="cb24-34" title="34"></a>
<a class="sourceLine" id="cb24-35" title="35"><span class="co"># Make sure I tell you about name conflicts and how to deal with</span></a>
<a class="sourceLine" id="cb24-36" title="36"><span class="co"># them.</span></a>
<a class="sourceLine" id="cb24-37" title="37"></a>
<a class="sourceLine" id="cb24-38" title="38"><span class="co"># Determine for format of the excel file. .xlsx or .xls</span></a>
<a class="sourceLine" id="cb24-39" title="39"><span class="kw">excel_format</span>(<span class="st">&quot;data/file.xlsx&quot;</span>)</a>
<a class="sourceLine" id="cb24-40" title="40"></a>
<a class="sourceLine" id="cb24-41" title="41"><span class="co"># See names of sheets in the excel file.</span></a>
<a class="sourceLine" id="cb24-42" title="42"><span class="kw">excel_sheets</span>(<span class="st">&quot;data/file.xlsx&quot;</span>)</a>
<a class="sourceLine" id="cb24-43" title="43"></a>
<a class="sourceLine" id="cb24-44" title="44"></a>
<a class="sourceLine" id="cb24-45" title="45"><span class="co"># Read the sheet named &quot;hyphal_width&quot;.</span></a>
<a class="sourceLine" id="cb24-46" title="46">hwt &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;data/file.xlsx&quot;</span>, <span class="dt">sheet =</span> <span class="st">&quot;hyphal_width&quot;</span>)</a>
<a class="sourceLine" id="cb24-47" title="47"></a>
<a class="sourceLine" id="cb24-48" title="48"><span class="co"># Read the first sheet in the file.</span></a>
<a class="sourceLine" id="cb24-49" title="49">hwt &lt;-<span class="st"> </span><span class="kw">read_xlsx</span>(<span class="st">&quot;data/file.xlsx&quot;</span>, <span class="dt">sheet =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb24-50" title="50"></a>
<a class="sourceLine" id="cb24-51" title="51">hwt</a>
<a class="sourceLine" id="cb24-52" title="52"></a>
<a class="sourceLine" id="cb24-53" title="53"><span class="kw">class</span>(hwt)</a>
<a class="sourceLine" id="cb24-54" title="54"></a>
<a class="sourceLine" id="cb24-55" title="55"><span class="co"># Demonstrate consequences on not having a header in the</span></a>
<a class="sourceLine" id="cb24-56" title="56"><span class="co"># excel spreadsheet.</span></a>
<a class="sourceLine" id="cb24-57" title="57"></a>
<a class="sourceLine" id="cb24-58" title="58">nht &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;data/noheader.xlsx&quot;</span>, <span class="dt">sheet =</span> <span class="st">&quot;hyphal_width&quot;</span>)</a>
<a class="sourceLine" id="cb24-59" title="59">nht</a>
<a class="sourceLine" id="cb24-60" title="60"></a>
<a class="sourceLine" id="cb24-61" title="61">nht &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;data/noheader.xlsx&quot;</span>, <span class="dt">sheet =</span> <span class="st">&quot;hyphal_width&quot;</span>,</a>
<a class="sourceLine" id="cb24-62" title="62">                 <span class="dt">col_names =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb24-63" title="63">nht <span class="co"># Notice the column names.</span></a>
<a class="sourceLine" id="cb24-64" title="64"></a>
<a class="sourceLine" id="cb24-65" title="65"><span class="co"># You can use colnames() to change the column names to more</span></a>
<a class="sourceLine" id="cb24-66" title="66"><span class="co"># meaningful ones after getting your tibble.</span></a>
<a class="sourceLine" id="cb24-67" title="67"></a>
<a class="sourceLine" id="cb24-68" title="68"><span class="kw">colnames</span>(nht) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;hw&quot;</span>, <span class="st">&quot;strain&quot;</span>, <span class="st">&quot;microscope&quot;</span>);</a>
<a class="sourceLine" id="cb24-69" title="69"></a>
<a class="sourceLine" id="cb24-70" title="70"><span class="co"># Or specify the column names in the call to read_excel().</span></a>
<a class="sourceLine" id="cb24-71" title="71"></a>
<a class="sourceLine" id="cb24-72" title="72">nht &lt;-<span class="st"> </span><span class="kw">read_excel</span>(<span class="st">&quot;data/noheader.xlsx&quot;</span>, <span class="dt">sheet =</span> <span class="st">&quot;hyphal_width&quot;</span>,</a>
<a class="sourceLine" id="cb24-73" title="73">                 <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;hw&quot;</span>, <span class="st">&quot;strain&quot;</span>, <span class="st">&quot;microscope&quot;</span>));</a>
<a class="sourceLine" id="cb24-74" title="74"></a>
<a class="sourceLine" id="cb24-75" title="75"><span class="co">#########################</span></a>
<a class="sourceLine" id="cb24-76" title="76"><span class="co">### Reading CSV files </span><span class="al">###</span></a>
<a class="sourceLine" id="cb24-77" title="77"><span class="co">#########################</span></a>
<a class="sourceLine" id="cb24-78" title="78"></a>
<a class="sourceLine" id="cb24-79" title="79"><span class="co"># In the past I have had problems reading MS Excel files in</span></a>
<a class="sourceLine" id="cb24-80" title="80"><span class="co"># R. In such cases you can write a csv from from Excel and</span></a>
<a class="sourceLine" id="cb24-81" title="81"><span class="co"># then use read.csv() or read_csv() to read the csv file</span></a>
<a class="sourceLine" id="cb24-82" title="82"><span class="co"># into a data frame or tibble.</span></a>
<a class="sourceLine" id="cb24-83" title="83"></a>
<a class="sourceLine" id="cb24-84" title="84"><span class="co"># In MS Excel, after making sure that there is a line of</span></a>
<a class="sourceLine" id="cb24-85" title="85"><span class="co"># header at the top, export your worksheet of interest</span></a>
<a class="sourceLine" id="cb24-86" title="86"><span class="co"># as a csv file.</span></a>
<a class="sourceLine" id="cb24-87" title="87"></a>
<a class="sourceLine" id="cb24-88" title="88"><span class="co"># Use read.csv() in R to read the csv file into a data</span></a>
<a class="sourceLine" id="cb24-89" title="89"><span class="co"># frame. read.csv() assumes the presence of a header.</span></a>
<a class="sourceLine" id="cb24-90" title="90"></a>
<a class="sourceLine" id="cb24-91" title="91"><span class="co"># Use read_csv() in R to read the csv file into a tibble.</span></a>
<a class="sourceLine" id="cb24-92" title="92"><span class="co"># read_csv() also assumes the presence of a header.</span></a>
<a class="sourceLine" id="cb24-93" title="93"></a>
<a class="sourceLine" id="cb24-94" title="94"><span class="co"># Some other named arguments to read.csv() which might</span></a>
<a class="sourceLine" id="cb24-95" title="95"><span class="co"># be useful are stringsAsFactors and row.names. We will</span></a>
<a class="sourceLine" id="cb24-96" title="96"><span class="co"># come to these later.</span></a>
<a class="sourceLine" id="cb24-97" title="97"></a>
<a class="sourceLine" id="cb24-98" title="98"></a>
<a class="sourceLine" id="cb24-99" title="99"><span class="co"># data frame</span></a>
<a class="sourceLine" id="cb24-100" title="100">hwf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/hw.csv&quot;</span>);</a>
<a class="sourceLine" id="cb24-101" title="101"><span class="kw">head</span>(hwf);</a>
<a class="sourceLine" id="cb24-102" title="102"><span class="kw">nrow</span>(hwf);</a>
<a class="sourceLine" id="cb24-103" title="103"></a>
<a class="sourceLine" id="cb24-104" title="104"><span class="co"># tibble</span></a>
<a class="sourceLine" id="cb24-105" title="105">hwt &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/hw.csv&quot;</span>);</a>
<a class="sourceLine" id="cb24-106" title="106">hwt;</a>
<a class="sourceLine" id="cb24-107" title="107"></a>
<a class="sourceLine" id="cb24-108" title="108"><span class="co"># If your csv file or spreadsheet has no column names make</span></a>
<a class="sourceLine" id="cb24-109" title="109"><span class="co"># sure you use &quot;col_names = FALSE&quot; or &quot;header = FALSE&quot;.</span></a>
<a class="sourceLine" id="cb24-110" title="110"></a>
<a class="sourceLine" id="cb24-111" title="111">nhf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/noheader.csv&quot;</span>);</a>
<a class="sourceLine" id="cb24-112" title="112"><span class="kw">head</span>(nhf);</a>
<a class="sourceLine" id="cb24-113" title="113"><span class="kw">nrow</span>(nhf);</a>
<a class="sourceLine" id="cb24-114" title="114"></a>
<a class="sourceLine" id="cb24-115" title="115">nht &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/noheader.csv&quot;</span>, <span class="dt">col_names =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb24-116" title="116">nht;</a>
<a class="sourceLine" id="cb24-117" title="117"></a>
<a class="sourceLine" id="cb24-118" title="118"><span class="kw">colnames</span>(nht) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;hw&quot;</span>, <span class="st">&quot;strain&quot;</span>, <span class="st">&quot;microscope&quot;</span>);</a>
<a class="sourceLine" id="cb24-119" title="119"></a>
<a class="sourceLine" id="cb24-120" title="120"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb24-121" title="121"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb24-122" title="122"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb24-123" title="123"></a>
<a class="sourceLine" id="cb24-124" title="124"><span class="co"># The sheet named &quot;expression&quot; in the file data/file.xlsx</span></a>
<a class="sourceLine" id="cb24-125" title="125"><span class="co"># contains the columns named &quot;gene&quot;, &quot;control&quot; and</span></a>
<a class="sourceLine" id="cb24-126" title="126"><span class="co"># &quot;treatment&quot;.</span></a>
<a class="sourceLine" id="cb24-127" title="127"></a>
<a class="sourceLine" id="cb24-128" title="128"><span class="co"># 1. Read this sheet into a tibble named &quot;expt&quot;;</span></a>
<a class="sourceLine" id="cb24-129" title="129"></a>
<a class="sourceLine" id="cb24-130" title="130"><span class="co"># 2. Try the commands colnames(), nrow(), ncol()</span></a>
<a class="sourceLine" id="cb24-131" title="131"><span class="co"># with expt as the only argument.</span></a>
<a class="sourceLine" id="cb24-132" title="132"></a>
<a class="sourceLine" id="cb24-133" title="133"><span class="co"># 3. Try the command class(expt).</span></a>
<a class="sourceLine" id="cb24-134" title="134"></a>
<a class="sourceLine" id="cb24-135" title="135"><span class="co"># 4. How will you change the column names &quot;control&quot; to &quot;WT&quot;</span></a>
<a class="sourceLine" id="cb24-136" title="136"><span class="co"># and &quot;treatment&quot; to &quot;dwhiG&quot;?</span></a></code></pre></div>
<!-- >>> -->
<!-- <<< options.r -->
<h1 id="options">Options</h1>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="co">###############</span></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="co">### Options </span><span class="al">###</span></a>
<a class="sourceLine" id="cb25-4" title="4"><span class="co">###############</span></a>
<a class="sourceLine" id="cb25-5" title="5"></a>
<a class="sourceLine" id="cb25-6" title="6"><span class="co"># Default behaviour in R is controlled by some global</span></a>
<a class="sourceLine" id="cb25-7" title="7"><span class="co"># options. stringsAsFactors is one of the options. To see</span></a>
<a class="sourceLine" id="cb25-8" title="8"><span class="co"># the setting of an option we use the function getOption.</span></a>
<a class="sourceLine" id="cb25-9" title="9"></a>
<a class="sourceLine" id="cb25-10" title="10"><span class="kw">getOption</span>(<span class="st">&quot;stringsAsFactors&quot;</span>);</a>
<a class="sourceLine" id="cb25-11" title="11"><span class="kw">getOption</span>(<span class="st">&quot;digits&quot;</span>);</a>
<a class="sourceLine" id="cb25-12" title="12"></a>
<a class="sourceLine" id="cb25-13" title="13"><span class="co"># To change or set options we use the function options().</span></a>
<a class="sourceLine" id="cb25-14" title="14"></a>
<a class="sourceLine" id="cb25-15" title="15"><span class="kw">options</span>(<span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>, <span class="dt">digits =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb25-16" title="16"><span class="dt">EBImage.display =</span> <span class="st">&quot;raster&quot;</span>);</a>
<a class="sourceLine" id="cb25-17" title="17"></a>
<a class="sourceLine" id="cb25-18" title="18"><span class="kw">getOption</span>(<span class="st">&quot;EBImage.display&quot;</span>);</a>
<a class="sourceLine" id="cb25-19" title="19"></a>
<a class="sourceLine" id="cb25-20" title="20"><span class="co"># Any option can be set; whether it has any effect or not</span></a>
<a class="sourceLine" id="cb25-21" title="21"><span class="co"># depends on whether base R or any package read it or not.</span></a>
<a class="sourceLine" id="cb25-22" title="22"></a>
<a class="sourceLine" id="cb25-23" title="23"><span class="kw">options</span>(<span class="dt">thisMeansNothing =</span> <span class="st">&quot;really&quot;</span>);</a>
<a class="sourceLine" id="cb25-24" title="24"><span class="kw">getOption</span>(<span class="st">&quot;thisMeansNothing&quot;</span>);</a></code></pre></div>
<!-- >>> -->
<!-- <<< factors.r -->
<h1 id="factors">Factors</h1>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="co">###############</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="co">### Factors </span><span class="al">###</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="co">###############</span></a>
<a class="sourceLine" id="cb26-5" title="5"></a>
<a class="sourceLine" id="cb26-6" title="6"></a>
<a class="sourceLine" id="cb26-7" title="7"><span class="co"># Think of them as categories.</span></a>
<a class="sourceLine" id="cb26-8" title="8"></a>
<a class="sourceLine" id="cb26-9" title="9"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb26-10" title="10"></a>
<a class="sourceLine" id="cb26-11" title="11">numbers &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.200261</span>, <span class="fl">1.479827</span>, <span class="fl">1.482392</span>, <span class="fl">1.716793</span>, <span class="fl">1.518791</span>, <span class="fl">1.000030</span>,</a>
<a class="sourceLine" id="cb26-12" title="12">             <span class="fl">1.933209</span>, <span class="fl">1.841415</span>, <span class="fl">1.315890</span>, <span class="fl">1.849663</span>);</a>
<a class="sourceLine" id="cb26-13" title="13"></a>
<a class="sourceLine" id="cb26-14" title="14">category &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;A&quot;</span>,</a>
<a class="sourceLine" id="cb26-15" title="15">              <span class="st">&quot;C&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>);</a>
<a class="sourceLine" id="cb26-16" title="16"></a>
<a class="sourceLine" id="cb26-17" title="17">f &lt;-<span class="st"> </span><span class="kw">factor</span>(category);</a>
<a class="sourceLine" id="cb26-18" title="18"></a>
<a class="sourceLine" id="cb26-19" title="19"><span class="kw">typeof</span>(category);</a>
<a class="sourceLine" id="cb26-20" title="20"></a>
<a class="sourceLine" id="cb26-21" title="21"><span class="kw">class</span>(category);</a>
<a class="sourceLine" id="cb26-22" title="22"></a>
<a class="sourceLine" id="cb26-23" title="23"><span class="kw">typeof</span>(f);</a>
<a class="sourceLine" id="cb26-24" title="24"></a>
<a class="sourceLine" id="cb26-25" title="25"><span class="kw">class</span>(f);</a>
<a class="sourceLine" id="cb26-26" title="26"></a>
<a class="sourceLine" id="cb26-27" title="27"><span class="co">#####################################################</span></a>
<a class="sourceLine" id="cb26-28" title="28">  </a>
<a class="sourceLine" id="cb26-29" title="29"><span class="kw">tapply</span>(numbers, f, mean);</a>
<a class="sourceLine" id="cb26-30" title="30"></a>
<a class="sourceLine" id="cb26-31" title="31"><span class="kw">tapply</span>(numbers, category, mean);</a>
<a class="sourceLine" id="cb26-32" title="32"></a>
<a class="sourceLine" id="cb26-33" title="33"><span class="kw">levels</span>(f);</a>
<a class="sourceLine" id="cb26-34" title="34"></a>
<a class="sourceLine" id="cb26-35" title="35"><span class="kw">levels</span>(category)</a>
<a class="sourceLine" id="cb26-36" title="36"></a>
<a class="sourceLine" id="cb26-37" title="37"></a>
<a class="sourceLine" id="cb26-38" title="38"><span class="co"># Allow you to assign individual elements of a vector to</span></a>
<a class="sourceLine" id="cb26-39" title="39"><span class="co"># groups or categories.</span></a>
<a class="sourceLine" id="cb26-40" title="40"></a>
<a class="sourceLine" id="cb26-41" title="41"><span class="co"># Using factors you can do calculations such as mean(),</span></a>
<a class="sourceLine" id="cb26-42" title="42"><span class="co"># sd() etc. on a group-by-group basis.</span></a>
<a class="sourceLine" id="cb26-43" title="43"></a>
<a class="sourceLine" id="cb26-44" title="44"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb26-45" title="45"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb26-46" title="46"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb26-47" title="47"></a>
<a class="sourceLine" id="cb26-48" title="48"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb26-49" title="49"></a>
<a class="sourceLine" id="cb26-50" title="50">hwf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/hw.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb26-51" title="51"><span class="kw">head</span>(hwf);</a>
<a class="sourceLine" id="cb26-52" title="52"><span class="kw">nrow</span>(hwf);</a>
<a class="sourceLine" id="cb26-53" title="53"></a>
<a class="sourceLine" id="cb26-54" title="54"><span class="co"># 1. Find out the class of hwf$strain.</span></a>
<a class="sourceLine" id="cb26-55" title="55"></a>
<a class="sourceLine" id="cb26-56" title="56"><span class="co"># 2. Determine the number of distinct strains in hwf.</span></a>
<a class="sourceLine" id="cb26-57" title="57"></a>
<a class="sourceLine" id="cb26-58" title="58"><span class="co"># 3. Use tapply() to calculate the mean of the hyphal</span></a>
<a class="sourceLine" id="cb26-59" title="59"><span class="co"># widths for each of the strains in hwf.</span></a>
<a class="sourceLine" id="cb26-60" title="60"></a>
<a class="sourceLine" id="cb26-61" title="61"><span class="co"># 4. Use tapply() to calculate the standard deviation of</span></a>
<a class="sourceLine" id="cb26-62" title="62"><span class="co"># the hyphal widths for each of the strains in hwf.</span></a>
<a class="sourceLine" id="cb26-63" title="63"></a>
<a class="sourceLine" id="cb26-64" title="64"></a>
<a class="sourceLine" id="cb26-65" title="65"><span class="co">### Tidyverse style </span><span class="al">###</span></a>
<a class="sourceLine" id="cb26-66" title="66"></a>
<a class="sourceLine" id="cb26-67" title="67"><span class="co"># Tidyverse functions read_excel and read_csv etc. do not</span></a>
<a class="sourceLine" id="cb26-68" title="68"><span class="co"># make factors when they read data in. If you need to, you</span></a>
<a class="sourceLine" id="cb26-69" title="69"><span class="co"># can convert the columns you want to factors as below.</span></a>
<a class="sourceLine" id="cb26-70" title="70"><span class="co"># read_csv() has an option (col_types) to let you specify</span></a>
<a class="sourceLine" id="cb26-71" title="71"><span class="co"># column types when you are reading data in.</span></a>
<a class="sourceLine" id="cb26-72" title="72"></a>
<a class="sourceLine" id="cb26-73" title="73">hwt &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/hw.csv&quot;</span>);</a>
<a class="sourceLine" id="cb26-74" title="74">hwt;</a>
<a class="sourceLine" id="cb26-75" title="75"></a>
<a class="sourceLine" id="cb26-76" title="76"><span class="kw">mutate</span>(hwt, <span class="dt">strain =</span> <span class="kw">factor</span>(strain),</a>
<a class="sourceLine" id="cb26-77" title="77">       <span class="dt">microscope =</span> <span class="kw">factor</span>(microscope))</a>
<a class="sourceLine" id="cb26-78" title="78"></a>
<a class="sourceLine" id="cb26-79" title="79"><span class="co"># group_by() and summarise() by piping</span></a>
<a class="sourceLine" id="cb26-80" title="80"><span class="kw">group_by</span>(hwt, strain) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-81" title="81"><span class="kw">summarise</span>(<span class="dt">grmean =</span> <span class="kw">mean</span>(hw));</a>
<a class="sourceLine" id="cb26-82" title="82"></a>
<a class="sourceLine" id="cb26-83" title="83"><span class="kw">group_by</span>(hwt, microscope) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb26-84" title="84"><span class="kw">summarise</span>(<span class="dt">grmean =</span> <span class="kw">mean</span>(hw));</a>
<a class="sourceLine" id="cb26-85" title="85"></a>
<a class="sourceLine" id="cb26-86" title="86"><span class="co"># Via an intermediate object.</span></a>
<a class="sourceLine" id="cb26-87" title="87">bygr &lt;-<span class="st"> </span><span class="kw">group_by</span>(hwt, strain);</a>
<a class="sourceLine" id="cb26-88" title="88"><span class="kw">summarise</span>(bygr, <span class="dt">grmean =</span> <span class="kw">mean</span>(hw));</a></code></pre></div>
<!-- >>> -->
<!-- <<< models.r -->
<h1 id="statistical-models">Statistical Models</h1>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="co">###############################</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="co">### Statistical Models in R </span><span class="al">###</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="co">###############################</span></a>
<a class="sourceLine" id="cb27-5" title="5"></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="co"># Normal</span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="co"># rnorm(): random generation function</span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="co"># pnorm(): probability density function</span></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="co"># dnorm(): density function</span></a>
<a class="sourceLine" id="cb27-10" title="10"><span class="co"># qnorm(): quantile function</span></a>
<a class="sourceLine" id="cb27-11" title="11"><span class="co"># Similarly for uniform, binomial, gamma, t, etc.</span></a>
<a class="sourceLine" id="cb27-12" title="12"></a>
<a class="sourceLine" id="cb27-13" title="13"><span class="co">### Example: Normal distribution.</span></a>
<a class="sourceLine" id="cb27-14" title="14"></a>
<a class="sourceLine" id="cb27-15" title="15"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb27-16" title="16"></a>
<a class="sourceLine" id="cb27-17" title="17">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">500</span>, <span class="dt">mean =</span> <span class="dv">15</span>, <span class="dt">sd =</span> <span class="dv">5</span>);</a>
<a class="sourceLine" id="cb27-18" title="18"></a>
<a class="sourceLine" id="cb27-19" title="19"><span class="kw">pnorm</span>(<span class="dv">35</span>, <span class="dt">mean =</span> <span class="dv">15</span>, <span class="dt">sd =</span> <span class="dv">5</span>);  <span class="co"># P(X &lt;= 35).</span></a>
<a class="sourceLine" id="cb27-20" title="20"></a>
<a class="sourceLine" id="cb27-21" title="21"><span class="kw">pnorm</span>(<span class="dv">35</span>, <span class="dt">mean =</span> <span class="dv">15</span>, <span class="dt">sd =</span> <span class="dv">5</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>);  <span class="co"># P(X &gt; 35)</span></a>
<a class="sourceLine" id="cb27-22" title="22"></a>
<a class="sourceLine" id="cb27-23" title="23"><span class="kw">dnorm</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>), <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb27-24" title="24"></a>
<a class="sourceLine" id="cb27-25" title="25"></a>
<a class="sourceLine" id="cb27-26" title="26"><span class="co">###### Begin ignore ######</span></a>
<a class="sourceLine" id="cb27-27" title="27"></a>
<a class="sourceLine" id="cb27-28" title="28"><span class="co"># Below is to generate plots for explaining. We will see</span></a>
<a class="sourceLine" id="cb27-29" title="29"><span class="co"># some of these functions later we cover plotting. For now,</span></a>
<a class="sourceLine" id="cb27-30" title="30"><span class="co"># simply ignore.</span></a>
<a class="sourceLine" id="cb27-31" title="31"></a>
<a class="sourceLine" id="cb27-32" title="32"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">bg =</span> <span class="st">&quot;lightgrey&quot;</span>);</a>
<a class="sourceLine" id="cb27-33" title="33">bar &lt;-<span class="st"> </span><span class="dv">15</span>; xsd &lt;-<span class="st"> </span><span class="dv">3</span>;</a>
<a class="sourceLine" id="cb27-34" title="34">ddn &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb27-35" title="35">  <span class="kw">return</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean =</span> bar, <span class="dt">sd =</span> xsd))</a>
<a class="sourceLine" id="cb27-36" title="36">}</a>
<a class="sourceLine" id="cb27-37" title="37">cfrom &lt;-<span class="st"> </span>bar <span class="op">-</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>xsd;</a>
<a class="sourceLine" id="cb27-38" title="38">cto &lt;-<span class="st"> </span>bar <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>xsd;</a>
<a class="sourceLine" id="cb27-39" title="39"><span class="kw">curve</span>(ddn, <span class="dt">from =</span> cfrom , <span class="dt">to =</span> cto, <span class="dt">add =</span> <span class="ot">FALSE</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb27-40" title="40">      <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;Mean:&quot;</span>, bar,  <span class="st">&quot;and SD:&quot;</span>, xsd),</a>
<a class="sourceLine" id="cb27-41" title="41">      <span class="dt">ylab =</span> <span class="st">&quot;Density&quot;</span>,</a>
<a class="sourceLine" id="cb27-42" title="42">      <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>); <span class="kw">grid</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>);</a>
<a class="sourceLine" id="cb27-43" title="43">ppn &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb27-44" title="44">  <span class="kw">return</span>(<span class="kw">pnorm</span>(x, <span class="dt">mean =</span> bar, <span class="dt">sd =</span> xsd, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb27-45" title="45">}</a>
<a class="sourceLine" id="cb27-46" title="46">ppnlt &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb27-47" title="47">  <span class="kw">return</span>(<span class="kw">pnorm</span>(x, <span class="dt">mean =</span> bar, <span class="dt">sd =</span> xsd, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb27-48" title="48">}</a>
<a class="sourceLine" id="cb27-49" title="49"><span class="kw">curve</span>(ppn, <span class="dt">from =</span> cfrom , <span class="dt">to =</span> cto, <span class="dt">add =</span> <span class="ot">FALSE</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb27-50" title="50">      <span class="dt">col =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Probability&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>)</a>
<a class="sourceLine" id="cb27-51" title="51"><span class="kw">curve</span>(ppnlt, <span class="dt">from =</span> cfrom , <span class="dt">to =</span> cto, <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb27-52" title="52">      <span class="dt">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</a>
<a class="sourceLine" id="cb27-53" title="53"><span class="kw">grid</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>)</a>
<a class="sourceLine" id="cb27-54" title="54"><span class="kw">legend</span>(cfrom, <span class="fl">0.9</span>, <span class="st">&quot;lower.tail FALSE&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;darkred&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb27-55" title="55"><span class="kw">legend</span>(cfrom, <span class="fl">0.8</span>, <span class="st">&quot;P(X &gt; x)&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb27-56" title="56"><span class="kw">legend</span>(cto, <span class="fl">0.9</span>, <span class="st">&quot;lower.tail TRUE&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;darkgreen&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xjust =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb27-57" title="57"><span class="kw">legend</span>(cto, <span class="fl">0.8</span>, <span class="st">&quot;P(X &lt;= x)&quot;</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xjust =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb27-58" title="58"></a>
<a class="sourceLine" id="cb27-59" title="59"><span class="co">###### End ignore ######</span></a>
<a class="sourceLine" id="cb27-60" title="60"></a>
<a class="sourceLine" id="cb27-61" title="61"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb27-62" title="62"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb27-63" title="63"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb27-64" title="64"></a>
<a class="sourceLine" id="cb27-65" title="65"><span class="co"># 1. Generate 2000 normally distributed random numbers</span></a>
<a class="sourceLine" id="cb27-66" title="66"><span class="co"># from a population where the mean is 18 and standard</span></a>
<a class="sourceLine" id="cb27-67" title="67"><span class="co"># deviation is 3 and keep them in a vector named x.</span></a>
<a class="sourceLine" id="cb27-68" title="68"></a>
<a class="sourceLine" id="cb27-69" title="69"><span class="co"># 2. Confirm that x has 2000 elements without listing</span></a>
<a class="sourceLine" id="cb27-70" title="70"><span class="co"># them all.</span></a>
<a class="sourceLine" id="cb27-71" title="71"></a>
<a class="sourceLine" id="cb27-72" title="72"><span class="co"># 3. Find the minimum, maximum, mean and median of x.</span></a>
<a class="sourceLine" id="cb27-73" title="73"></a>
<a class="sourceLine" id="cb27-74" title="74"><span class="co"># 4. The function for standard deviation is sd. Use this</span></a>
<a class="sourceLine" id="cb27-75" title="75"><span class="co"># function to find the standard deviation of x. Should</span></a>
<a class="sourceLine" id="cb27-76" title="76"><span class="co"># be approximately 3.</span></a>
<a class="sourceLine" id="cb27-77" title="77"></a>
<a class="sourceLine" id="cb27-78" title="78"><span class="co"># 5. The function for square root is sqrt. Standard</span></a>
<a class="sourceLine" id="cb27-79" title="79"><span class="co"># error of the mean (SEM) is calculated as the SD</span></a>
<a class="sourceLine" id="cb27-80" title="80"><span class="co"># divided by the square root of the sample size. Without</span></a>
<a class="sourceLine" id="cb27-81" title="81"><span class="co"># using any object other than x, find the SEM. Should</span></a>
<a class="sourceLine" id="cb27-82" title="82"><span class="co"># be approximately 0.06.</span></a></code></pre></div>
<!-- >>> -->
<!-- <<< logicals.r -->
<h1 id="truth-in-r">Truth in R</h1>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"></a>
<a class="sourceLine" id="cb28-2" title="2"><span class="co">##################</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="co">### Truth in R </span><span class="al">###</span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="co">##################</span></a>
<a class="sourceLine" id="cb28-5" title="5"></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb28-7" title="7"></a>
<a class="sourceLine" id="cb28-8" title="8">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>);</a>
<a class="sourceLine" id="cb28-9" title="9">x;</a>
<a class="sourceLine" id="cb28-10" title="10"></a>
<a class="sourceLine" id="cb28-11" title="11">x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">5</span>;</a>
<a class="sourceLine" id="cb28-12" title="12">x <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>;</a>
<a class="sourceLine" id="cb28-13" title="13"></a>
<a class="sourceLine" id="cb28-14" title="14">g &lt;-<span class="st"> </span>x <span class="op">&lt;=</span><span class="st"> </span><span class="dv">5</span>;</a>
<a class="sourceLine" id="cb28-15" title="15">g</a>
<a class="sourceLine" id="cb28-16" title="16"></a>
<a class="sourceLine" id="cb28-17" title="17"><span class="co"># There is a data type called &quot;logical&quot;.</span></a>
<a class="sourceLine" id="cb28-18" title="18"></a>
<a class="sourceLine" id="cb28-19" title="19"><span class="kw">typeof</span>(g);</a>
<a class="sourceLine" id="cb28-20" title="20"></a>
<a class="sourceLine" id="cb28-21" title="21">x[g];</a>
<a class="sourceLine" id="cb28-22" title="22"></a>
<a class="sourceLine" id="cb28-23" title="23"><span class="co">#############################################################</span></a>
<a class="sourceLine" id="cb28-24" title="24"></a>
<a class="sourceLine" id="cb28-25" title="25"><span class="co">### any() and all() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb28-26" title="26"></a>
<a class="sourceLine" id="cb28-27" title="27"></a>
<a class="sourceLine" id="cb28-28" title="28"><span class="kw">any</span>(g);</a>
<a class="sourceLine" id="cb28-29" title="29"><span class="kw">all</span>(g);</a>
<a class="sourceLine" id="cb28-30" title="30"></a>
<a class="sourceLine" id="cb28-31" title="31">fl &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">-6</span>));</a>
<a class="sourceLine" id="cb28-32" title="32"><span class="kw">any</span>(fl);</a>
<a class="sourceLine" id="cb28-33" title="33"><span class="kw">all</span>(fl);</a>
<a class="sourceLine" id="cb28-34" title="34"></a>
<a class="sourceLine" id="cb28-35" title="35">fl &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">0</span>));</a>
<a class="sourceLine" id="cb28-36" title="36"><span class="kw">any</span>(fl);</a>
<a class="sourceLine" id="cb28-37" title="37"><span class="kw">all</span>(fl);</a>
<a class="sourceLine" id="cb28-38" title="38"></a>
<a class="sourceLine" id="cb28-39" title="39">fl &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>));</a>
<a class="sourceLine" id="cb28-40" title="40"><span class="kw">any</span>(fl);</a>
<a class="sourceLine" id="cb28-41" title="41"><span class="kw">all</span>(fl);</a>
<a class="sourceLine" id="cb28-42" title="42"></a>
<a class="sourceLine" id="cb28-43" title="43"><span class="co">### Strings cannot be used as logicals.</span></a>
<a class="sourceLine" id="cb28-44" title="44"></a>
<a class="sourceLine" id="cb28-45" title="45">s &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;str1&quot;</span>, <span class="st">&quot;&quot;</span>, <span class="st">&quot;str3&quot;</span>);</a>
<a class="sourceLine" id="cb28-46" title="46"></a>
<a class="sourceLine" id="cb28-47" title="47"><span class="kw">as.logical</span>(s);         <span class="co"># NA</span></a>
<a class="sourceLine" id="cb28-48" title="48"></a>
<a class="sourceLine" id="cb28-49" title="49"><span class="co">####################################</span></a>
<a class="sourceLine" id="cb28-50" title="50"><span class="co">### Testing for numeric equality </span><span class="al">###</span></a>
<a class="sourceLine" id="cb28-51" title="51"><span class="co">####################################</span></a>
<a class="sourceLine" id="cb28-52" title="52"></a>
<a class="sourceLine" id="cb28-53" title="53">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">0.25</span>);</a>
<a class="sourceLine" id="cb28-54" title="54">y &lt;-<span class="st"> </span>x;</a>
<a class="sourceLine" id="cb28-55" title="55"></a>
<a class="sourceLine" id="cb28-56" title="56">x <span class="op">==</span><span class="st"> </span>y;</a>
<a class="sourceLine" id="cb28-57" title="57"><span class="kw">identical</span>(x,y);</a>
<a class="sourceLine" id="cb28-58" title="58"><span class="kw">all.equal</span>(x,y);</a>
<a class="sourceLine" id="cb28-59" title="59"></a>
<a class="sourceLine" id="cb28-60" title="60"></a>
<a class="sourceLine" id="cb28-61" title="61"><span class="co"># Divide x by 39.473 then multiply the result by 39.473</span></a>
<a class="sourceLine" id="cb28-62" title="62">z &lt;-<span class="st"> </span>x <span class="op">/</span><span class="st"> </span><span class="fl">39.473</span></a>
<a class="sourceLine" id="cb28-63" title="63">x &lt;-<span class="st"> </span>z <span class="op">*</span><span class="st"> </span><span class="fl">39.473</span></a>
<a class="sourceLine" id="cb28-64" title="64"></a>
<a class="sourceLine" id="cb28-65" title="65"><span class="co">### identical() and all.equal()</span></a>
<a class="sourceLine" id="cb28-66" title="66">x <span class="op">==</span><span class="st"> </span>y;</a>
<a class="sourceLine" id="cb28-67" title="67"><span class="kw">identical</span>(x,y);</a>
<a class="sourceLine" id="cb28-68" title="68"><span class="kw">all.equal</span>(x,y);</a>
<a class="sourceLine" id="cb28-69" title="69"></a>
<a class="sourceLine" id="cb28-70" title="70"><span class="co"># all.equal() never returns FALSE. It either returns TRUE or a string.</span></a>
<a class="sourceLine" id="cb28-71" title="71"></a>
<a class="sourceLine" id="cb28-72" title="72">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="fl">0.0001</span>);</a>
<a class="sourceLine" id="cb28-73" title="73">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="fl">5.0001</span>, <span class="dt">sd =</span> <span class="fl">0.0001</span>);</a>
<a class="sourceLine" id="cb28-74" title="74"></a>
<a class="sourceLine" id="cb28-75" title="75"><span class="co"># Below returns a string or TRUE</span></a>
<a class="sourceLine" id="cb28-76" title="76"><span class="kw">all.equal</span>(x,y);</a>
<a class="sourceLine" id="cb28-77" title="77"><span class="kw">all.equal</span>(x,y, <span class="dt">tolerance =</span> <span class="fl">1e-4</span>);</a>
<a class="sourceLine" id="cb28-78" title="78"></a>
<a class="sourceLine" id="cb28-79" title="79"></a>
<a class="sourceLine" id="cb28-80" title="80"><span class="co"># Below return FALSE or TRUE</span></a>
<a class="sourceLine" id="cb28-81" title="81"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(x,y));</a>
<a class="sourceLine" id="cb28-82" title="82"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(x,y, <span class="dt">tolerance =</span> <span class="fl">1e-4</span>))</a>
<a class="sourceLine" id="cb28-83" title="83"></a>
<a class="sourceLine" id="cb28-84" title="84"></a>
<a class="sourceLine" id="cb28-85" title="85"><span class="co"># It might be best to decide how much difference you are</span></a>
<a class="sourceLine" id="cb28-86" title="86"><span class="co"># willing to ignore and then do something like below.</span></a>
<a class="sourceLine" id="cb28-87" title="87"></a>
<a class="sourceLine" id="cb28-88" title="88"><span class="kw">any</span>(<span class="kw">abs</span>(x<span class="op">-</span>y) <span class="op">&gt;</span><span class="st"> </span><span class="fl">1e-3</span>)</a>
<a class="sourceLine" id="cb28-89" title="89"><span class="kw">any</span>(<span class="kw">abs</span>(x<span class="op">-</span>y) <span class="op">&gt;</span><span class="st"> </span><span class="fl">1e-4</span>)</a>
<a class="sourceLine" id="cb28-90" title="90">x</a>
<a class="sourceLine" id="cb28-91" title="91">y</a>
<a class="sourceLine" id="cb28-92" title="92"><span class="kw">abs</span>(x <span class="op">-</span><span class="st"> </span>y)</a>
<a class="sourceLine" id="cb28-93" title="93"></a>
<a class="sourceLine" id="cb28-94" title="94"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb28-95" title="95"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb28-96" title="96"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb28-97" title="97"></a>
<a class="sourceLine" id="cb28-98" title="98"><span class="co"># 1. Store the value of 0.5 - 0.3 into m</span></a>
<a class="sourceLine" id="cb28-99" title="99"></a>
<a class="sourceLine" id="cb28-100" title="100"><span class="co"># 2. Store the value of 0.3 - 0.1 into n</span></a>
<a class="sourceLine" id="cb28-101" title="101"></a>
<a class="sourceLine" id="cb28-102" title="102"><span class="co"># 3. Use == to test the equality of m and n.</span></a>
<a class="sourceLine" id="cb28-103" title="103"></a>
<a class="sourceLine" id="cb28-104" title="104"><span class="co"># 4. Use identical() to test the equality of m and n.</span></a>
<a class="sourceLine" id="cb28-105" title="105"></a>
<a class="sourceLine" id="cb28-106" title="106"><span class="co"># 5. Use all.equal() to test the equality of m and n.</span></a>
<a class="sourceLine" id="cb28-107" title="107"></a>
<a class="sourceLine" id="cb28-108" title="108"><span class="co"># 6. What is the output of isTRUE(all.equal(m,n))?</span></a>
<a class="sourceLine" id="cb28-109" title="109"></a>
<a class="sourceLine" id="cb28-110" title="110"><span class="co"># 7. What is the magnitude of the difference between</span></a>
<a class="sourceLine" id="cb28-111" title="111"><span class="co"># m and n?</span></a>
<a class="sourceLine" id="cb28-112" title="112"></a>
<a class="sourceLine" id="cb28-113" title="113"><span class="co"># Refer to the documentation of all.equal() to find out</span></a>
<a class="sourceLine" id="cb28-114" title="114"><span class="co"># the default value of the tolerance argument.</span></a>
<a class="sourceLine" id="cb28-115" title="115"></a>
<a class="sourceLine" id="cb28-116" title="116"><span class="co">#############################################################</span></a>
<a class="sourceLine" id="cb28-117" title="117"><span class="co">#############################################################</span></a>
<a class="sourceLine" id="cb28-118" title="118"></a>
<a class="sourceLine" id="cb28-119" title="119"><span class="co"># Use isTRUE(all.equal()), not ==, when comparing floating</span></a>
<a class="sourceLine" id="cb28-120" title="120"><span class="co"># point numbers.</span></a>
<a class="sourceLine" id="cb28-121" title="121"></a>
<a class="sourceLine" id="cb28-122" title="122"><span class="co"># mean(abs(x-y))/mean(abs(x))</span></a>
<a class="sourceLine" id="cb28-123" title="123"></a></code></pre></div>
<!-- >>> -->
<!-- <<< subsetting.r -->
<h1 id="subsetting">Subsetting</h1>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="co">### Subsetting data frames </span><span class="al">###</span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb29-5" title="5"></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="co">### Subscripts are used to get subsets of data frames</span></a>
<a class="sourceLine" id="cb29-7" title="7"><span class="co">#   (and other types of objects) in R.</span></a>
<a class="sourceLine" id="cb29-8" title="8"></a>
<a class="sourceLine" id="cb29-9" title="9"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb29-10" title="10"></a>
<a class="sourceLine" id="cb29-11" title="11">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">runif</span>(<span class="dv">26</span>, <span class="dt">min =</span> <span class="dv">3</span>, <span class="dt">max =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb29-12" title="12">                 <span class="dt">y =</span> <span class="kw">runif</span>(<span class="dv">26</span>, <span class="dt">min =</span> <span class="dv">30</span>, <span class="dt">max =</span> <span class="dv">120</span>));</a>
<a class="sourceLine" id="cb29-13" title="13"><span class="kw">rownames</span>(df) &lt;-<span class="st"> </span>LETTERS;</a>
<a class="sourceLine" id="cb29-14" title="14"><span class="kw">head</span>(df);</a>
<a class="sourceLine" id="cb29-15" title="15"></a>
<a class="sourceLine" id="cb29-16" title="16"><span class="co"># dataframe[rownum, colnum]</span></a>
<a class="sourceLine" id="cb29-17" title="17"></a>
<a class="sourceLine" id="cb29-18" title="18">df[<span class="dv">3</span>, <span class="dv">2</span>]</a>
<a class="sourceLine" id="cb29-19" title="19"></a>
<a class="sourceLine" id="cb29-20" title="20"><span class="co"># dataframe[&quot;rowname&quot;, &quot;colname&quot;]</span></a>
<a class="sourceLine" id="cb29-21" title="21"></a>
<a class="sourceLine" id="cb29-22" title="22">df[<span class="st">&quot;C&quot;</span>, <span class="st">&quot;y&quot;</span>]</a>
<a class="sourceLine" id="cb29-23" title="23"></a>
<a class="sourceLine" id="cb29-24" title="24"><span class="co">### You get all columns if no columns are specified.</span></a>
<a class="sourceLine" id="cb29-25" title="25"><span class="co"># dataframe[rownum, ]</span></a>
<a class="sourceLine" id="cb29-26" title="26"><span class="co"># dataframe[&quot;rowname&quot;, ]</span></a>
<a class="sourceLine" id="cb29-27" title="27"></a>
<a class="sourceLine" id="cb29-28" title="28">df[<span class="dv">5</span>,]</a>
<a class="sourceLine" id="cb29-29" title="29">df[<span class="st">&quot;E&quot;</span>,]</a>
<a class="sourceLine" id="cb29-30" title="30"></a>
<a class="sourceLine" id="cb29-31" title="31"><span class="co">### You get all rows if no rows are specified.</span></a>
<a class="sourceLine" id="cb29-32" title="32"><span class="co"># dataframe[, colnum]</span></a>
<a class="sourceLine" id="cb29-33" title="33"><span class="co"># dataframe[, &quot;colname&quot;]</span></a>
<a class="sourceLine" id="cb29-34" title="34"></a>
<a class="sourceLine" id="cb29-35" title="35">df[, <span class="st">&quot;x&quot;</span>]</a>
<a class="sourceLine" id="cb29-36" title="36">df[, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb29-37" title="37"></a>
<a class="sourceLine" id="cb29-38" title="38"><span class="co">### Rows and columns may be specified as vectors.</span></a>
<a class="sourceLine" id="cb29-39" title="39"></a>
<a class="sourceLine" id="cb29-40" title="40">rows &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">17</span>,<span class="dv">24</span>);</a>
<a class="sourceLine" id="cb29-41" title="41">coln &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>);</a>
<a class="sourceLine" id="cb29-42" title="42">df[rows, coln];</a>
<a class="sourceLine" id="cb29-43" title="43"></a>
<a class="sourceLine" id="cb29-44" title="44">colhead &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>);</a>
<a class="sourceLine" id="cb29-45" title="45">df[rows, colhead];</a>
<a class="sourceLine" id="cb29-46" title="46"></a>
<a class="sourceLine" id="cb29-47" title="47"><span class="co">### The dollar notation can only be used with single column names.</span></a>
<a class="sourceLine" id="cb29-48" title="48"><span class="co">#   This is actually very common.</span></a>
<a class="sourceLine" id="cb29-49" title="49"><span class="co"># dataframe$colname</span></a>
<a class="sourceLine" id="cb29-50" title="50"></a>
<a class="sourceLine" id="cb29-51" title="51">df<span class="op">$</span>x </a>
<a class="sourceLine" id="cb29-52" title="52"></a>
<a class="sourceLine" id="cb29-53" title="53"></a>
<a class="sourceLine" id="cb29-54" title="54"><span class="co">### If you ask for multiple columns you always get a data frame in return.</span></a>
<a class="sourceLine" id="cb29-55" title="55"><span class="co">#   Even if you have asked for a single row.</span></a>
<a class="sourceLine" id="cb29-56" title="56"></a>
<a class="sourceLine" id="cb29-57" title="57">df[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)]</a>
<a class="sourceLine" id="cb29-58" title="58">df[<span class="dv">2</span>, <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)]</a>
<a class="sourceLine" id="cb29-59" title="59"></a>
<a class="sourceLine" id="cb29-60" title="60"><span class="co">### Single columns are returned as vectors.</span></a>
<a class="sourceLine" id="cb29-61" title="61"></a>
<a class="sourceLine" id="cb29-62" title="62"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb29-63" title="63"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb29-64" title="64"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb29-65" title="65"></a>
<a class="sourceLine" id="cb29-66" title="66">hwf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/hw.csv&quot;</span>, <span class="dt">stringsAsFactors =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb29-67" title="67"><span class="kw">head</span>(hwf);</a>
<a class="sourceLine" id="cb29-68" title="68"><span class="kw">nrow</span>(hwf);</a>
<a class="sourceLine" id="cb29-69" title="69"></a>
<a class="sourceLine" id="cb29-70" title="70">hwt &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/hw.csv&quot;</span>);</a>
<a class="sourceLine" id="cb29-71" title="71">hwt;</a>
<a class="sourceLine" id="cb29-72" title="72"></a>
<a class="sourceLine" id="cb29-73" title="73"><span class="co"># 1. Make a vector, ronum, containing the numbers 21 to 30</span></a>
<a class="sourceLine" id="cb29-74" title="74"><span class="co"># and 51 to 60 by concatenating (remember c()?) two</span></a>
<a class="sourceLine" id="cb29-75" title="75"><span class="co"># calls to seq().</span></a>
<a class="sourceLine" id="cb29-76" title="76"></a>
<a class="sourceLine" id="cb29-77" title="77"><span class="co"># 2. Use the vector ronum, made above to get a subset data</span></a>
<a class="sourceLine" id="cb29-78" title="78"><span class="co"># frame from hwf consisting of only row numbers in ronum</span></a>
<a class="sourceLine" id="cb29-79" title="79"></a>
<a class="sourceLine" id="cb29-80" title="80"><span class="co"># 3. From hwf, extract the strain associated with the</span></a>
<a class="sourceLine" id="cb29-81" title="81"><span class="co"># hyphal width in row number 58 and store it in a vector</span></a>
<a class="sourceLine" id="cb29-82" title="82"><span class="co"># named strain58. Check the class and mode of strain58.</span></a>
<a class="sourceLine" id="cb29-83" title="83"></a>
<a class="sourceLine" id="cb29-84" title="84"></a>
<a class="sourceLine" id="cb29-85" title="85"><span class="co">### Tidyverse style </span><span class="al">###</span></a>
<a class="sourceLine" id="cb29-86" title="86"></a>
<a class="sourceLine" id="cb29-87" title="87"><span class="kw">slice</span>(hwt, ronum);</a>
<a class="sourceLine" id="cb29-88" title="88"></a>
<a class="sourceLine" id="cb29-89" title="89"><span class="co"># hwt[ronum,] # also works.</span></a>
<a class="sourceLine" id="cb29-90" title="90"></a>
<a class="sourceLine" id="cb29-91" title="91">hwt[<span class="dv">58</span>, <span class="st">&quot;strain&quot;</span>]</a></code></pre></div>
<!-- >>> -->
<!-- <<< nainf.r -->
<h1 id="na-nan-inf-null">NA, NaN, Inf, NULL</h1>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="co">##########################</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="co">### NA, NaN, Inf, NULL </span><span class="al">###</span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="co">##########################</span></a>
<a class="sourceLine" id="cb30-5" title="5"></a>
<a class="sourceLine" id="cb30-6" title="6"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb30-7" title="7"></a>
<a class="sourceLine" id="cb30-8" title="8">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">2</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>);</a>
<a class="sourceLine" id="cb30-9" title="9">x &lt;-<span class="st"> </span><span class="kw">c</span>(x, <span class="ot">NA</span>);</a>
<a class="sourceLine" id="cb30-10" title="10">x;</a>
<a class="sourceLine" id="cb30-11" title="11"><span class="kw">mean</span>(x);</a>
<a class="sourceLine" id="cb30-12" title="12"><span class="kw">sum</span>(x);</a>
<a class="sourceLine" id="cb30-13" title="13"><span class="kw">sd</span>(x);</a>
<a class="sourceLine" id="cb30-14" title="14"></a>
<a class="sourceLine" id="cb30-15" title="15"><span class="co">####################################################</span></a>
<a class="sourceLine" id="cb30-16" title="16"></a>
<a class="sourceLine" id="cb30-17" title="17">books &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Animal Liberation&quot;</span>, <span class="st">&quot;A Theory of Justice&quot;</span>,</a>
<a class="sourceLine" id="cb30-18" title="18">           <span class="st">&quot;The Wealth of Nations&quot;</span>, <span class="st">&quot;What Money Can&#39;t Buy&quot;</span>);</a>
<a class="sourceLine" id="cb30-19" title="19"></a>
<a class="sourceLine" id="cb30-20" title="20">authors &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Peter Singer&quot;</span>, <span class="st">&quot;John Rawls&quot;</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb30-21" title="21">             <span class="st">&quot;Michael Sandel&quot;</span>);</a>
<a class="sourceLine" id="cb30-22" title="22"></a>
<a class="sourceLine" id="cb30-23" title="23">sold &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.2</span>, <span class="ot">NA</span>, <span class="fl">0.7</span>);</a>
<a class="sourceLine" id="cb30-24" title="24"></a>
<a class="sourceLine" id="cb30-25" title="25">ba &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">books =</span> books, <span class="dt">authors =</span> authors, <span class="dt">sold =</span> sold);</a>
<a class="sourceLine" id="cb30-26" title="26"></a>
<a class="sourceLine" id="cb30-27" title="27">ba</a>
<a class="sourceLine" id="cb30-28" title="28"></a>
<a class="sourceLine" id="cb30-29" title="29"><span class="co"># What is the type of NA?</span></a>
<a class="sourceLine" id="cb30-30" title="30"></a>
<a class="sourceLine" id="cb30-31" title="31"></a>
<a class="sourceLine" id="cb30-32" title="32"></a>
<a class="sourceLine" id="cb30-33" title="33"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb30-34" title="34"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb30-35" title="35"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb30-36" title="36"></a>
<a class="sourceLine" id="cb30-37" title="37"><span class="co"># 1. Call the mean(), sum() and sd() functions as above</span></a>
<a class="sourceLine" id="cb30-38" title="38"><span class="co"># but with the additional named argument &quot;na.rm = TRUE&quot;</span></a>
<a class="sourceLine" id="cb30-39" title="39"><span class="co"># e.g. sum(x, na.rm = TRUE)</span></a>
<a class="sourceLine" id="cb30-40" title="40"></a>
<a class="sourceLine" id="cb30-41" title="41"><span class="co"># 2. Examine the output of summary(x).</span></a>
<a class="sourceLine" id="cb30-42" title="42"></a>
<a class="sourceLine" id="cb30-43" title="43"><span class="co"># 3. Examine the output of is.na(x).</span></a>
<a class="sourceLine" id="cb30-44" title="44"></a>
<a class="sourceLine" id="cb30-45" title="45"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb30-46" title="46"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb30-47" title="47"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb30-48" title="48"></a>
<a class="sourceLine" id="cb30-49" title="49"><span class="co"># Examine the output of the following</span></a>
<a class="sourceLine" id="cb30-50" title="50"></a>
<a class="sourceLine" id="cb30-51" title="51"><span class="kw">na.omit</span>(ba)</a>
<a class="sourceLine" id="cb30-52" title="52"></a>
<a class="sourceLine" id="cb30-53" title="53"><span class="kw">na.pass</span>(ba)</a>
<a class="sourceLine" id="cb30-54" title="54"></a>
<a class="sourceLine" id="cb30-55" title="55"><span class="kw">na.fail</span>(ba);</a>
<a class="sourceLine" id="cb30-56" title="56"></a>
<a class="sourceLine" id="cb30-57" title="57"></a>
<a class="sourceLine" id="cb30-58" title="58"><span class="co">###### End of Day 1 ######</span></a>
<a class="sourceLine" id="cb30-59" title="59"></a>
<a class="sourceLine" id="cb30-60" title="60"></a>
<a class="sourceLine" id="cb30-61" title="61"><span class="co">### Inf and -Inf are reserved words in R.</span></a>
<a class="sourceLine" id="cb30-62" title="62"></a>
<a class="sourceLine" id="cb30-63" title="63"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb30-64" title="64"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb30-65" title="65"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb30-66" title="66"></a>
<a class="sourceLine" id="cb30-67" title="67"><span class="co"># 1. Examine the output of 2/0</span></a>
<a class="sourceLine" id="cb30-68" title="68"></a>
<a class="sourceLine" id="cb30-69" title="69"><span class="co"># 2. Examine the output of -2/0</span></a>
<a class="sourceLine" id="cb30-70" title="70"></a>
<a class="sourceLine" id="cb30-71" title="71"><span class="co"># 3. Examine the output of is.finite(2/0)</span></a>
<a class="sourceLine" id="cb30-72" title="72"></a>
<a class="sourceLine" id="cb30-73" title="73"><span class="co"># 4. Examine the output of is.finite(0/2)</span></a>
<a class="sourceLine" id="cb30-74" title="74"></a>
<a class="sourceLine" id="cb30-75" title="75"><span class="co"># 5. Store the output of 2/0 in i.</span></a>
<a class="sourceLine" id="cb30-76" title="76"></a>
<a class="sourceLine" id="cb30-77" title="77"><span class="co"># 6. Test that i is infinite.</span></a>
<a class="sourceLine" id="cb30-78" title="78"></a>
<a class="sourceLine" id="cb30-79" title="79"></a>
<a class="sourceLine" id="cb30-80" title="80"><span class="co">### NaN (Not a Number) is a reserved word in R.</span></a>
<a class="sourceLine" id="cb30-81" title="81"></a>
<a class="sourceLine" id="cb30-82" title="82"><span class="dv">0</span><span class="op">/</span><span class="dv">0</span></a>
<a class="sourceLine" id="cb30-83" title="83">x &lt;-<span class="st"> </span><span class="kw">log2</span>(<span class="op">-</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb30-84" title="84">x</a>
<a class="sourceLine" id="cb30-85" title="85"></a>
<a class="sourceLine" id="cb30-86" title="86"><span class="co"># 2. Examine the output of is.nan(x).</span></a>
<a class="sourceLine" id="cb30-87" title="87"></a>
<a class="sourceLine" id="cb30-88" title="88"><span class="co"># 3. Examine the output of is.na(x).</span></a>
<a class="sourceLine" id="cb30-89" title="89"></a>
<a class="sourceLine" id="cb30-90" title="90"><span class="co">### NULL</span></a>
<a class="sourceLine" id="cb30-91" title="91"></a>
<a class="sourceLine" id="cb30-92" title="92"><span class="co"># Complete absence of any value or object.</span></a>
<a class="sourceLine" id="cb30-93" title="93"></a>
<a class="sourceLine" id="cb30-94" title="94"><span class="co"># It is a type in itself.</span></a>
<a class="sourceLine" id="cb30-95" title="95"></a>
<a class="sourceLine" id="cb30-96" title="96"><span class="co">######################################################</span></a>
<a class="sourceLine" id="cb30-97" title="97"><span class="co">### Think about the output of the following blocks </span><span class="al">###</span></a>
<a class="sourceLine" id="cb30-98" title="98"><span class="co">######################################################</span></a>
<a class="sourceLine" id="cb30-99" title="99"></a>
<a class="sourceLine" id="cb30-100" title="100"><span class="kw">is.null</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb30-101" title="101"></a>
<a class="sourceLine" id="cb30-102" title="102">retval &lt;-<span class="st"> </span><span class="kw">cat</span>(<span class="st">&quot;Just some text</span><span class="ch">\n</span><span class="st">&quot;</span>);</a>
<a class="sourceLine" id="cb30-103" title="103">retval</a>
<a class="sourceLine" id="cb30-104" title="104"></a>
<a class="sourceLine" id="cb30-105" title="105"><span class="kw">is.null</span>(<span class="dv">0</span><span class="op">/</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb30-106" title="106"></a>
<a class="sourceLine" id="cb30-107" title="107"><span class="kw">is.null</span>(authors[<span class="dv">3</span>]);</a>
<a class="sourceLine" id="cb30-108" title="108"></a></code></pre></div>
<!-- >>> -->
<!-- <<< matrices.r -->
<h1 id="matrices">Matrices</h1>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co">################</span></a>
<a class="sourceLine" id="cb31-3" title="3"><span class="co">### Matrices </span><span class="al">###</span></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="co">################</span></a>
<a class="sourceLine" id="cb31-5" title="5"></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="co"># Like data frames, these are two dimensional tables with rows and</span></a>
<a class="sourceLine" id="cb31-7" title="7"><span class="co"># columns.</span></a>
<a class="sourceLine" id="cb31-8" title="8"></a>
<a class="sourceLine" id="cb31-9" title="9"><span class="co"># All elements in a matrix have to be of the same type.</span></a>
<a class="sourceLine" id="cb31-10" title="10"></a>
<a class="sourceLine" id="cb31-11" title="11"><span class="co">### Making a matrix by using matrix().</span></a>
<a class="sourceLine" id="cb31-12" title="12"></a>
<a class="sourceLine" id="cb31-13" title="13"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb31-14" title="14"></a>
<a class="sourceLine" id="cb31-15" title="15">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">50</span>);</a>
<a class="sourceLine" id="cb31-16" title="16">x;</a>
<a class="sourceLine" id="cb31-17" title="17"></a>
<a class="sourceLine" id="cb31-18" title="18">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(x, <span class="dt">nrow =</span> <span class="dv">5</span>, <span class="dt">ncol =</span> <span class="dv">10</span>);</a>
<a class="sourceLine" id="cb31-19" title="19"></a>
<a class="sourceLine" id="cb31-20" title="20"><span class="kw">rownames</span>(m) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;R&quot;</span>, <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>);</a>
<a class="sourceLine" id="cb31-21" title="21"><span class="kw">colnames</span>(m) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;C&quot;</span>, <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>);</a>
<a class="sourceLine" id="cb31-22" title="22"></a>
<a class="sourceLine" id="cb31-23" title="23"><span class="kw">rownames</span>(m);</a>
<a class="sourceLine" id="cb31-24" title="24"><span class="kw">colnames</span>(m);</a>
<a class="sourceLine" id="cb31-25" title="25"></a>
<a class="sourceLine" id="cb31-26" title="26"></a>
<a class="sourceLine" id="cb31-27" title="27"><span class="co">### Making a matrix by adding the dim attribute to a vector.</span></a>
<a class="sourceLine" id="cb31-28" title="28"></a>
<a class="sourceLine" id="cb31-29" title="29">m &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">51</span>,<span class="dv">100</span>);</a>
<a class="sourceLine" id="cb31-30" title="30"><span class="kw">dim</span>(m) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>);</a>
<a class="sourceLine" id="cb31-31" title="31">m;</a>
<a class="sourceLine" id="cb31-32" title="32"></a>
<a class="sourceLine" id="cb31-33" title="33"><span class="kw">attributes</span>(m);</a>
<a class="sourceLine" id="cb31-34" title="34"><span class="kw">class</span>(m);</a>
<a class="sourceLine" id="cb31-35" title="35"></a>
<a class="sourceLine" id="cb31-36" title="36">rn &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;R&quot;</span>, <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>);</a>
<a class="sourceLine" id="cb31-37" title="37">cn &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;C&quot;</span>, <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>);</a>
<a class="sourceLine" id="cb31-38" title="38"><span class="kw">dimnames</span>(m) &lt;-<span class="st"> </span><span class="kw">list</span>(rn, cn);</a>
<a class="sourceLine" id="cb31-39" title="39"></a>
<a class="sourceLine" id="cb31-40" title="40"><span class="kw">attributes</span>(m);</a>
<a class="sourceLine" id="cb31-41" title="41"><span class="kw">str</span>(m);</a>
<a class="sourceLine" id="cb31-42" title="42"></a>
<a class="sourceLine" id="cb31-43" title="43"><span class="co">###########################</span></a>
<a class="sourceLine" id="cb31-44" title="44"><span class="co">### Subsetting Matrices </span><span class="al">###</span></a>
<a class="sourceLine" id="cb31-45" title="45"><span class="co">###########################</span></a>
<a class="sourceLine" id="cb31-46" title="46"></a>
<a class="sourceLine" id="cb31-47" title="47"><span class="co"># matrix[rownum, colnum]</span></a>
<a class="sourceLine" id="cb31-48" title="48"></a>
<a class="sourceLine" id="cb31-49" title="49"><span class="co"># If you do not specify any rows to get, you get all rows.</span></a>
<a class="sourceLine" id="cb31-50" title="50"></a>
<a class="sourceLine" id="cb31-51" title="51"><span class="co"># If you do not specify any columns to get, you get all columns.</span></a>
<a class="sourceLine" id="cb31-52" title="52"></a>
<a class="sourceLine" id="cb31-53" title="53"><span class="co"># Just like subsetting data frames, except that if you ask for a single</span></a>
<a class="sourceLine" id="cb31-54" title="54"><span class="co"># row you get a vector.</span></a>
<a class="sourceLine" id="cb31-55" title="55"></a>
<a class="sourceLine" id="cb31-56" title="56">m[<span class="dv">1</span>,<span class="dv">2</span>];</a>
<a class="sourceLine" id="cb31-57" title="57"></a>
<a class="sourceLine" id="cb31-58" title="58">m[<span class="st">&quot;R1&quot;</span>, <span class="st">&quot;C2&quot;</span>];</a>
<a class="sourceLine" id="cb31-59" title="59"></a>
<a class="sourceLine" id="cb31-60" title="60">row3 &lt;-<span class="st"> </span>m[<span class="dv">3</span>,]; row3;</a>
<a class="sourceLine" id="cb31-61" title="61"></a>
<a class="sourceLine" id="cb31-62" title="62"><span class="kw">class</span>(row3);</a>
<a class="sourceLine" id="cb31-63" title="63"></a>
<a class="sourceLine" id="cb31-64" title="64">col1 &lt;-<span class="st"> </span>m[, <span class="dv">1</span>]; col1;</a>
<a class="sourceLine" id="cb31-65" title="65"></a>
<a class="sourceLine" id="cb31-66" title="66"><span class="kw">class</span>(col1);</a>
<a class="sourceLine" id="cb31-67" title="67"></a>
<a class="sourceLine" id="cb31-68" title="68"><span class="co">### Using more than one rows and columns for subsetting a matrix</span></a>
<a class="sourceLine" id="cb31-69" title="69"></a>
<a class="sourceLine" id="cb31-70" title="70"><span class="co"># To extract any arbitrary part of your matrix as a matrix you</span></a>
<a class="sourceLine" id="cb31-71" title="71"><span class="co"># may use vectors of rownums and colnums as below.</span></a>
<a class="sourceLine" id="cb31-72" title="72"></a>
<a class="sourceLine" id="cb31-73" title="73">m[<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>), <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>)];</a>
<a class="sourceLine" id="cb31-74" title="74"></a>
<a class="sourceLine" id="cb31-75" title="75">s &lt;-<span class="st"> </span>m[<span class="kw">c</span>(<span class="st">&quot;R2&quot;</span>,<span class="st">&quot;R3&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;C2&quot;</span>, <span class="st">&quot;C4&quot;</span>)];</a>
<a class="sourceLine" id="cb31-76" title="76"></a>
<a class="sourceLine" id="cb31-77" title="77">s;</a>
<a class="sourceLine" id="cb31-78" title="78"></a>
<a class="sourceLine" id="cb31-79" title="79"><span class="kw">class</span>(s);</a>
<a class="sourceLine" id="cb31-80" title="80"></a>
<a class="sourceLine" id="cb31-81" title="81"><span class="kw">attributes</span>(s);</a>
<a class="sourceLine" id="cb31-82" title="82"></a>
<a class="sourceLine" id="cb31-83" title="83"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb31-84" title="84"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb31-85" title="85"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb31-86" title="86"></a>
<a class="sourceLine" id="cb31-87" title="87"><span class="co"># 1. Assign the sequence 1 to 28 to a vector named d.</span></a>
<a class="sourceLine" id="cb31-88" title="88"></a>
<a class="sourceLine" id="cb31-89" title="89"><span class="co"># 2. Use matrix() to make a matrix x from d having 7 columns and</span></a>
<a class="sourceLine" id="cb31-90" title="90"><span class="co">#    4 rows such that the first row reads 1,2,3,4,5,6,7 as shown</span></a>
<a class="sourceLine" id="cb31-91" title="91"><span class="co">#    below. Refer to the help of matrix() to find out the named</span></a>
<a class="sourceLine" id="cb31-92" title="92"><span class="co">#    argument you need to use.</span></a>
<a class="sourceLine" id="cb31-93" title="93"></a>
<a class="sourceLine" id="cb31-94" title="94"><span class="co">#   1    2    3    4    5    6    7</span></a>
<a class="sourceLine" id="cb31-95" title="95"><span class="co">#   8    9   10   11   12   13   14</span></a>
<a class="sourceLine" id="cb31-96" title="96"><span class="co">#  15   16   17   18   19   20   21</span></a>
<a class="sourceLine" id="cb31-97" title="97"><span class="co">#  22   23   24   25   26   27   28</span></a>
<a class="sourceLine" id="cb31-98" title="98"></a>
<a class="sourceLine" id="cb31-99" title="99"><span class="co"># 3. Set the column names to Mon, Tue, Wed...</span></a>
<a class="sourceLine" id="cb31-100" title="100"></a>
<a class="sourceLine" id="cb31-101" title="101"><span class="co"># 4. Set the row names to Week1, Week2, Week3...</span></a>
<a class="sourceLine" id="cb31-102" title="102"></a>
<a class="sourceLine" id="cb31-103" title="103"><span class="co"># 5. Examine the matrix x.</span></a>
<a class="sourceLine" id="cb31-104" title="104"></a>
<a class="sourceLine" id="cb31-105" title="105"><span class="co">#       Mon Tue Wed Thu Fri Sat Sun</span></a>
<a class="sourceLine" id="cb31-106" title="106"><span class="co"># Week1   1   2   3   4   5   6   7</span></a>
<a class="sourceLine" id="cb31-107" title="107"><span class="co"># Week2   8   9  10  11  12  13  14</span></a>
<a class="sourceLine" id="cb31-108" title="108"><span class="co"># Week3  15  16  17  18  19  20  21</span></a>
<a class="sourceLine" id="cb31-109" title="109"><span class="co"># Week4  22  23  24  25  26  27  28</span></a>
<a class="sourceLine" id="cb31-110" title="110"></a>
<a class="sourceLine" id="cb31-111" title="111"><span class="co"># 6. Extract the date on the Friday of the third week.</span></a>
<a class="sourceLine" id="cb31-112" title="112"><span class="co"># 7. Store all the dates falling on Wednesday to wed.</span></a>
<a class="sourceLine" id="cb31-113" title="113"><span class="co"># 8. Examine wed.</span></a>
<a class="sourceLine" id="cb31-114" title="114"></a>
<a class="sourceLine" id="cb31-115" title="115"></a></code></pre></div>
<!-- >>> -->
<!-- <<< arrays.r -->
<h1 id="arrays">Arrays</h1>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"></a>
<a class="sourceLine" id="cb32-2" title="2"><span class="co">##############</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="co">### Arrays </span><span class="al">###</span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="co">##############</span></a>
<a class="sourceLine" id="cb32-5" title="5"></a>
<a class="sourceLine" id="cb32-6" title="6"><span class="co"># Like matrices but can have more than just two dimensions.</span></a>
<a class="sourceLine" id="cb32-7" title="7"><span class="co"># You can think of a 3 dimensional array as a collection</span></a>
<a class="sourceLine" id="cb32-8" title="8"><span class="co"># of matrices.</span></a>
<a class="sourceLine" id="cb32-9" title="9"><span class="co"># Function named array().</span></a>
<a class="sourceLine" id="cb32-10" title="10"></a>
<a class="sourceLine" id="cb32-11" title="11"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb32-12" title="12"></a>
<a class="sourceLine" id="cb32-13" title="13">a &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">rnorm</span>(<span class="dv">60</span>), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">10</span>),</a>
<a class="sourceLine" id="cb32-14" title="14">           <span class="dt">dimnames=</span><span class="kw">list</span> (</a>
<a class="sourceLine" id="cb32-15" title="15">             <span class="kw">paste</span>(<span class="st">&quot;R&quot;</span>, <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb32-16" title="16">             <span class="kw">paste</span>(<span class="st">&quot;C&quot;</span>, <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>),</a>
<a class="sourceLine" id="cb32-17" title="17">             <span class="kw">paste</span>(<span class="st">&quot;M&quot;</span>, <span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb32-18" title="18">           )</a>
<a class="sourceLine" id="cb32-19" title="19">);</a>
<a class="sourceLine" id="cb32-20" title="20"></a>
<a class="sourceLine" id="cb32-21" title="21"></a>
<a class="sourceLine" id="cb32-22" title="22"></a>
<a class="sourceLine" id="cb32-23" title="23"></a>
<a class="sourceLine" id="cb32-24" title="24">a[<span class="st">&quot;R1&quot;</span>,<span class="st">&quot;C2&quot;</span>,<span class="st">&quot;M5&quot;</span>];   <span class="co"># vector with one value</span></a>
<a class="sourceLine" id="cb32-25" title="25"></a>
<a class="sourceLine" id="cb32-26" title="26">a[<span class="st">&quot;R2&quot;</span>,<span class="st">&quot;C2&quot;</span>,];    <span class="co"># vector</span></a>
<a class="sourceLine" id="cb32-27" title="27"></a>
<a class="sourceLine" id="cb32-28" title="28">a[,,<span class="st">&quot;M6&quot;</span>];     <span class="co"># matrix</span></a>
<a class="sourceLine" id="cb32-29" title="29"></a>
<a class="sourceLine" id="cb32-30" title="30"></a>
<a class="sourceLine" id="cb32-31" title="31"><span class="co"># Another way to make the same array.</span></a>
<a class="sourceLine" id="cb32-32" title="32"></a>
<a class="sourceLine" id="cb32-33" title="33"><span class="kw">rm</span>(a);</a>
<a class="sourceLine" id="cb32-34" title="34">a &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">60</span>);</a>
<a class="sourceLine" id="cb32-35" title="35"><span class="kw">dim</span>(a) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>);</a>
<a class="sourceLine" id="cb32-36" title="36">a;</a>
<a class="sourceLine" id="cb32-37" title="37"></a>
<a class="sourceLine" id="cb32-38" title="38"><span class="kw">class</span>(a);</a>
<a class="sourceLine" id="cb32-39" title="39"></a>
<a class="sourceLine" id="cb32-40" title="40"><span class="kw">attributes</span>(a);</a>
<a class="sourceLine" id="cb32-41" title="41"></a>
<a class="sourceLine" id="cb32-42" title="42"><span class="kw">str</span>(a);</a>
<a class="sourceLine" id="cb32-43" title="43"></a>
<a class="sourceLine" id="cb32-44" title="44">a[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>];   <span class="co"># vector with just one value</span></a>
<a class="sourceLine" id="cb32-45" title="45">a[<span class="dv">2</span>,<span class="dv">2</span>,];    <span class="co"># vector</span></a>
<a class="sourceLine" id="cb32-46" title="46">a[,,<span class="dv">6</span>];     <span class="co"># matrix</span></a>
<a class="sourceLine" id="cb32-47" title="47"></a>
<a class="sourceLine" id="cb32-48" title="48"><span class="kw">class</span>(a[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>]);</a>
<a class="sourceLine" id="cb32-49" title="49"><span class="kw">class</span>(a[<span class="dv">2</span>,<span class="dv">2</span>,]);</a>
<a class="sourceLine" id="cb32-50" title="50"><span class="kw">class</span>(a[,,<span class="dv">6</span>]);    <span class="co"># matrix</span></a>
<a class="sourceLine" id="cb32-51" title="51"></a>
<a class="sourceLine" id="cb32-52" title="52"></a></code></pre></div>
<!-- >>> -->
<!-- <<< newcol.r -->
<h1 id="calculated-column">Calculated column</h1>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="co">################################</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="co">### Calculating a new column </span><span class="al">###</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="co">################################</span></a>
<a class="sourceLine" id="cb33-5" title="5"></a>
<a class="sourceLine" id="cb33-6" title="6"><span class="co"># The file data/expression.csv has the same contents as the</span></a>
<a class="sourceLine" id="cb33-7" title="7"><span class="co"># &quot;expression&quot; sheet of file.xlsx.</span></a>
<a class="sourceLine" id="cb33-8" title="8"></a>
<a class="sourceLine" id="cb33-9" title="9"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb33-10" title="10"></a>
<a class="sourceLine" id="cb33-11" title="11">data &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/expression.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">row.names =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-12" title="12"><span class="kw">head</span>(data)</a>
<a class="sourceLine" id="cb33-13" title="13">nf &lt;-<span class="st"> </span><span class="kw">cbind</span>(data, <span class="dt">logFC =</span> data<span class="op">$</span>treatment <span class="op">-</span><span class="st"> </span>data<span class="op">$</span>control)</a>
<a class="sourceLine" id="cb33-14" title="14"><span class="kw">head</span>(nf)</a>
<a class="sourceLine" id="cb33-15" title="15"></a>
<a class="sourceLine" id="cb33-16" title="16"></a>
<a class="sourceLine" id="cb33-17" title="17"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb33-18" title="18"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb33-19" title="19"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb33-20" title="20"></a>
<a class="sourceLine" id="cb33-21" title="21"><span class="co"># 1. Instead of getting a new data frame as above, you</span></a>
<a class="sourceLine" id="cb33-22" title="22"><span class="co"># can assign a new column to your original data frame</span></a>
<a class="sourceLine" id="cb33-23" title="23"><span class="co"># (named &quot;data&quot; in this case). This is done by assigning</span></a>
<a class="sourceLine" id="cb33-24" title="24"><span class="co"># a vector to a new column name. Delete data then read</span></a>
<a class="sourceLine" id="cb33-25" title="25"><span class="co"># the file into the data again. Now add a column named</span></a>
<a class="sourceLine" id="cb33-26" title="26"><span class="co"># logFC to data by directly assigning to data$logFC.</span></a>
<a class="sourceLine" id="cb33-27" title="27"></a>
<a class="sourceLine" id="cb33-28" title="28"></a>
<a class="sourceLine" id="cb33-29" title="29"><span class="co"># 2. Confirm that &quot;logFC&quot; column has been added to data.</span></a>
<a class="sourceLine" id="cb33-30" title="30"></a>
<a class="sourceLine" id="cb33-31" title="31"></a>
<a class="sourceLine" id="cb33-32" title="32"><span class="co"># 3. The products of all the genes in &quot;data&quot; are written</span></a>
<a class="sourceLine" id="cb33-33" title="33"><span class="co"># in the file &quot;products.csv&quot;.</span></a>
<a class="sourceLine" id="cb33-34" title="34"></a>
<a class="sourceLine" id="cb33-35" title="35"></a>
<a class="sourceLine" id="cb33-36" title="36"><span class="co"># 4. Read the file &quot;data/products.csv&quot; into a data frame</span></a>
<a class="sourceLine" id="cb33-37" title="37"><span class="co"># named temp. Use the named arguments row.names = 1,</span></a>
<a class="sourceLine" id="cb33-38" title="38"><span class="co"># stringsAsFactors = FALSE.</span></a>
<a class="sourceLine" id="cb33-39" title="39"></a>
<a class="sourceLine" id="cb33-40" title="40"></a>
<a class="sourceLine" id="cb33-41" title="41"><span class="co"># 5. Add the product column from temp to data but keep</span></a>
<a class="sourceLine" id="cb33-42" title="42"><span class="co"># in mind that the order of genes in temp is not the</span></a>
<a class="sourceLine" id="cb33-43" title="43"><span class="co"># same as in data. Hint: Use rownames(data) to subset</span></a>
<a class="sourceLine" id="cb33-44" title="44"><span class="co"># temp.</span></a>
<a class="sourceLine" id="cb33-45" title="45"></a>
<a class="sourceLine" id="cb33-46" title="46"><span class="co"># 6. After making sure that &quot;data&quot; is as resuired run the</span></a>
<a class="sourceLine" id="cb33-47" title="47"><span class="co"># following.</span></a>
<a class="sourceLine" id="cb33-48" title="48"></a>
<a class="sourceLine" id="cb33-49" title="49"><span class="kw">saveRDS</span>(data, <span class="dt">file =</span> <span class="st">&quot;data.rds&quot;</span>);</a>
<a class="sourceLine" id="cb33-50" title="50"></a>
<a class="sourceLine" id="cb33-51" title="51"><span class="co">###################</span></a>
<a class="sourceLine" id="cb33-52" title="52"><span class="co">### dplyr style </span><span class="al">###</span></a>
<a class="sourceLine" id="cb33-53" title="53"><span class="co">###################</span></a>
<a class="sourceLine" id="cb33-54" title="54"></a>
<a class="sourceLine" id="cb33-55" title="55">tib &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/expression.csv&quot;</span>, <span class="dt">col_names =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb33-56" title="56"></a>
<a class="sourceLine" id="cb33-57" title="57">tib1 &lt;-<span class="st"> </span><span class="kw">mutate</span>(tib, <span class="dt">logFC =</span> treatment <span class="op">-</span><span class="st"> </span>control);</a>
<a class="sourceLine" id="cb33-58" title="58">tib1</a>
<a class="sourceLine" id="cb33-59" title="59"></a>
<a class="sourceLine" id="cb33-60" title="60"><span class="co"># Or, we could simply overwrite tib.</span></a>
<a class="sourceLine" id="cb33-61" title="61"></a>
<a class="sourceLine" id="cb33-62" title="62">tib &lt;-<span class="st"> </span><span class="kw">mutate</span>(tib, <span class="dt">logFC =</span> treatment <span class="op">-</span><span class="st"> </span>control);</a>
<a class="sourceLine" id="cb33-63" title="63">tib</a>
<a class="sourceLine" id="cb33-64" title="64"></a>
<a class="sourceLine" id="cb33-65" title="65"><span class="co"># dplyr joins #</span></a>
<a class="sourceLine" id="cb33-66" title="66"></a>
<a class="sourceLine" id="cb33-67" title="67">temptib &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/products.csv&quot;</span>)</a>
<a class="sourceLine" id="cb33-68" title="68">temptib</a>
<a class="sourceLine" id="cb33-69" title="69"><span class="kw">left_join</span>(tib, temptib, <span class="dt">by =</span> <span class="st">&quot;gene&quot;</span>)</a>
<a class="sourceLine" id="cb33-70" title="70"></a>
<a class="sourceLine" id="cb33-71" title="71"><span class="co"># Unwanted column in temptib</span></a>
<a class="sourceLine" id="cb33-72" title="72"></a>
<a class="sourceLine" id="cb33-73" title="73">temptib &lt;-<span class="st"> </span><span class="kw">mutate</span>(temptib, <span class="dt">unwanted =</span> <span class="kw">rep</span>(<span class="st">&quot;unwanted&quot;</span>,</a>
<a class="sourceLine" id="cb33-74" title="74">                  <span class="kw">nrow</span>(temptib)));</a>
<a class="sourceLine" id="cb33-75" title="75">temptib</a>
<a class="sourceLine" id="cb33-76" title="76"><span class="kw">left_join</span>(tib, temptib, <span class="dt">by =</span> <span class="st">&quot;gene&quot;</span>)</a>
<a class="sourceLine" id="cb33-77" title="77"><span class="kw">left_join</span>(tib, <span class="kw">select</span>(temptib, gene, product),</a>
<a class="sourceLine" id="cb33-78" title="78">                  <span class="dt">by =</span> <span class="st">&quot;gene&quot;</span>)</a>
<a class="sourceLine" id="cb33-79" title="79"></a>
<a class="sourceLine" id="cb33-80" title="80"><span class="co">### Piping </span><span class="al">###</span></a>
<a class="sourceLine" id="cb33-81" title="81"><span class="co"># Useful for discarding intermediate objects.</span></a>
<a class="sourceLine" id="cb33-82" title="82"><span class="co"># Easier to apply on several objects.</span></a>
<a class="sourceLine" id="cb33-83" title="83"></a>
<a class="sourceLine" id="cb33-84" title="84"><span class="kw">select</span>(tib, gene, logFC) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb33-85" title="85"><span class="st">  </span><span class="kw">left_join</span>(<span class="kw">select</span>(temptib, gene, product), <span class="dt">by =</span> <span class="st">&quot;gene&quot;</span>)</a>
<a class="sourceLine" id="cb33-86" title="86"></a>
<a class="sourceLine" id="cb33-87" title="87">tib &lt;-<span class="st"> </span>tib <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(<span class="kw">select</span>(temptib, gene, product),</a>
<a class="sourceLine" id="cb33-88" title="88">                         <span class="dt">by =</span> <span class="st">&quot;gene&quot;</span>)</a>
<a class="sourceLine" id="cb33-89" title="89">tib;</a>
<a class="sourceLine" id="cb33-90" title="90"></a>
<a class="sourceLine" id="cb33-91" title="91"><span class="kw">saveRDS</span>(tib, <span class="dt">file =</span> <span class="st">&quot;tib.rds&quot;</span>);</a></code></pre></div>
<!-- >>> -->
<!-- <<< sorting.r -->
<h1 id="sorting">Sorting</h1>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="co">###########################</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="co">### Sorting a data frame </span><span class="al">###</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="co">############################</span></a>
<a class="sourceLine" id="cb34-5" title="5"></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="co"># Three related functions: sort(), order(), rank()</span></a>
<a class="sourceLine" id="cb34-7" title="7"></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="co">### sort() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb34-9" title="9"></a>
<a class="sourceLine" id="cb34-10" title="10"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb34-11" title="11"></a>
<a class="sourceLine" id="cb34-12" title="12"><span class="kw">set.seed</span>(<span class="dv">20230201</span>); <span class="co"># So that we have the same random numbers.</span></a>
<a class="sourceLine" id="cb34-13" title="13">x &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">runif</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">50</span>) <span class="op">*</span><span class="st"> </span><span class="dv">7</span>)</a>
<a class="sourceLine" id="cb34-14" title="14">x</a>
<a class="sourceLine" id="cb34-15" title="15">sx &lt;-<span class="st"> </span><span class="kw">sort</span>(x)</a>
<a class="sourceLine" id="cb34-16" title="16">sx</a>
<a class="sourceLine" id="cb34-17" title="17"></a>
<a class="sourceLine" id="cb34-18" title="18"><span class="co">### The order of numbers in x itself is unchanged by the sort</span></a>
<a class="sourceLine" id="cb34-19" title="19"><span class="co">### operation. sx is a new vector.</span></a>
<a class="sourceLine" id="cb34-20" title="20"></a>
<a class="sourceLine" id="cb34-21" title="21"><span class="co">### rank() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb34-22" title="22"></a>
<a class="sourceLine" id="cb34-23" title="23">rx &lt;-<span class="st"> </span><span class="kw">rank</span>(x)</a>
<a class="sourceLine" id="cb34-24" title="24"></a>
<a class="sourceLine" id="cb34-25" title="25">rx</a>
<a class="sourceLine" id="cb34-26" title="26"></a>
<a class="sourceLine" id="cb34-27" title="27"><span class="co">### order() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb34-28" title="28"></a>
<a class="sourceLine" id="cb34-29" title="29">ox &lt;-<span class="st"> </span><span class="kw">order</span>(x);</a>
<a class="sourceLine" id="cb34-30" title="30"></a>
<a class="sourceLine" id="cb34-31" title="31">ox;</a>
<a class="sourceLine" id="cb34-32" title="32"></a>
<a class="sourceLine" id="cb34-33" title="33"><span class="co"># For the same vector x, compare the output of rank() and order()</span></a>
<a class="sourceLine" id="cb34-34" title="34"><span class="co"># x, ox and rx.</span></a>
<a class="sourceLine" id="cb34-35" title="35"></a>
<a class="sourceLine" id="cb34-36" title="36"></a>
<a class="sourceLine" id="cb34-37" title="37"><span class="co"># To sort a data frame by some column, we cannot simply use</span></a>
<a class="sourceLine" id="cb34-38" title="38"><span class="co"># sort().</span></a>
<a class="sourceLine" id="cb34-39" title="39"></a>
<a class="sourceLine" id="cb34-40" title="40"><span class="co"># 1. First we get the order of rows by calling order() on the</span></a>
<a class="sourceLine" id="cb34-41" title="41"><span class="co">#    column we wish to sort by.</span></a>
<a class="sourceLine" id="cb34-42" title="42"></a>
<a class="sourceLine" id="cb34-43" title="43"><span class="co"># 2. Then we use the order to sort the entire data frame.</span></a>
<a class="sourceLine" id="cb34-44" title="44"></a>
<a class="sourceLine" id="cb34-45" title="45">data &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data.rds&quot;</span>);</a>
<a class="sourceLine" id="cb34-46" title="46"></a>
<a class="sourceLine" id="cb34-47" title="47">ordvec &lt;-<span class="st"> </span><span class="kw">order</span>(data<span class="op">$</span>logFC);</a>
<a class="sourceLine" id="cb34-48" title="48">sdata &lt;-<span class="st"> </span>data[ordvec, ];</a>
<a class="sourceLine" id="cb34-49" title="49"><span class="kw">head</span>(sdata);</a>
<a class="sourceLine" id="cb34-50" title="50"><span class="kw">tail</span>(sdata);</a>
<a class="sourceLine" id="cb34-51" title="51"></a>
<a class="sourceLine" id="cb34-52" title="52"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb34-53" title="53"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb34-54" title="54"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb34-55" title="55"></a>
<a class="sourceLine" id="cb34-56" title="56">data &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data.rds&quot;</span>);</a>
<a class="sourceLine" id="cb34-57" title="57"></a>
<a class="sourceLine" id="cb34-58" title="58"><span class="co"># 1. It would be more meaningful to sort data on absolute log</span></a>
<a class="sourceLine" id="cb34-59" title="59"><span class="co">#    fold change and to have the highest change at the top.</span></a>
<a class="sourceLine" id="cb34-60" title="60"></a>
<a class="sourceLine" id="cb34-61" title="61"><span class="co"># 2. The function for getting absolute values is abs().</span></a>
<a class="sourceLine" id="cb34-62" title="62"></a>
<a class="sourceLine" id="cb34-63" title="63"><span class="co"># 3. Consult the help for order() to find the named argument you</span></a>
<a class="sourceLine" id="cb34-64" title="64"><span class="co">#    need to use to order in decreasing order.</span></a>
<a class="sourceLine" id="cb34-65" title="65"></a>
<a class="sourceLine" id="cb34-66" title="66"><span class="co"># 4. Now sort data by decreasing value of absolute logFC.</span></a>
<a class="sourceLine" id="cb34-67" title="67"></a>
<a class="sourceLine" id="cb34-68" title="68"></a>
<a class="sourceLine" id="cb34-69" title="69"><span class="co">### Breaking ties </span><span class="al">###</span></a>
<a class="sourceLine" id="cb34-70" title="70"></a>
<a class="sourceLine" id="cb34-71" title="71"><span class="co"># If you have ties in the column you are sorting by then you</span></a>
<a class="sourceLine" id="cb34-72" title="72"><span class="co"># might wish to use a second column to break the ties.</span></a>
<a class="sourceLine" id="cb34-73" title="73"> </a>
<a class="sourceLine" id="cb34-74" title="74"><span class="co"># Below, I am copying data to data2 and setting some control</span></a>
<a class="sourceLine" id="cb34-75" title="75"><span class="co"># values to 50.</span></a>
<a class="sourceLine" id="cb34-76" title="76"></a>
<a class="sourceLine" id="cb34-77" title="77">data2 &lt;-<span class="st"> </span>data;</a>
<a class="sourceLine" id="cb34-78" title="78">data2[<span class="kw">c</span>(<span class="st">&quot;SCO0500&quot;</span>, <span class="st">&quot;SCO0501&quot;</span>, <span class="st">&quot;SCO0502&quot;</span>, <span class="st">&quot;SCO0503&quot;</span>) , <span class="st">&quot;control&quot;</span>] &lt;-<span class="st"> </span><span class="dv">50</span>;</a>
<a class="sourceLine" id="cb34-79" title="79"></a>
<a class="sourceLine" id="cb34-80" title="80"><span class="co"># Suppose we wish to sort this data frame in decreasing order by</span></a>
<a class="sourceLine" id="cb34-81" title="81"><span class="co"># the control value but in increasing order by the absolute</span></a>
<a class="sourceLine" id="cb34-82" title="82"><span class="co"># logFC.</span></a>
<a class="sourceLine" id="cb34-83" title="83"></a>
<a class="sourceLine" id="cb34-84" title="84">ordvec &lt;-<span class="st"> </span><span class="kw">order</span>(<span class="op">-</span>data2<span class="op">$</span>control, <span class="kw">abs</span>(data2<span class="op">$</span>logFC))</a>
<a class="sourceLine" id="cb34-85" title="85">sdata2 &lt;-<span class="st"> </span>data2[ordvec, ]</a>
<a class="sourceLine" id="cb34-86" title="86"><span class="kw">head</span>(sdata2)</a>
<a class="sourceLine" id="cb34-87" title="87"></a>
<a class="sourceLine" id="cb34-88" title="88"><span class="co">###################</span></a>
<a class="sourceLine" id="cb34-89" title="89"><span class="co">### dplyr style </span><span class="al">###</span></a>
<a class="sourceLine" id="cb34-90" title="90"><span class="co">###################</span></a>
<a class="sourceLine" id="cb34-91" title="91"></a>
<a class="sourceLine" id="cb34-92" title="92">tib &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;tib.rds&quot;</span>);</a>
<a class="sourceLine" id="cb34-93" title="93"></a>
<a class="sourceLine" id="cb34-94" title="94">stib &lt;-<span class="st"> </span><span class="kw">arrange</span>(tib, logFC);</a>
<a class="sourceLine" id="cb34-95" title="95">stib</a>
<a class="sourceLine" id="cb34-96" title="96"></a>
<a class="sourceLine" id="cb34-97" title="97">stib &lt;-<span class="st"> </span><span class="kw">arrange</span>(tib, <span class="kw">desc</span>(<span class="kw">abs</span>(logFC)));</a>
<a class="sourceLine" id="cb34-98" title="98">stib</a>
<a class="sourceLine" id="cb34-99" title="99"></a>
<a class="sourceLine" id="cb34-100" title="100"></a></code></pre></div>
<!-- >>> -->
<!-- <<< condsubset.r -->
<h1 id="conditional-subsetting">Conditional subsetting</h1>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="co">### Conditional subsetting </span><span class="al">###</span></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb35-5" title="5"></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb35-7" title="7"></a>
<a class="sourceLine" id="cb35-8" title="8">data &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data.rds&quot;</span>);</a>
<a class="sourceLine" id="cb35-9" title="9"></a>
<a class="sourceLine" id="cb35-10" title="10"><span class="kw">head</span>(data);</a>
<a class="sourceLine" id="cb35-11" title="11"><span class="kw">nrow</span>(data)</a>
<a class="sourceLine" id="cb35-12" title="12"></a>
<a class="sourceLine" id="cb35-13" title="13"></a>
<a class="sourceLine" id="cb35-14" title="14">up1.tf &lt;-<span class="st"> </span>data<span class="op">$</span>logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>;</a>
<a class="sourceLine" id="cb35-15" title="15">up1 &lt;-<span class="st"> </span>data[up1.tf, ];</a>
<a class="sourceLine" id="cb35-16" title="16"><span class="kw">nrow</span>(up1);</a>
<a class="sourceLine" id="cb35-17" title="17"><span class="kw">head</span>(up1)</a>
<a class="sourceLine" id="cb35-18" title="18"></a>
<a class="sourceLine" id="cb35-19" title="19">up1c7.tf &lt;-<span class="st"> </span>data<span class="op">$</span>logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>data<span class="op">$</span>control <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span> ;</a>
<a class="sourceLine" id="cb35-20" title="20">up1c7 &lt;-<span class="st"> </span>data[up1c7.tf, ];</a>
<a class="sourceLine" id="cb35-21" title="21"><span class="kw">nrow</span>(up1c7)</a>
<a class="sourceLine" id="cb35-22" title="22"><span class="kw">head</span>(up1c7)</a>
<a class="sourceLine" id="cb35-23" title="23"></a>
<a class="sourceLine" id="cb35-24" title="24"><span class="co">############################</span></a>
<a class="sourceLine" id="cb35-25" title="25"><span class="co">### which() and subset() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb35-26" title="26"><span class="co">############################</span></a>
<a class="sourceLine" id="cb35-27" title="27"></a>
<a class="sourceLine" id="cb35-28" title="28">which17 &lt;-<span class="st"> </span><span class="kw">which</span>(data<span class="op">$</span>logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>data<span class="op">$</span>control <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span>);</a>
<a class="sourceLine" id="cb35-29" title="29"><span class="kw">class</span>(which17)</a>
<a class="sourceLine" id="cb35-30" title="30">which17</a>
<a class="sourceLine" id="cb35-31" title="31">up1c7 &lt;-<span class="st"> </span>data[which17, ];</a>
<a class="sourceLine" id="cb35-32" title="32"><span class="kw">nrow</span>(up1c7)</a>
<a class="sourceLine" id="cb35-33" title="33"><span class="kw">head</span>(up1c7)</a>
<a class="sourceLine" id="cb35-34" title="34"></a>
<a class="sourceLine" id="cb35-35" title="35"><span class="co">################</span></a>
<a class="sourceLine" id="cb35-36" title="36"><span class="co">### subset() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb35-37" title="37"><span class="co">################</span></a>
<a class="sourceLine" id="cb35-38" title="38"></a>
<a class="sourceLine" id="cb35-39" title="39">fc1c7 &lt;-<span class="st"> </span><span class="kw">subset</span>(data, logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>control <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span>);</a>
<a class="sourceLine" id="cb35-40" title="40">fc1c7;</a>
<a class="sourceLine" id="cb35-41" title="41">fc1c7 &lt;-<span class="st"> </span><span class="kw">subset</span>(data, data<span class="op">$</span>logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>data<span class="op">$</span>control <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span>);</a>
<a class="sourceLine" id="cb35-42" title="42">fc1c7;</a>
<a class="sourceLine" id="cb35-43" title="43"></a>
<a class="sourceLine" id="cb35-44" title="44"></a>
<a class="sourceLine" id="cb35-45" title="45"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb35-46" title="46"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb35-47" title="47"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb35-48" title="48"></a>
<a class="sourceLine" id="cb35-49" title="49"><span class="co"># 1. Make a new data frame containing just the control and</span></a>
<a class="sourceLine" id="cb35-50" title="50"><span class="co">#    treatment columns from data.</span></a>
<a class="sourceLine" id="cb35-51" title="51"></a>
<a class="sourceLine" id="cb35-52" title="52"><span class="co"># 2. Use rowMeans() on this new data frame to get the average of</span></a>
<a class="sourceLine" id="cb35-53" title="53"><span class="co">#    control and treatment for each row.</span></a>
<a class="sourceLine" id="cb35-54" title="54"></a>
<a class="sourceLine" id="cb35-55" title="55"><span class="co"># 3. Add a column named &quot;avexp&quot; to data containing the vector</span></a>
<a class="sourceLine" id="cb35-56" title="56"><span class="co">#    obtained in the step above.</span></a>
<a class="sourceLine" id="cb35-57" title="57"></a>
<a class="sourceLine" id="cb35-58" title="58"><span class="co"># 4. Select rows from data where avexp is more than or equal to 6</span></a>
<a class="sourceLine" id="cb35-59" title="59"><span class="co">#    and abs(logFC) is more than or equal to 4.</span></a>
<a class="sourceLine" id="cb35-60" title="60"></a>
<a class="sourceLine" id="cb35-61" title="61"><span class="co"># 5. How many rows do you get in the step above?</span></a>
<a class="sourceLine" id="cb35-62" title="62"></a>
<a class="sourceLine" id="cb35-63" title="63"><span class="co">####################################</span></a>
<a class="sourceLine" id="cb35-64" title="64"><span class="co">### Vectorised or non-vectorised </span><span class="al">###</span></a>
<a class="sourceLine" id="cb35-65" title="65"><span class="co">####################################</span></a>
<a class="sourceLine" id="cb35-66" title="66"></a>
<a class="sourceLine" id="cb35-67" title="67"><span class="kw">set.seed</span>(<span class="dv">20230201</span>); <span class="co"># So that we have the same random numbers.</span></a>
<a class="sourceLine" id="cb35-68" title="68">x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>, <span class="dt">min =</span> <span class="dv">3</span>, <span class="dt">max =</span> <span class="dv">6</span>);</a>
<a class="sourceLine" id="cb35-69" title="69">y &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>, <span class="dt">min =</span> <span class="dv">12</span>, <span class="dt">max =</span> <span class="dv">20</span>);</a>
<a class="sourceLine" id="cb35-70" title="70">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y);</a>
<a class="sourceLine" id="cb35-71" title="71">df</a>
<a class="sourceLine" id="cb35-72" title="72"><span class="kw">subset</span>(df, x <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="op">&amp;</span><span class="st"> </span>y <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span>);</a>
<a class="sourceLine" id="cb35-73" title="73"><span class="kw">subset</span>(df, x <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span> <span class="op">&amp;&amp;</span><span class="st"> </span>y <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span>);</a>
<a class="sourceLine" id="cb35-74" title="74"></a>
<a class="sourceLine" id="cb35-75" title="75"><span class="kw">subset</span>(df, x <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span> <span class="op">|</span><span class="st"> </span>y <span class="op">&lt;</span><span class="st"> </span><span class="dv">15</span>);</a>
<a class="sourceLine" id="cb35-76" title="76"><span class="kw">subset</span>(df, x <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span> <span class="op">||</span><span class="st"> </span>y <span class="op">&lt;</span><span class="st"> </span><span class="dv">15</span>);</a>
<a class="sourceLine" id="cb35-77" title="77"></a>
<a class="sourceLine" id="cb35-78" title="78"><span class="co"># What is the output of </span></a>
<a class="sourceLine" id="cb35-79" title="79"><span class="co"># 1. df$x &gt; 4 &amp; df$y &gt; 15</span></a>
<a class="sourceLine" id="cb35-80" title="80"><span class="co"># 2. df$x &gt; 4 &amp;&amp; df$y &gt; 15</span></a>
<a class="sourceLine" id="cb35-81" title="81"><span class="co"># 3. df$x &lt; 4 | df$y &lt; 15</span></a>
<a class="sourceLine" id="cb35-82" title="82"><span class="co"># 4. df$x &lt; 4 || df$y &lt; 15</span></a>
<a class="sourceLine" id="cb35-83" title="83"></a>
<a class="sourceLine" id="cb35-84" title="84"><span class="co">###################</span></a>
<a class="sourceLine" id="cb35-85" title="85"><span class="co">### dplyr style </span><span class="al">###</span></a>
<a class="sourceLine" id="cb35-86" title="86"><span class="co">###################</span></a>
<a class="sourceLine" id="cb35-87" title="87"></a>
<a class="sourceLine" id="cb35-88" title="88"><span class="co">### group_by() and summarise() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb35-89" title="89"></a>
<a class="sourceLine" id="cb35-90" title="90">tib &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;tib.rds&quot;</span>);</a>
<a class="sourceLine" id="cb35-91" title="91">stib &lt;-<span class="st"> </span><span class="kw">arrange</span>(tib, <span class="kw">desc</span>(<span class="kw">abs</span>(logFC)));</a>
<a class="sourceLine" id="cb35-92" title="92"></a>
<a class="sourceLine" id="cb35-93" title="93"><span class="kw">group_by</span>(stib, <span class="dt">lfc3 =</span> <span class="kw">abs</span>(logFC) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-94" title="94"><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>());</a>
<a class="sourceLine" id="cb35-95" title="95"></a>
<a class="sourceLine" id="cb35-96" title="96">stib <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="dt">lfc3 =</span> <span class="kw">abs</span>(logFC) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">3</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-97" title="97"><span class="st">          </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>());</a>
<a class="sourceLine" id="cb35-98" title="98"></a>
<a class="sourceLine" id="cb35-99" title="99"><span class="co"># Take care not to put the pipe at the start of a line.</span></a>
<a class="sourceLine" id="cb35-100" title="100"></a>
<a class="sourceLine" id="cb35-101" title="101"><span class="co">### filter() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb35-102" title="102"></a>
<a class="sourceLine" id="cb35-103" title="103"><span class="co"># Note dplyr::filter() masks functions of the same</span></a>
<a class="sourceLine" id="cb35-104" title="104"><span class="co"># name in base and stats packages.</span></a>
<a class="sourceLine" id="cb35-105" title="105"></a>
<a class="sourceLine" id="cb35-106" title="106"><span class="co"># At least two-fold upregulated.</span></a>
<a class="sourceLine" id="cb35-107" title="107"></a>
<a class="sourceLine" id="cb35-108" title="108">stib <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb35-109" title="109"><span class="kw">filter</span>(stib, logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb35-110" title="110"></a>
<a class="sourceLine" id="cb35-111" title="111">stib <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>())</a>
<a class="sourceLine" id="cb35-112" title="112"></a>
<a class="sourceLine" id="cb35-113" title="113"><span class="co"># Reminder to demonstrate the consequence of putting</span></a>
<a class="sourceLine" id="cb35-114" title="114"><span class="co"># the pipe at the start of a line.</span></a>
<a class="sourceLine" id="cb35-115" title="115"></a>
<a class="sourceLine" id="cb35-116" title="116">stib <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>control <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-117" title="117"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>())</a>
<a class="sourceLine" id="cb35-118" title="118"></a>
<a class="sourceLine" id="cb35-119" title="119">stib <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>control <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb35-120" title="120">   <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">grepl</span>(<span class="st">&quot;regulator|sigma|transcription&quot;</span>, product,</a>
<a class="sourceLine" id="cb35-121" title="121">      <span class="dt">ignore.case =</span> T))</a>
<a class="sourceLine" id="cb35-122" title="122">    ); </a>
<a class="sourceLine" id="cb35-123" title="123"></a>
<a class="sourceLine" id="cb35-124" title="124"><span class="co"># Below is the same as above.</span></a>
<a class="sourceLine" id="cb35-125" title="125"><span class="kw">filter</span>(stib, logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>control <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb35-126" title="126">   <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">grepl</span>(<span class="st">&quot;regulator|sigma|transcription&quot;</span>, product,</a>
<a class="sourceLine" id="cb35-127" title="127">      <span class="dt">ignore.case =</span> T))</a>
<a class="sourceLine" id="cb35-128" title="128">    ); </a>
<a class="sourceLine" id="cb35-129" title="129"></a>
<a class="sourceLine" id="cb35-130" title="130"><span class="co"># The outputs of the above two are assignable.</span></a>
<a class="sourceLine" id="cb35-131" title="131"></a>
<a class="sourceLine" id="cb35-132" title="132">hiup2 &lt;-<span class="st"> </span><span class="kw">filter</span>(stib, logFC <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>control <span class="op">&gt;=</span><span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb35-133" title="133">   <span class="op">&amp;</span><span class="st"> </span>(<span class="kw">grepl</span>(<span class="st">&quot;regulator|sigma|transcription&quot;</span>, product,</a>
<a class="sourceLine" id="cb35-134" title="134">      <span class="dt">ignore.case =</span> T))</a>
<a class="sourceLine" id="cb35-135" title="135">    ); </a>
<a class="sourceLine" id="cb35-136" title="136">hiup2</a></code></pre></div>
<!-- >>> -->
<!-- <<< regex.r -->
<h1 id="regular-expressions">Regular Expressions</h1>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="co">###########################</span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="co">### Regular Expressions </span><span class="al">###</span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="co">###########################</span></a>
<a class="sourceLine" id="cb36-5" title="5"></a>
<a class="sourceLine" id="cb36-6" title="6"><span class="co"># Suppose we want all genes with logFC more than 2.5 AND which</span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="co"># are not &quot;hypothetical proteins&quot;.</span></a>
<a class="sourceLine" id="cb36-8" title="8"></a>
<a class="sourceLine" id="cb36-9" title="9"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb36-10" title="10">data &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;data.rds&quot;</span>);</a>
<a class="sourceLine" id="cb36-11" title="11"></a>
<a class="sourceLine" id="cb36-12" title="12">notHypoth2<span class="fl">.5</span> &lt;-<span class="st"> </span>data[</a>
<a class="sourceLine" id="cb36-13" title="13">  <span class="kw">abs</span>(data<span class="op">$</span>logFC) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">2.5</span> <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb36-14" title="14"><span class="st">    </span>data<span class="op">$</span>product <span class="op">!=</span><span class="st"> &quot;hypothetical protein&quot;</span></a>
<a class="sourceLine" id="cb36-15" title="15">  , ];</a>
<a class="sourceLine" id="cb36-16" title="16"></a>
<a class="sourceLine" id="cb36-17" title="17"><span class="kw">head</span>(notHypoth2<span class="fl">.5</span>);</a>
<a class="sourceLine" id="cb36-18" title="18"><span class="kw">nrow</span>(notHypoth2<span class="fl">.5</span>);</a>
<a class="sourceLine" id="cb36-19" title="19"></a>
<a class="sourceLine" id="cb36-20" title="20"></a>
<a class="sourceLine" id="cb36-21" title="21"><span class="co"># In reality the situation is usually not so simple.</span></a>
<a class="sourceLine" id="cb36-22" title="22"></a>
<a class="sourceLine" id="cb36-23" title="23"><span class="co"># There might be more than one space between &quot;hypothetical&quot; and</span></a>
<a class="sourceLine" id="cb36-24" title="24"><span class="co"># &quot;protein&quot;?</span></a>
<a class="sourceLine" id="cb36-25" title="25"></a>
<a class="sourceLine" id="cb36-26" title="26"><span class="co"># Inconsistent capitalisation, e.g. &quot;hypothetical&quot; starting with</span></a>
<a class="sourceLine" id="cb36-27" title="27"><span class="co"># a capital &quot;H&quot;.</span></a>
<a class="sourceLine" id="cb36-28" title="28"></a>
<a class="sourceLine" id="cb36-29" title="29"><span class="co"># Alternative spellings.</span></a>
<a class="sourceLine" id="cb36-30" title="30"></a>
<a class="sourceLine" id="cb36-31" title="31"><span class="co"># Most characters in a RE match themselves but some have special</span></a>
<a class="sourceLine" id="cb36-32" title="32"><span class="co"># meanings.</span></a>
<a class="sourceLine" id="cb36-33" title="33"></a>
<a class="sourceLine" id="cb36-34" title="34"><span class="co"># To use the special ones literally you need to escape them with</span></a>
<a class="sourceLine" id="cb36-35" title="35"><span class="co"># &quot;\&quot;. e.g. \$ for the dollar symbol.</span></a>
<a class="sourceLine" id="cb36-36" title="36"></a>
<a class="sourceLine" id="cb36-37" title="37"><span class="co">### Quantifiers </span><span class="al">###</span></a>
<a class="sourceLine" id="cb36-38" title="38"></a>
<a class="sourceLine" id="cb36-39" title="39"><span class="co"># ?     Zero or once.                              </span></a>
<a class="sourceLine" id="cb36-40" title="40"><span class="co"># *     Zero or more.                              </span></a>
<a class="sourceLine" id="cb36-41" title="41"><span class="co"># +     Once or more.                              </span></a>
<a class="sourceLine" id="cb36-42" title="42"><span class="co"># {n}   Exactly n times.                           </span></a>
<a class="sourceLine" id="cb36-43" title="43"><span class="co"># {m,n} At least m times but no more than n times. </span></a>
<a class="sourceLine" id="cb36-44" title="44"><span class="co"># {m,}  At least m times.                          </span></a>
<a class="sourceLine" id="cb36-45" title="45"></a>
<a class="sourceLine" id="cb36-46" title="46"></a>
<a class="sourceLine" id="cb36-47" title="47"><span class="co">### Metacharacters </span><span class="al">###</span></a>
<a class="sourceLine" id="cb36-48" title="48"> </a>
<a class="sourceLine" id="cb36-49" title="49"><span class="co"># .   Any character                               </span></a>
<a class="sourceLine" id="cb36-50" title="50"><span class="co"># ^   Beginning of the string.                    </span></a>
<a class="sourceLine" id="cb36-51" title="51"><span class="co"># $   End of the string.                          </span></a>
<a class="sourceLine" id="cb36-52" title="52"></a>
<a class="sourceLine" id="cb36-53" title="53"></a>
<a class="sourceLine" id="cb36-54" title="54"><span class="co">### Character classes </span><span class="al">###</span></a>
<a class="sourceLine" id="cb36-55" title="55"></a>
<a class="sourceLine" id="cb36-56" title="56"><span class="co"># []  Group of characters e.g. [A-Z].             </span></a>
<a class="sourceLine" id="cb36-57" title="57"><span class="co"># [^] Not in the group of characters e.g. [^0-9]. </span></a>
<a class="sourceLine" id="cb36-58" title="58"></a>
<a class="sourceLine" id="cb36-59" title="59"><span class="co">### Abbreviations </span><span class="al">###</span></a>
<a class="sourceLine" id="cb36-60" title="60"></a>
<a class="sourceLine" id="cb36-61" title="61"><span class="co"># \s   Any white space [ \t\n\r\f]</span></a>
<a class="sourceLine" id="cb36-62" title="62"><span class="co"># \d   Any digit [0-9]</span></a>
<a class="sourceLine" id="cb36-63" title="63"><span class="co"># \w   Any word character [0-9a-zA-Z_]</span></a>
<a class="sourceLine" id="cb36-64" title="64"><span class="co"># There are others.</span></a>
<a class="sourceLine" id="cb36-65" title="65"></a>
<a class="sourceLine" id="cb36-66" title="66">f &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb36-67" title="67"><span class="st">&quot;favourite colour&quot;</span>,</a>
<a class="sourceLine" id="cb36-68" title="68"><span class="st">&quot;Favourite Colour&quot;</span>,</a>
<a class="sourceLine" id="cb36-69" title="69"><span class="st">&quot;favorite color&quot;</span>,</a>
<a class="sourceLine" id="cb36-70" title="70"><span class="st">&quot;favorite colored dress&quot;</span>,</a>
<a class="sourceLine" id="cb36-71" title="71"><span class="st">&quot;favourite  coloured dress&quot;</span>,</a>
<a class="sourceLine" id="cb36-72" title="72"><span class="st">&quot;nice colored dress&quot;</span></a>
<a class="sourceLine" id="cb36-73" title="73">);</a>
<a class="sourceLine" id="cb36-74" title="74"></a>
<a class="sourceLine" id="cb36-75" title="75"><span class="co"># The indexes which match.</span></a>
<a class="sourceLine" id="cb36-76" title="76"><span class="kw">grep</span>(<span class="st">&quot;colour&quot;</span>, f);</a>
<a class="sourceLine" id="cb36-77" title="77"></a>
<a class="sourceLine" id="cb36-78" title="78"><span class="co"># The values which match.</span></a>
<a class="sourceLine" id="cb36-79" title="79"><span class="kw">grep</span>(<span class="st">&quot;colour&quot;</span>, f, <span class="dt">value =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb36-80" title="80"></a>
<a class="sourceLine" id="cb36-81" title="81"><span class="co"># One or zero &#39;u&#39;.</span></a>
<a class="sourceLine" id="cb36-82" title="82"><span class="kw">grep</span>(<span class="st">&quot;colou?r&quot;</span>, f, <span class="dt">value =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb36-83" title="83"></a>
<a class="sourceLine" id="cb36-84" title="84"><span class="co"># $ to anchor match at end of string.</span></a>
<a class="sourceLine" id="cb36-85" title="85"><span class="kw">grep</span>(<span class="st">&quot;colou?r$&quot;</span>, f, <span class="dt">value =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb36-86" title="86"></a>
<a class="sourceLine" id="cb36-87" title="87"><span class="kw">grep</span>(<span class="st">&quot;favou?rite colou?r$&quot;</span>, f, <span class="dt">value =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb36-88" title="88"></a>
<a class="sourceLine" id="cb36-89" title="89"><span class="co"># + after the space mean one or more spaces.</span></a>
<a class="sourceLine" id="cb36-90" title="90"><span class="co"># And, case-insensitive matching.</span></a>
<a class="sourceLine" id="cb36-91" title="91"><span class="kw">grep</span>(<span class="st">&quot;favou?rite +colou?r&quot;</span>, f, <span class="dt">value =</span> <span class="ot">TRUE</span>, <span class="dt">ignore.case =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb36-92" title="92"></a>
<a class="sourceLine" id="cb36-93" title="93"><span class="co"># using \s for space. Otherwise same as above.</span></a>
<a class="sourceLine" id="cb36-94" title="94"><span class="kw">grep</span>(<span class="st">&quot;favou?rite</span><span class="ch">\\</span><span class="st">s+colou?r&quot;</span>, f, <span class="dt">value =</span> <span class="ot">TRUE</span>, <span class="dt">ignore.case =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb36-95" title="95"></a>
<a class="sourceLine" id="cb36-96" title="96"><span class="co"># logical (TRUE or FALSE) output.</span></a>
<a class="sourceLine" id="cb36-97" title="97"><span class="kw">grepl</span>(<span class="st">&quot;favou?rite +colou?r&quot;</span>, f, <span class="dt">ignore.case =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb36-98" title="98"></a>
<a class="sourceLine" id="cb36-99" title="99"><span class="co"># Substitution</span></a>
<a class="sourceLine" id="cb36-100" title="100">spacefixed &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot; {2,}&quot;</span>, <span class="st">&quot; &quot;</span>, f);</a>
<a class="sourceLine" id="cb36-101" title="101">spellfixed &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot;vori&quot;</span>, <span class="st">&quot;vouri&quot;</span>, spacefixed);</a>
<a class="sourceLine" id="cb36-102" title="102"></a>
<a class="sourceLine" id="cb36-103" title="103">tof.not.hypo &lt;-<span class="st"> </span><span class="op">!</span><span class="kw">grepl</span>(</a>
<a class="sourceLine" id="cb36-104" title="104"><span class="st">&quot;hypothetical +protein&quot;</span>,</a>
<a class="sourceLine" id="cb36-105" title="105">data<span class="op">$</span>product, <span class="dt">ignore.case =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb36-106" title="106"></a>
<a class="sourceLine" id="cb36-107" title="107">notHypoth2<span class="fl">.5</span> &lt;-<span class="st"> </span>data[<span class="kw">abs</span>(data<span class="op">$</span>logFC) <span class="op">&gt;=</span><span class="st"> </span><span class="fl">2.5</span></a>
<a class="sourceLine" id="cb36-108" title="108"><span class="op">&amp;</span><span class="st"> </span>tof.not.hypo , ]</a>
<a class="sourceLine" id="cb36-109" title="109"></a>
<a class="sourceLine" id="cb36-110" title="110"><span class="kw">nrow</span>(notHypoth2<span class="fl">.5</span>)</a>
<a class="sourceLine" id="cb36-111" title="111"></a>
<a class="sourceLine" id="cb36-112" title="112"><span class="kw">head</span>(notHypoth2<span class="fl">.5</span>)</a>
<a class="sourceLine" id="cb36-113" title="113"></a>
<a class="sourceLine" id="cb36-114" title="114"><span class="co"># There is a lot more to regular expressions than we</span></a>
<a class="sourceLine" id="cb36-115" title="115"><span class="co"># have demonstrated above. They are a truly general</span></a>
<a class="sourceLine" id="cb36-116" title="116"><span class="co"># purpose high value skill to acquire. All programming</span></a>
<a class="sourceLine" id="cb36-117" title="117"><span class="co"># languages worth learning / using have them in some</span></a>
<a class="sourceLine" id="cb36-118" title="118"><span class="co"># form or another.</span></a>
<a class="sourceLine" id="cb36-119" title="119"></a>
<a class="sourceLine" id="cb36-120" title="120"><span class="co">### Some useful regular expression related functions in</span></a>
<a class="sourceLine" id="cb36-121" title="121"><span class="co">### R.</span></a>
<a class="sourceLine" id="cb36-122" title="122"></a>
<a class="sourceLine" id="cb36-123" title="123"><span class="co"># grep()</span></a>
<a class="sourceLine" id="cb36-124" title="124"><span class="co"># regexpr()</span></a>
<a class="sourceLine" id="cb36-125" title="125"><span class="co"># gregexpr()</span></a>
<a class="sourceLine" id="cb36-126" title="126"><span class="co"># sub()</span></a>
<a class="sourceLine" id="cb36-127" title="127"><span class="co"># gsub()</span></a>
<a class="sourceLine" id="cb36-128" title="128"></a>
<a class="sourceLine" id="cb36-129" title="129"><span class="co">#####################</span></a>
<a class="sourceLine" id="cb36-130" title="130"><span class="co">### stringr style </span><span class="al">###</span></a>
<a class="sourceLine" id="cb36-131" title="131"><span class="co">#####################</span></a>
<a class="sourceLine" id="cb36-132" title="132"></a>
<a class="sourceLine" id="cb36-133" title="133"><span class="co"># Equivalent of grep</span></a>
<a class="sourceLine" id="cb36-134" title="134"></a>
<a class="sourceLine" id="cb36-135" title="135"><span class="kw">str_which</span>(f, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">w+ou</span><span class="ch">\\</span><span class="st">w+&quot;</span>);</a>
<a class="sourceLine" id="cb36-136" title="136"></a>
<a class="sourceLine" id="cb36-137" title="137"><span class="kw">str_which</span>(f, <span class="st">&quot;^fav&quot;</span>);</a>
<a class="sourceLine" id="cb36-138" title="138"></a>
<a class="sourceLine" id="cb36-139" title="139"><span class="kw">str_which</span>(f, <span class="kw">regex</span>(<span class="st">&quot;^fav&quot;</span>, <span class="dt">ignore_case =</span> T));</a>
<a class="sourceLine" id="cb36-140" title="140"></a>
<a class="sourceLine" id="cb36-141" title="141">data[</a>
<a class="sourceLine" id="cb36-142" title="142"><span class="kw">str_which</span>(data<span class="op">$</span>product,</a>
<a class="sourceLine" id="cb36-143" title="143"><span class="kw">regex</span>(<span class="st">&quot;hypothetical</span><span class="ch">\\</span><span class="st">s+protein&quot;</span>, <span class="dt">ignore_case =</span> T)),</a>
<a class="sourceLine" id="cb36-144" title="144">]</a>
<a class="sourceLine" id="cb36-145" title="145"></a>
<a class="sourceLine" id="cb36-146" title="146"><span class="co"># equivalent of grepl</span></a>
<a class="sourceLine" id="cb36-147" title="147"></a>
<a class="sourceLine" id="cb36-148" title="148"><span class="kw">str_detect</span>(f, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">w+ou</span><span class="ch">\\</span><span class="st">w+&quot;</span>);</a>
<a class="sourceLine" id="cb36-149" title="149"></a>
<a class="sourceLine" id="cb36-150" title="150">data[</a>
<a class="sourceLine" id="cb36-151" title="151"><span class="op">!</span><span class="kw">str_detect</span>(data<span class="op">$</span>product,</a>
<a class="sourceLine" id="cb36-152" title="152"><span class="kw">regex</span>(<span class="st">&quot;hypothetical</span><span class="ch">\\</span><span class="st">s+protein&quot;</span>, <span class="dt">ignore_case =</span> T)),</a>
<a class="sourceLine" id="cb36-153" title="153">]</a>
<a class="sourceLine" id="cb36-154" title="154"></a>
<a class="sourceLine" id="cb36-155" title="155"><span class="co"># Equivalent of grep(..., value = T);</span></a>
<a class="sourceLine" id="cb36-156" title="156"></a>
<a class="sourceLine" id="cb36-157" title="157"><span class="kw">str_subset</span>(f, <span class="st">&quot;</span><span class="ch">\\</span><span class="st">s{2,}&quot;</span>);</a>
<a class="sourceLine" id="cb36-158" title="158"></a>
<a class="sourceLine" id="cb36-159" title="159"><span class="co"># Equivalent of gsub</span></a>
<a class="sourceLine" id="cb36-160" title="160"></a>
<a class="sourceLine" id="cb36-161" title="161">fixed &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(f, <span class="st">&quot; {2,}&quot;</span>, <span class="st">&quot; &quot;</span>);</a>
<a class="sourceLine" id="cb36-162" title="162">fixed &lt;-<span class="st"> </span><span class="kw">str_replace_all</span>(fixed, <span class="st">&quot;vori&quot;</span>, <span class="st">&quot;vouri&quot;</span>);</a>
<a class="sourceLine" id="cb36-163" title="163"></a></code></pre></div>
<!-- >>> -->
<!-- <<< apply.r -->
<h1 id="apply">Apply</h1>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="co">######################</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="co">### apply() et al. </span><span class="al">###</span></a>
<a class="sourceLine" id="cb37-4" title="4"><span class="co">######################</span></a>
<a class="sourceLine" id="cb37-5" title="5"></a>
<a class="sourceLine" id="cb37-6" title="6"><span class="co">### apply() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb37-7" title="7"></a>
<a class="sourceLine" id="cb37-8" title="8"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb37-9" title="9"></a>
<a class="sourceLine" id="cb37-10" title="10"><span class="co"># Make a matrix</span></a>
<a class="sourceLine" id="cb37-11" title="11"></a>
<a class="sourceLine" id="cb37-12" title="12"><span class="kw">set.seed</span>(<span class="dv">20230201</span>); <span class="co"># So that we have the same random numbers.</span></a>
<a class="sourceLine" id="cb37-13" title="13">x &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">60</span>, <span class="dt">min =</span> <span class="dv">20</span>, <span class="dt">max =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb37-14" title="14"><span class="kw">dim</span>(x) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">15</span>, <span class="dv">4</span>);</a>
<a class="sourceLine" id="cb37-15" title="15">x</a>
<a class="sourceLine" id="cb37-16" title="16"></a>
<a class="sourceLine" id="cb37-17" title="17">d &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(x);</a>
<a class="sourceLine" id="cb37-18" title="18">d</a>
<a class="sourceLine" id="cb37-19" title="19"></a>
<a class="sourceLine" id="cb37-20" title="20"></a>
<a class="sourceLine" id="cb37-21" title="21"><span class="co"># Define a function to be applied later.</span></a>
<a class="sourceLine" id="cb37-22" title="22"></a>
<a class="sourceLine" id="cb37-23" title="23">apfun &lt;-<span class="st"> </span><span class="cf">function</span>(arg1) {</a>
<a class="sourceLine" id="cb37-24" title="24"><span class="kw">return</span>(arg1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(arg1));</a>
<a class="sourceLine" id="cb37-25" title="25">}</a>
<a class="sourceLine" id="cb37-26" title="26"></a>
<a class="sourceLine" id="cb37-27" title="27"><span class="co"># Apply the function to each row of x</span></a>
<a class="sourceLine" id="cb37-28" title="28"></a>
<a class="sourceLine" id="cb37-29" title="29"><span class="kw">apply</span>(x, <span class="dv">1</span>, apfun);</a>
<a class="sourceLine" id="cb37-30" title="30"><span class="kw">apply</span>(d, <span class="dv">1</span>, apfun);</a>
<a class="sourceLine" id="cb37-31" title="31"></a>
<a class="sourceLine" id="cb37-32" title="32"><span class="co"># Each application results in a column in the returned matrix.</span></a>
<a class="sourceLine" id="cb37-33" title="33"><span class="co"># Hence the transpose below.</span></a>
<a class="sourceLine" id="cb37-34" title="34"></a>
<a class="sourceLine" id="cb37-35" title="35"><span class="kw">t</span>(<span class="kw">apply</span>(x, <span class="dv">1</span>, apfun));</a>
<a class="sourceLine" id="cb37-36" title="36"><span class="kw">t</span>(<span class="kw">apply</span>(d, <span class="dv">1</span>, apfun));</a>
<a class="sourceLine" id="cb37-37" title="37"></a>
<a class="sourceLine" id="cb37-38" title="38"><span class="co"># Apply the function to each column of x</span></a>
<a class="sourceLine" id="cb37-39" title="39"></a>
<a class="sourceLine" id="cb37-40" title="40"><span class="kw">apply</span>(x, <span class="dv">2</span>, apfun);</a>
<a class="sourceLine" id="cb37-41" title="41"><span class="kw">apply</span>(d, <span class="dv">2</span>, apfun);</a>
<a class="sourceLine" id="cb37-42" title="42"></a>
<a class="sourceLine" id="cb37-43" title="43"><span class="co"># You still get one column per application.</span></a>
<a class="sourceLine" id="cb37-44" title="44"></a>
<a class="sourceLine" id="cb37-45" title="45"><span class="co"># If each application returns a single value then</span></a>
<a class="sourceLine" id="cb37-46" title="46"></a>
<a class="sourceLine" id="cb37-47" title="47"><span class="co"># The option simplify is TRUE by default.</span></a>
<a class="sourceLine" id="cb37-48" title="48"></a>
<a class="sourceLine" id="cb37-49" title="49"><span class="kw">apply</span>(x, <span class="dv">2</span>, <span class="dt">FUN =</span> apfun, <span class="dt">simplify =</span> T);</a>
<a class="sourceLine" id="cb37-50" title="50"></a>
<a class="sourceLine" id="cb37-51" title="51"><span class="co"># Below gives a list with one element for each application</span></a>
<a class="sourceLine" id="cb37-52" title="52"><span class="co"># of FUN</span></a>
<a class="sourceLine" id="cb37-53" title="53"><span class="kw">apply</span>(x, <span class="dv">2</span>, <span class="dt">FUN =</span> apfun, <span class="dt">simplify =</span> F);</a>
<a class="sourceLine" id="cb37-54" title="54"></a>
<a class="sourceLine" id="cb37-55" title="55"></a>
<a class="sourceLine" id="cb37-56" title="56"><span class="co">### lapply() and sapply() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb37-57" title="57"><span class="co"># Apply a function over a List or a Vector.</span></a>
<a class="sourceLine" id="cb37-58" title="58"><span class="co"># sapply() tries to simplify the return value to a vector or</span></a>
<a class="sourceLine" id="cb37-59" title="59"><span class="co"># matrix.</span></a>
<a class="sourceLine" id="cb37-60" title="60"></a>
<a class="sourceLine" id="cb37-61" title="61"><span class="kw">lapply</span>(x, apfun) <span class="co"># Matrices are vectors with dimensions!</span></a>
<a class="sourceLine" id="cb37-62" title="62"><span class="kw">sapply</span>(x, apfun) <span class="co"># Matrices are vectors with dimensions!</span></a>
<a class="sourceLine" id="cb37-63" title="63"></a>
<a class="sourceLine" id="cb37-64" title="64"><span class="co"># Data frames are lists of columns.</span></a>
<a class="sourceLine" id="cb37-65" title="65"><span class="kw">lapply</span>(d, apfun)</a>
<a class="sourceLine" id="cb37-66" title="66"><span class="kw">sapply</span>(d, apfun) <span class="co"># Same as apply(d, 2, apfun);</span></a>
<a class="sourceLine" id="cb37-67" title="67"></a>
<a class="sourceLine" id="cb37-68" title="68"><span class="kw">lapply</span>(d, mean)</a>
<a class="sourceLine" id="cb37-69" title="69"><span class="kw">sapply</span>(d, mean)</a>
<a class="sourceLine" id="cb37-70" title="70"></a>
<a class="sourceLine" id="cb37-71" title="71"><span class="co">### tapply() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb37-72" title="72"></a>
<a class="sourceLine" id="cb37-73" title="73"><span class="co"># We saw this when doing Factors.</span></a>
<a class="sourceLine" id="cb37-74" title="74"></a>
<a class="sourceLine" id="cb37-75" title="75">hwt &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/hw.csv&quot;</span>);</a>
<a class="sourceLine" id="cb37-76" title="76"></a>
<a class="sourceLine" id="cb37-77" title="77"><span class="kw">tapply</span>(hwt<span class="op">$</span>hw, hwt<span class="op">$</span>strain, mean);</a>
<a class="sourceLine" id="cb37-78" title="78"><span class="kw">tapply</span>(hwt<span class="op">$</span>hw, hwt<span class="op">$</span>strain, sd);</a>
<a class="sourceLine" id="cb37-79" title="79"><span class="kw">tapply</span>(hwt<span class="op">$</span>hw, hwt[, <span class="kw">c</span>(<span class="st">&quot;strain&quot;</span>, <span class="st">&quot;microscope&quot;</span>)], mean);</a>
<a class="sourceLine" id="cb37-80" title="80"></a>
<a class="sourceLine" id="cb37-81" title="81"><span class="co">### aggregate() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb37-82" title="82"></a>
<a class="sourceLine" id="cb37-83" title="83"><span class="kw">aggregate</span>(hwt<span class="op">$</span>hw, <span class="dt">by =</span> <span class="kw">list</span>(hwt<span class="op">$</span>microscope, hwt<span class="op">$</span>strain),</a>
<a class="sourceLine" id="cb37-84" title="84"><span class="dt">FUN =</span> mean);</a>
<a class="sourceLine" id="cb37-85" title="85"></a>
<a class="sourceLine" id="cb37-86" title="86"><span class="co"># There are NAs in the microscope column.</span></a>
<a class="sourceLine" id="cb37-87" title="87"><span class="kw">print</span>(hwt[<span class="dv">49</span><span class="op">:</span><span class="dv">60</span>,], <span class="dt">n =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb37-88" title="88"></a>
<a class="sourceLine" id="cb37-89" title="89">x &lt;-<span class="st"> </span>hwt<span class="op">$</span>microscope</a>
<a class="sourceLine" id="cb37-90" title="90">x[<span class="kw">is.na</span>(x)] &lt;-<span class="st"> &quot;U&quot;</span>;</a>
<a class="sourceLine" id="cb37-91" title="91">hwt &lt;-<span class="st"> </span>hwt <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">microscope =</span> x)</a>
<a class="sourceLine" id="cb37-92" title="92"><span class="kw">print</span>(hwt[<span class="dv">49</span><span class="op">:</span><span class="dv">60</span>,], <span class="dt">n =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb37-93" title="93"></a>
<a class="sourceLine" id="cb37-94" title="94"><span class="kw">aggregate</span>(hwt<span class="op">$</span>hw, <span class="dt">by =</span> <span class="kw">list</span>(hwt<span class="op">$</span>microscope, hwt<span class="op">$</span>strain),</a>
<a class="sourceLine" id="cb37-95" title="95"><span class="dt">FUN =</span> mean);</a></code></pre></div>
<!-- >>> -->
<!-- <<< attach.r -->
<h1 id="attach">Attach</h1>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="co">### Attaching a data frame </span><span class="al">###</span></a>
<a class="sourceLine" id="cb38-4" title="4"><span class="co">##############################</span></a>
<a class="sourceLine" id="cb38-5" title="5"></a>
<a class="sourceLine" id="cb38-6" title="6"><span class="co"># It is a convenience feature allowing you to refer to</span></a>
<a class="sourceLine" id="cb38-7" title="7"><span class="co"># columns of data frames by their names only rather</span></a>
<a class="sourceLine" id="cb38-8" title="8"><span class="co"># than as df$colname</span></a>
<a class="sourceLine" id="cb38-9" title="9"></a>
<a class="sourceLine" id="cb38-10" title="10"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb38-11" title="11"></a>
<a class="sourceLine" id="cb38-12" title="12">control &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">100</span>);</a>
<a class="sourceLine" id="cb38-13" title="13"></a>
<a class="sourceLine" id="cb38-14" title="14">df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/expression.csv&quot;</span>, <span class="dt">row.names =</span> <span class="st">&quot;gene&quot;</span>);</a>
<a class="sourceLine" id="cb38-15" title="15"></a>
<a class="sourceLine" id="cb38-16" title="16"><span class="kw">head</span>(df);</a>
<a class="sourceLine" id="cb38-17" title="17"></a>
<a class="sourceLine" id="cb38-18" title="18"><span class="kw">attach</span>(df);    <span class="co"># Note the warning following this command.</span></a>
<a class="sourceLine" id="cb38-19" title="19"></a>
<a class="sourceLine" id="cb38-20" title="20"><span class="kw">head</span>(control);   <span class="co"># This control is not coming from the data frame df.</span></a>
<a class="sourceLine" id="cb38-21" title="21"></a>
<a class="sourceLine" id="cb38-22" title="22"><span class="kw">rm</span>(control);</a>
<a class="sourceLine" id="cb38-23" title="23"></a>
<a class="sourceLine" id="cb38-24" title="24"><span class="kw">head</span>(control);</a>
<a class="sourceLine" id="cb38-25" title="25"></a>
<a class="sourceLine" id="cb38-26" title="26"><span class="kw">search</span>()</a>
<a class="sourceLine" id="cb38-27" title="27"></a>
<a class="sourceLine" id="cb38-28" title="28"><span class="kw">detach</span>(df)</a>
<a class="sourceLine" id="cb38-29" title="29"></a>
<a class="sourceLine" id="cb38-30" title="30"><span class="kw">search</span>()</a></code></pre></div>
<!-- >>> -->
<!-- <<< rnaseq.r -->
<h1 id="rna-seq">RNA-seq</h1>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="co">###############</span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="co">### RNA-Seq </span><span class="al">###</span></a>
<a class="sourceLine" id="cb39-4" title="4"><span class="co">###############</span></a>
<a class="sourceLine" id="cb39-5" title="5"></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="co"># Use of the package edgeR to analyse RNASeq data</span></a>
<a class="sourceLine" id="cb39-7" title="7"></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="co"># edgeR is a Bioconductor package you can read about it</span></a>
<a class="sourceLine" id="cb39-9" title="9"><span class="co"># here</span></a>
<a class="sourceLine" id="cb39-10" title="10"><span class="co"># https://www.bioconductor.org/packages/release/bioc/html/edgeR.html</span></a>
<a class="sourceLine" id="cb39-11" title="11"><span class="co"># Start with the User Guide. You may have to read the</span></a>
<a class="sourceLine" id="cb39-12" title="12"><span class="co"># Reference Manual to do somethings.</span></a>
<a class="sourceLine" id="cb39-13" title="13"></a>
<a class="sourceLine" id="cb39-14" title="14"><span class="co"># Using these two it is possible to develop a sequence</span></a>
<a class="sourceLine" id="cb39-15" title="15"><span class="co"># of R commands which will do the analysis you desire on</span></a>
<a class="sourceLine" id="cb39-16" title="16"><span class="co"># the data you have. This is a general pattern in</span></a>
<a class="sourceLine" id="cb39-17" title="17"><span class="co"># Bioconductor packages.</span></a>
<a class="sourceLine" id="cb39-18" title="18"></a>
<a class="sourceLine" id="cb39-19" title="19"><span class="co">### The experiment </span><span class="al">###</span></a>
<a class="sourceLine" id="cb39-20" title="20"></a>
<a class="sourceLine" id="cb39-21" title="21"><span class="co"># Hfq is a small RNA binding protein originally</span></a>
<a class="sourceLine" id="cb39-22" title="22"><span class="co"># identified as the host factor essential for the</span></a>
<a class="sourceLine" id="cb39-23" title="23"><span class="co"># replication of the bacteriophage Qβ. Two biological</span></a>
<a class="sourceLine" id="cb39-24" title="24"><span class="co"># replicates each of the wild type and a Hfq deletion</span></a>
<a class="sourceLine" id="cb39-25" title="25"><span class="co"># mutant of a Pseudomonas strain STR25 were subjected to</span></a>
<a class="sourceLine" id="cb39-26" title="26"><span class="co"># RNA-Seq analysis.</span></a>
<a class="sourceLine" id="cb39-27" title="27"></a>
<a class="sourceLine" id="cb39-28" title="28"><span class="co"># Reads from the sequencer (in fastq files) were aligned</span></a>
<a class="sourceLine" id="cb39-29" title="29"><span class="co"># to the Pseudomonas genomic sequence using bowtie2 to</span></a>
<a class="sourceLine" id="cb39-30" title="30"><span class="co"># get SAM files.</span></a>
<a class="sourceLine" id="cb39-31" title="31"></a>
<a class="sourceLine" id="cb39-32" title="32"><span class="co"># bowtie2 --phred33 -x bwt2ndx/STR25 \</span></a>
<a class="sourceLine" id="cb39-33" title="33"><span class="co"># -I 100 -X 400 -p 12 --no-unal \</span></a>
<a class="sourceLine" id="cb39-34" title="34"><span class="co"># -1 rs1-R1.fastq -2 rs1-R2.fastq -S sam/rs1.sam \</span></a>
<a class="sourceLine" id="cb39-35" title="35"><span class="co"># 2&gt; &quot;bowtie2Reports/rs1.bwt2repo&quot;</span></a>
<a class="sourceLine" id="cb39-36" title="36"> </a>
<a class="sourceLine" id="cb39-37" title="37"><span class="co"># Then samtools was used to convert these SAM files to BAM files.</span></a>
<a class="sourceLine" id="cb39-38" title="38"> </a>
<a class="sourceLine" id="cb39-39" title="39"><span class="co"># samtools view -b -o bam/rs1.bam --threads 8 sam/rs1.sam</span></a>
<a class="sourceLine" id="cb39-40" title="40"> </a>
<a class="sourceLine" id="cb39-41" title="41"><span class="co"># Then, in R, the function featureCounts() of the</span></a>
<a class="sourceLine" id="cb39-42" title="42"><span class="co"># Rsubread package was used to get the counts of reads</span></a>
<a class="sourceLine" id="cb39-43" title="43"><span class="co"># overlapping each of the 6003 genes. These counts have</span></a>
<a class="sourceLine" id="cb39-44" title="44"><span class="co"># been saved in the files</span></a>
<a class="sourceLine" id="cb39-45" title="45"> </a>
<a class="sourceLine" id="cb39-46" title="46"><span class="co"># featureCounts/rs1</span></a>
<a class="sourceLine" id="cb39-47" title="47"><span class="co"># featureCounts/rs2</span></a>
<a class="sourceLine" id="cb39-48" title="48"><span class="co"># featureCounts/rs3</span></a>
<a class="sourceLine" id="cb39-49" title="49"><span class="co"># featureCounts/rs4</span></a>
<a class="sourceLine" id="cb39-50" title="50"></a>
<a class="sourceLine" id="cb39-51" title="51"><span class="co"># It is also possible to do the above using samtools</span></a>
<a class="sourceLine" id="cb39-52" title="52"><span class="co"># functions bedcov and depth. Another possibility is to</span></a>
<a class="sourceLine" id="cb39-53" title="53"><span class="co"># use tools in the Rsubread package to carry out the</span></a>
<a class="sourceLine" id="cb39-54" title="54"><span class="co"># alignment as well as feature counting. Anyhow, we have</span></a>
<a class="sourceLine" id="cb39-55" title="55"><span class="co"># to arrive at counts of reads covering each gene.</span></a>
<a class="sourceLine" id="cb39-56" title="56"> </a>
<a class="sourceLine" id="cb39-57" title="57"><span class="co"># This is where we will pick up this analysis now and</span></a>
<a class="sourceLine" id="cb39-58" title="58"><span class="co"># take it to completion ending in a table of log fold</span></a>
<a class="sourceLine" id="cb39-59" title="59"><span class="co"># changes for all the genes in the genome. We will use</span></a>
<a class="sourceLine" id="cb39-60" title="60"><span class="co"># functions provided in BioConductor package edgeR for</span></a>
<a class="sourceLine" id="cb39-61" title="61"><span class="co"># doing this.</span></a>
<a class="sourceLine" id="cb39-62" title="62"> </a>
<a class="sourceLine" id="cb39-63" title="63"><span class="co">### Analysis in R </span><span class="al">###</span></a>
<a class="sourceLine" id="cb39-64" title="64"></a>
<a class="sourceLine" id="cb39-65" title="65"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb39-66" title="66"><span class="kw">library</span>(<span class="st">&quot;edgeR&quot;</span>);</a>
<a class="sourceLine" id="cb39-67" title="67"></a>
<a class="sourceLine" id="cb39-68" title="68">fcpath =<span class="st"> &quot;data/featureCounts&quot;</span>;</a>
<a class="sourceLine" id="cb39-69" title="69"><span class="kw">list.files</span>(<span class="dt">path =</span> fcpath);</a>
<a class="sourceLine" id="cb39-70" title="70">files &lt;-<span class="st"> </span><span class="kw">list.files</span>(<span class="dt">path =</span> fcpath);</a>
<a class="sourceLine" id="cb39-71" title="71">files</a>
<a class="sourceLine" id="cb39-72" title="72"></a>
<a class="sourceLine" id="cb39-73" title="73"></a>
<a class="sourceLine" id="cb39-74" title="74"><span class="co"># use of rep() to make groups.</span></a>
<a class="sourceLine" id="cb39-75" title="75">temp &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;hfq&quot;</span>);</a>
<a class="sourceLine" id="cb39-76" title="76">groups &lt;-<span class="st"> </span><span class="kw">rep</span>(temp, <span class="dt">each =</span> <span class="dv">2</span>);</a>
<a class="sourceLine" id="cb39-77" title="77"></a>
<a class="sourceLine" id="cb39-78" title="78">fg &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">files =</span> files, <span class="dt">group =</span> <span class="kw">factor</span>(groups));</a>
<a class="sourceLine" id="cb39-79" title="79">fg;</a>
<a class="sourceLine" id="cb39-80" title="80"></a>
<a class="sourceLine" id="cb39-81" title="81"><span class="kw">levels</span>(fg<span class="op">$</span>group);</a>
<a class="sourceLine" id="cb39-82" title="82"></a>
<a class="sourceLine" id="cb39-83" title="83"><span class="co"># labels for each sample.</span></a>
<a class="sourceLine" id="cb39-84" title="84">lbs &lt;-<span class="st"> </span><span class="kw">paste0</span>(groups, <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>));</a>
<a class="sourceLine" id="cb39-85" title="85">lbs</a>
<a class="sourceLine" id="cb39-86" title="86"><span class="co"># Examine the values of fg and lbs at this stage</span></a>
<a class="sourceLine" id="cb39-87" title="87"><span class="co"># to make sure they are as you want them to be.</span></a>
<a class="sourceLine" id="cb39-88" title="88"></a>
<a class="sourceLine" id="cb39-89" title="89"><span class="co"># Now we are ready to read the data from the files into R.</span></a>
<a class="sourceLine" id="cb39-90" title="90"></a>
<a class="sourceLine" id="cb39-91" title="91">d &lt;-<span class="st"> </span><span class="kw">readDGE</span>(fg, <span class="dt">path =</span> fcpath, <span class="dt">labels =</span> lbs, <span class="dt">header =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb39-92" title="92"></a>
<a class="sourceLine" id="cb39-93" title="93"><span class="co">### Examine d here. What class does d belong to? </span><span class="al">###</span></a>
<a class="sourceLine" id="cb39-94" title="94">d</a>
<a class="sourceLine" id="cb39-95" title="95"><span class="kw">class</span>(d)</a>
<a class="sourceLine" id="cb39-96" title="96"><span class="kw">names</span>(d);</a>
<a class="sourceLine" id="cb39-97" title="97"></a>
<a class="sourceLine" id="cb39-98" title="98"><span class="co"># Saving individual objects</span></a>
<a class="sourceLine" id="cb39-99" title="99"><span class="kw">saveRDS</span>(d, <span class="dt">file =</span> <span class="st">&quot;after_readDGE.rds&quot;</span>);</a>
<a class="sourceLine" id="cb39-100" title="100"><span class="co"># d &lt;- readRDS(&quot;after_readDGE.rds&quot;);</span></a>
<a class="sourceLine" id="cb39-101" title="101"></a>
<a class="sourceLine" id="cb39-102" title="102"><span class="co"># Saving a list of objects.</span></a>
<a class="sourceLine" id="cb39-103" title="103"><span class="kw">save</span>(files, groups, fg, lbs, d, <span class="dt">file =</span> <span class="st">&quot;after_readDGE&quot;</span>)</a>
<a class="sourceLine" id="cb39-104" title="104"><span class="co"># load(&quot;after_readDGE&quot;);</span></a>
<a class="sourceLine" id="cb39-105" title="105"></a>
<a class="sourceLine" id="cb39-106" title="106"><span class="co"># Saving entire workspace.</span></a>
<a class="sourceLine" id="cb39-107" title="107"><span class="kw">save.image</span>(<span class="dt">file =</span> <span class="st">&quot;after_readDGE.image&quot;</span>)</a>
<a class="sourceLine" id="cb39-108" title="108"><span class="co"># load(&quot;after_readDGE.image&quot;);</span></a>
<a class="sourceLine" id="cb39-109" title="109"><span class="co"># In a new session of R, you will need to load the</span></a>
<a class="sourceLine" id="cb39-110" title="110"><span class="co"># required libraries again.</span></a>
<a class="sourceLine" id="cb39-111" title="111"></a>
<a class="sourceLine" id="cb39-112" title="112"><span class="co">### Add gene length information.</span></a>
<a class="sourceLine" id="cb39-113" title="113"></a>
<a class="sourceLine" id="cb39-114" title="114">gene.lens &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;data/str25.genelengths&quot;</span>,</a>
<a class="sourceLine" id="cb39-115" title="115">                      <span class="dt">stringsAsFactors =</span> F);</a>
<a class="sourceLine" id="cb39-116" title="116"></a>
<a class="sourceLine" id="cb39-117" title="117">d<span class="op">$</span>genes &lt;-<span class="st"> </span>gene.lens;</a>
<a class="sourceLine" id="cb39-118" title="118"></a>
<a class="sourceLine" id="cb39-119" title="119"><span class="kw">all.equal</span>(<span class="kw">rownames</span>(d<span class="op">$</span>counts), d<span class="op">$</span>genes<span class="op">$</span>gene)</a>
<a class="sourceLine" id="cb39-120" title="120"></a>
<a class="sourceLine" id="cb39-121" title="121"></a>
<a class="sourceLine" id="cb39-122" title="122"><span class="co">### Normalisation factors.</span></a>
<a class="sourceLine" id="cb39-123" title="123"></a>
<a class="sourceLine" id="cb39-124" title="124">d &lt;-<span class="st"> </span><span class="kw">calcNormFactors</span>(d);</a>
<a class="sourceLine" id="cb39-125" title="125"></a>
<a class="sourceLine" id="cb39-126" title="126"><span class="co"># Drawing of the design matrix</span></a>
<a class="sourceLine" id="cb39-127" title="127"><span class="co">#            wt        hfq</span></a>
<a class="sourceLine" id="cb39-128" title="128"><span class="co"># wtA         1         0</span></a>
<a class="sourceLine" id="cb39-129" title="129"><span class="co"># wtB         1         0</span></a>
<a class="sourceLine" id="cb39-130" title="130"><span class="co"># hfqA        0         1</span></a>
<a class="sourceLine" id="cb39-131" title="131"><span class="co"># hfqB        0         1</span></a>
<a class="sourceLine" id="cb39-132" title="132"></a>
<a class="sourceLine" id="cb39-133" title="133"><span class="co"># Make the design matrix. Alternative 1.</span></a>
<a class="sourceLine" id="cb39-134" title="134">dm =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">4</span>);</a>
<a class="sourceLine" id="cb39-135" title="135"><span class="kw">rownames</span>(dm) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;wtA&quot;</span>, <span class="st">&quot;wtB&quot;</span>, <span class="st">&quot;hfqA&quot;</span>, <span class="st">&quot;hfqB&quot;</span>);</a>
<a class="sourceLine" id="cb39-136" title="136"><span class="kw">colnames</span>(dm) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;hfq&quot;</span>);</a>
<a class="sourceLine" id="cb39-137" title="137">dm</a>
<a class="sourceLine" id="cb39-138" title="138"></a>
<a class="sourceLine" id="cb39-139" title="139"><span class="co"># Make the design matrix. Alternative 2.</span></a>
<a class="sourceLine" id="cb39-140" title="140">des &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="dv">0</span><span class="op">+</span>fg<span class="op">$</span>group)</a>
<a class="sourceLine" id="cb39-141" title="141">des</a>
<a class="sourceLine" id="cb39-142" title="142"><span class="kw">rownames</span>(des) &lt;-<span class="st"> </span>lbs;</a>
<a class="sourceLine" id="cb39-143" title="143"><span class="kw">colnames</span>(des) &lt;-<span class="st"> </span><span class="kw">levels</span>(fg<span class="op">$</span>group);</a>
<a class="sourceLine" id="cb39-144" title="144">des</a>
<a class="sourceLine" id="cb39-145" title="145"></a>
<a class="sourceLine" id="cb39-146" title="146"></a>
<a class="sourceLine" id="cb39-147" title="147"><span class="kw">names</span>(d);</a>
<a class="sourceLine" id="cb39-148" title="148">d &lt;-<span class="st"> </span><span class="kw">estimateDisp</span>(d, <span class="dt">design =</span> des);</a>
<a class="sourceLine" id="cb39-149" title="149"><span class="kw">names</span>(d)</a>
<a class="sourceLine" id="cb39-150" title="150"></a>
<a class="sourceLine" id="cb39-151" title="151"></a>
<a class="sourceLine" id="cb39-152" title="152"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb39-153" title="153"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb39-154" title="154"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb39-155" title="155"></a>
<a class="sourceLine" id="cb39-156" title="156"><span class="co"># 1. Examine the output of methods(class = class(d))</span></a>
<a class="sourceLine" id="cb39-157" title="157"></a>
<a class="sourceLine" id="cb39-158" title="158"><span class="co"># 2. Amongst a lot of other things, the above will show</span></a>
<a class="sourceLine" id="cb39-159" title="159"><span class="co"># you a method named rpkm().</span></a>
<a class="sourceLine" id="cb39-160" title="160"></a>
<a class="sourceLine" id="cb39-161" title="161"><span class="co"># 3. Have a look at the help for rpkm().</span></a>
<a class="sourceLine" id="cb39-162" title="162"></a>
<a class="sourceLine" id="cb39-163" title="163"><span class="co"># 4. Now use rpkmByGroup() to get the RPKMs and store them</span></a>
<a class="sourceLine" id="cb39-164" title="164"><span class="co"># in wt.hfq.rpkm.</span></a>
<a class="sourceLine" id="cb39-165" title="165"></a>
<a class="sourceLine" id="cb39-166" title="166"><span class="co"># 5.  Examine the top of wt.hfq.rpkm using head().</span></a>
<a class="sourceLine" id="cb39-167" title="167"></a>
<a class="sourceLine" id="cb39-168" title="168"><span class="co"># 6. write.csv(wt.hfq.rpkm, file =</span></a>
<a class="sourceLine" id="cb39-169" title="169"><span class="co"># &quot;../wt_hfq_RPKM.csv&quot;)</span></a>
<a class="sourceLine" id="cb39-170" title="170"></a>
<a class="sourceLine" id="cb39-171" title="171"></a>
<a class="sourceLine" id="cb39-172" title="172"><span class="co">###############################</span></a>
<a class="sourceLine" id="cb39-173" title="173"><span class="co">### Differential Expression </span><span class="al">###</span></a>
<a class="sourceLine" id="cb39-174" title="174"><span class="co">###############################</span></a>
<a class="sourceLine" id="cb39-175" title="175"></a>
<a class="sourceLine" id="cb39-176" title="176"><span class="co"># The object d made above has all the data required to</span></a>
<a class="sourceLine" id="cb39-177" title="177"><span class="co"># determine which genes are differentially expressed</span></a>
<a class="sourceLine" id="cb39-178" title="178"><span class="co"># between the WT and Hfq, to what extent and in which</span></a>
<a class="sourceLine" id="cb39-179" title="179"><span class="co"># direction.</span></a>
<a class="sourceLine" id="cb39-180" title="180"></a>
<a class="sourceLine" id="cb39-181" title="181"><span class="co"># Use of exactTest() and topTags()</span></a>
<a class="sourceLine" id="cb39-182" title="182"></a>
<a class="sourceLine" id="cb39-183" title="183">et &lt;-<span class="st"> </span><span class="kw">exactTest</span>(d, <span class="dt">pair =</span> <span class="kw">c</span>(<span class="st">&quot;wt&quot;</span>, <span class="st">&quot;hfq&quot;</span>));</a>
<a class="sourceLine" id="cb39-184" title="184"></a>
<a class="sourceLine" id="cb39-185" title="185">byFC &lt;-<span class="st"> </span><span class="kw">topTags</span>(et, <span class="dt">sort.by =</span> <span class="st">&quot;logFC&quot;</span>);</a>
<a class="sourceLine" id="cb39-186" title="186">byFC;</a>
<a class="sourceLine" id="cb39-187" title="187"></a>
<a class="sourceLine" id="cb39-188" title="188">unsorted_lfc &lt;-<span class="st"> </span><span class="kw">topTags</span>(et, <span class="dt">sort.by =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">n =</span> <span class="kw">nrow</span>(d));</a>
<a class="sourceLine" id="cb39-189" title="189"><span class="kw">saveRDS</span>(unsorted_lfc<span class="op">$</span>table, <span class="st">&quot;unsorted_lfc.rds&quot;</span>)</a>
<a class="sourceLine" id="cb39-190" title="190"></a>
<a class="sourceLine" id="cb39-191" title="191">byPV &lt;-<span class="st"> </span><span class="kw">topTags</span>(et, <span class="dt">n =</span> <span class="kw">nrow</span>(d), <span class="dt">sort.by =</span> <span class="st">&quot;PValue&quot;</span>);</a>
<a class="sourceLine" id="cb39-192" title="192"><span class="kw">write.csv</span>(byPV, <span class="dt">file =</span> <span class="st">&quot;../wt_hfq_DE.csv&quot;</span>, <span class="dt">row.names =</span> F);</a>
<a class="sourceLine" id="cb39-193" title="193"></a>
<a class="sourceLine" id="cb39-194" title="194"><span class="co"># head(byPV); # Fails.</span></a>
<a class="sourceLine" id="cb39-195" title="195"></a>
<a class="sourceLine" id="cb39-196" title="196"><span class="kw">class</span>(byPV);</a>
<a class="sourceLine" id="cb39-197" title="197"><span class="kw">names</span>(byPV);</a>
<a class="sourceLine" id="cb39-198" title="198"></a>
<a class="sourceLine" id="cb39-199" title="199"><span class="kw">class</span>(byPV<span class="op">$</span>table);</a>
<a class="sourceLine" id="cb39-200" title="200"></a>
<a class="sourceLine" id="cb39-201" title="201"><span class="kw">head</span>(byPV<span class="op">$</span>table);</a>
<a class="sourceLine" id="cb39-202" title="202"></a>
<a class="sourceLine" id="cb39-203" title="203">de.table &lt;-<span class="st"> </span>byPV<span class="op">$</span>table</a>
<a class="sourceLine" id="cb39-204" title="204"></a>
<a class="sourceLine" id="cb39-205" title="205"><span class="co"># Hfq is SS_0520 and it has been deleted in the strain</span></a>
<a class="sourceLine" id="cb39-206" title="206"><span class="co"># we are referring to as hfq. So it should be</span></a>
<a class="sourceLine" id="cb39-207" title="207"><span class="co"># significantly down-regulated.</span></a>
<a class="sourceLine" id="cb39-208" title="208"></a>
<a class="sourceLine" id="cb39-209" title="209">de.table[<span class="st">&quot;SS_0520&quot;</span>,];</a>
<a class="sourceLine" id="cb39-210" title="210"></a>
<a class="sourceLine" id="cb39-211" title="211"></a>
<a class="sourceLine" id="cb39-212" title="212"><span class="co"># Collecting the RPKMs of the most highly changed genes</span></a>
<a class="sourceLine" id="cb39-213" title="213"> </a>
<a class="sourceLine" id="cb39-214" title="214"><span class="co"># &quot;wt.hfq.rpkm&quot; is a matrix. &quot;de.table&quot; is a data frame.</span></a>
<a class="sourceLine" id="cb39-215" title="215"><span class="co"># &quot;de.table&quot; is ordered such that the most significantly</span></a>
<a class="sourceLine" id="cb39-216" title="216"><span class="co"># changed genes are at the top.</span></a>
<a class="sourceLine" id="cb39-217" title="217"> </a>
<a class="sourceLine" id="cb39-218" title="218"><span class="co"># How will you get the RPKMs of the 30 most</span></a>
<a class="sourceLine" id="cb39-219" title="219"><span class="co"># significantly changed genes?</span></a>
<a class="sourceLine" id="cb39-220" title="220"> </a>
<a class="sourceLine" id="cb39-221" title="221"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb39-222" title="222"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb39-223" title="223"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb39-224" title="224"></a>
<a class="sourceLine" id="cb39-225" title="225"><span class="co"># 1. From de.table get a vector v, of the first 30 row</span></a>
<a class="sourceLine" id="cb39-226" title="226"><span class="co"># names.</span></a>
<a class="sourceLine" id="cb39-227" title="227"></a>
<a class="sourceLine" id="cb39-228" title="228"><span class="co"># 2. Create top30.rpkm by subscripting wt.hfq.rpkm to</span></a>
<a class="sourceLine" id="cb39-229" title="229"><span class="co"># get the rows in vector v made above and all columns.</span></a>
<a class="sourceLine" id="cb39-230" title="230"></a>
<a class="sourceLine" id="cb39-231" title="231"><span class="co">#####################################</span></a>
<a class="sourceLine" id="cb39-232" title="232"><span class="co">### Why use log2 for fold change? </span><span class="al">###</span></a>
<a class="sourceLine" id="cb39-233" title="233"><span class="co">#####################################</span></a>
<a class="sourceLine" id="cb39-234" title="234"></a>
<a class="sourceLine" id="cb39-235" title="235"><span class="co"># Linear scale is asymmetric.</span></a>
<a class="sourceLine" id="cb39-236" title="236"></a>
<a class="sourceLine" id="cb39-237" title="237"><span class="co"># Two fold up-regulation is 2</span></a>
<a class="sourceLine" id="cb39-238" title="238"></a>
<a class="sourceLine" id="cb39-239" title="239"><span class="co"># Two fold down-regulation is 0.5</span></a>
<a class="sourceLine" id="cb39-240" title="240"></a>
<a class="sourceLine" id="cb39-241" title="241"><span class="co"># So the entire down-regulation side is squeezed between</span></a>
<a class="sourceLine" id="cb39-242" title="242"><span class="co"># 0 and 1.</span></a>
<a class="sourceLine" id="cb39-243" title="243"></a>
<a class="sourceLine" id="cb39-244" title="244"><span class="kw">plot</span>(de.table<span class="op">$</span>logFC, <span class="dt">pch =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb39-245" title="245"><span class="kw">plot</span>(<span class="dv">2</span><span class="op">**</span>(de.table<span class="op">$</span>logFC), <span class="dt">pch =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb39-246" title="246"></a>
<a class="sourceLine" id="cb39-247" title="247">lfc &lt;-<span class="st"> </span><span class="kw">sample</span>(de.table<span class="op">$</span>logFC, <span class="kw">length</span>(de.table<span class="op">$</span>logFC));</a>
<a class="sourceLine" id="cb39-248" title="248"><span class="kw">plot</span>(lfc, <span class="dt">pch =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb39-249" title="249"><span class="kw">plot</span>(<span class="dv">2</span><span class="op">**</span>(lfc), <span class="dt">pch =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb39-250" title="250"></a>
<a class="sourceLine" id="cb39-251" title="251"><span class="co"># Table of linear to log2 values.</span></a>
<a class="sourceLine" id="cb39-252" title="252">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">16</span>), <span class="kw">seq</span>(<span class="dv">20</span>, <span class="dv">200</span>, <span class="dt">by =</span> <span class="dv">20</span>), <span class="dv">500</span>, <span class="dv">1000</span>);</a>
<a class="sourceLine" id="cb39-253" title="253">lx &lt;-<span class="st"> </span><span class="kw">log2</span>(x);</a>
<a class="sourceLine" id="cb39-254" title="254">lin2log &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x, <span class="dt">log2.x =</span> lx)</a>
<a class="sourceLine" id="cb39-255" title="255">lin2log</a>
<a class="sourceLine" id="cb39-256" title="256"></a>
<a class="sourceLine" id="cb39-257" title="257"><span class="co"># Table of log2 to linear values</span></a>
<a class="sourceLine" id="cb39-258" title="258">log2lin &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">log2.x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">0.5</span>),</a>
<a class="sourceLine" id="cb39-259" title="259">                      <span class="dt">x =</span> <span class="dv">2</span><span class="op">**</span>(<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb39-260" title="260">                      );</a>
<a class="sourceLine" id="cb39-261" title="261">log2lin</a>
<a class="sourceLine" id="cb39-262" title="262"></a>
<a class="sourceLine" id="cb39-263" title="263"></a>
<a class="sourceLine" id="cb39-264" title="264"><span class="co"># Keep the following in mind when working with logFC and</span></a>
<a class="sourceLine" id="cb39-265" title="265"><span class="co"># linearFC.</span></a>
<a class="sourceLine" id="cb39-266" title="266"></a>
<a class="sourceLine" id="cb39-267" title="267"><span class="co"># 1. You cannot take the log of a negative number.</span></a>
<a class="sourceLine" id="cb39-268" title="268"></a>
<a class="sourceLine" id="cb39-269" title="269"><span class="co"># 2. Log of (positive) numbers less than 1 is negative.</span></a>
<a class="sourceLine" id="cb39-270" title="270"></a>
<a class="sourceLine" id="cb39-271" title="271"><span class="co"># 3. Log of 1 is zero.</span></a>
<a class="sourceLine" id="cb39-272" title="272"></a>
<a class="sourceLine" id="cb39-273" title="273"><span class="co"># 4. Log of zero is -Inf.</span></a>
<a class="sourceLine" id="cb39-274" title="274"></a>
<a class="sourceLine" id="cb39-275" title="275"><span class="co"># 5. Raise the base (2) to the logFC value to get the linear</span></a>
<a class="sourceLine" id="cb39-276" title="276"><span class="co"># fold change.</span></a>
<a class="sourceLine" id="cb39-277" title="277"></a>
<a class="sourceLine" id="cb39-278" title="278"></a></code></pre></div>
<!-- >>> -->
<!-- <<< devices.r -->
<h1 id="plotting-devices">Plotting devices</h1>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="co">########################</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="co">### Plotting devices </span><span class="al">###</span></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="co">########################</span></a>
<a class="sourceLine" id="cb40-5" title="5"></a>
<a class="sourceLine" id="cb40-6" title="6"><span class="co">### Plotting Devices </span><span class="al">###</span></a>
<a class="sourceLine" id="cb40-7" title="7"></a>
<a class="sourceLine" id="cb40-8" title="8"><span class="co"># Plotting functions such as plot() draw to a plotting</span></a>
<a class="sourceLine" id="cb40-9" title="9"><span class="co"># device.</span></a>
<a class="sourceLine" id="cb40-10" title="10"></a>
<a class="sourceLine" id="cb40-11" title="11"><span class="co"># If no plotting device(s) exists then one of the</span></a>
<a class="sourceLine" id="cb40-12" title="12"><span class="co"># default type is created.</span></a>
<a class="sourceLine" id="cb40-13" title="13"></a>
<a class="sourceLine" id="cb40-14" title="14"><span class="co"># Devices are identified by numbers.</span></a>
<a class="sourceLine" id="cb40-15" title="15"></a>
<a class="sourceLine" id="cb40-16" title="16"><span class="co"># At any time you have only one active plotting device</span></a>
<a class="sourceLine" id="cb40-17" title="17"><span class="co"># although more may be in existence.</span></a>
<a class="sourceLine" id="cb40-18" title="18"></a>
<a class="sourceLine" id="cb40-19" title="19"><span class="co"># dev.* functions control plotting devices.</span></a>
<a class="sourceLine" id="cb40-20" title="20"></a>
<a class="sourceLine" id="cb40-21" title="21"><span class="co"># e.g. dev.new() will give you a new plotting device of</span></a>
<a class="sourceLine" id="cb40-22" title="22"><span class="co"># the default type.</span></a>
<a class="sourceLine" id="cb40-23" title="23"></a>
<a class="sourceLine" id="cb40-24" title="24"><span class="co"># e.g. dev.set() is called with an argument which is the</span></a>
<a class="sourceLine" id="cb40-25" title="25"><span class="co"># device number you wish to make active.</span></a>
<a class="sourceLine" id="cb40-26" title="26"></a>
<a class="sourceLine" id="cb40-27" title="27"><span class="co"># You can use windows() to get a plotting device for</span></a>
<a class="sourceLine" id="cb40-28" title="28"><span class="co"># your current display. On Linux this command is x11()</span></a>
<a class="sourceLine" id="cb40-29" title="29"><span class="co"># and on OSX it is quartz().</span></a>
<a class="sourceLine" id="cb40-30" title="30"></a>
<a class="sourceLine" id="cb40-31" title="31"><span class="co"># dev.off() can be used to close any plotting device. If</span></a>
<a class="sourceLine" id="cb40-32" title="32"><span class="co"># no argument is given, the active plotting device is</span></a>
<a class="sourceLine" id="cb40-33" title="33"><span class="co"># closed.</span></a>
<a class="sourceLine" id="cb40-34" title="34"></a>
<a class="sourceLine" id="cb40-35" title="35"><span class="co"># graphics.off() is used to close all plotting devices.</span></a>
<a class="sourceLine" id="cb40-36" title="36"></a>
<a class="sourceLine" id="cb40-37" title="37"><span class="co"># It is important to close devices if they are connected</span></a>
<a class="sourceLine" id="cb40-38" title="38"><span class="co"># to a file such as a png or a jpeg file.</span></a>
<a class="sourceLine" id="cb40-39" title="39"></a>
<a class="sourceLine" id="cb40-40" title="40"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb40-41" title="41"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb40-42" title="42"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb40-43" title="43"></a>
<a class="sourceLine" id="cb40-44" title="44"><span class="co"># 1. x &lt;- seq(1, 1e4, by = 5)</span></a>
<a class="sourceLine" id="cb40-45" title="45"></a>
<a class="sourceLine" id="cb40-46" title="46"><span class="co"># 2. y &lt;- log10(x)</span></a>
<a class="sourceLine" id="cb40-47" title="47"></a>
<a class="sourceLine" id="cb40-48" title="48"><span class="co"># 3. Get a new plotting device by using dev.new()</span></a>
<a class="sourceLine" id="cb40-49" title="49"></a>
<a class="sourceLine" id="cb40-50" title="50"><span class="co"># 4. Get a new plotting device by using windows()</span></a>
<a class="sourceLine" id="cb40-51" title="51"></a>
<a class="sourceLine" id="cb40-52" title="52"><span class="co"># 5. Examine the output of dev.list()</span></a>
<a class="sourceLine" id="cb40-53" title="53"></a>
<a class="sourceLine" id="cb40-54" title="54"><span class="co"># 6. plot(x,y)</span></a>
<a class="sourceLine" id="cb40-55" title="55"></a>
<a class="sourceLine" id="cb40-56" title="56"><span class="co"># 7. Use dev.set() to make the other plotting device</span></a>
<a class="sourceLine" id="cb40-57" title="57"><span class="co"># active.</span></a>
<a class="sourceLine" id="cb40-58" title="58"></a>
<a class="sourceLine" id="cb40-59" title="59"><span class="co"># 8. Again, plot(x,y)</span></a>
<a class="sourceLine" id="cb40-60" title="60"></a>
<a class="sourceLine" id="cb40-61" title="61"><span class="co"># 9. Use dev.off() to close the active device.</span></a>
<a class="sourceLine" id="cb40-62" title="62"></a>
<a class="sourceLine" id="cb40-63" title="63"><span class="co"># 10. Use graphics.off() to close all plotting devices.</span></a>
<a class="sourceLine" id="cb40-64" title="64"></a>
<a class="sourceLine" id="cb40-65" title="65"></a></code></pre></div>
<!-- >>> -->
<!-- <<< graphics.r -->
<h1 id="base-graphics">Base graphics</h1>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="co">#####################</span></a>
<a class="sourceLine" id="cb41-3" title="3"><span class="co">### Base graphics </span><span class="al">###</span></a>
<a class="sourceLine" id="cb41-4" title="4"><span class="co">#####################</span></a>
<a class="sourceLine" id="cb41-5" title="5"></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="co"># Several commands, plot(), boxplot(), points(), lines(),</span></a>
<a class="sourceLine" id="cb41-7" title="7"><span class="co"># abline() and several others.</span></a>
<a class="sourceLine" id="cb41-8" title="8"></a>
<a class="sourceLine" id="cb41-9" title="9"><span class="co"># plot() is usually the starting function call.</span></a>
<a class="sourceLine" id="cb41-10" title="10"></a>
<a class="sourceLine" id="cb41-11" title="11"><span class="co"># points(), lines(), abline() etc. can add to the plot</span></a>
<a class="sourceLine" id="cb41-12" title="12"><span class="co"># initially made by plot.</span></a>
<a class="sourceLine" id="cb41-13" title="13"></a>
<a class="sourceLine" id="cb41-14" title="14"><span class="co"># plot() can behave differently depending upon what</span></a>
<a class="sourceLine" id="cb41-15" title="15"><span class="co"># arguments are passed to it.</span></a>
<a class="sourceLine" id="cb41-16" title="16"></a>
<a class="sourceLine" id="cb41-17" title="17"><span class="kw">graphics.off</span>()</a>
<a class="sourceLine" id="cb41-18" title="18">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>, <span class="dt">mean  =</span> <span class="dv">20</span>, <span class="dt">sd =</span> <span class="dv">2</span>);</a>
<a class="sourceLine" id="cb41-19" title="19"><span class="kw">plot</span>(x);</a>
<a class="sourceLine" id="cb41-20" title="20"><span class="kw">boxplot</span>(x);</a>
<a class="sourceLine" id="cb41-21" title="21"></a>
<a class="sourceLine" id="cb41-22" title="22">m &lt;-<span class="st"> </span><span class="kw">matrix</span>(x, <span class="dt">nrow =</span> <span class="dv">200</span>, <span class="dt">ncol =</span> <span class="dv">5</span>);</a>
<a class="sourceLine" id="cb41-23" title="23"><span class="kw">plot</span>(m[,<span class="dv">1</span>], m[,<span class="dv">2</span>]); <span class="co"># same as plot(m);</span></a>
<a class="sourceLine" id="cb41-24" title="24"></a>
<a class="sourceLine" id="cb41-25" title="25"><span class="kw">plot</span>(m[,<span class="dv">1</span>], m[,<span class="dv">3</span>]);</a>
<a class="sourceLine" id="cb41-26" title="26"></a>
<a class="sourceLine" id="cb41-27" title="27"><span class="kw">boxplot</span>(m)</a>
<a class="sourceLine" id="cb41-28" title="28"></a></code></pre></div>
<!-- >>> -->
<!-- <<< par.r -->
<h1 id="plotting-parameters">Plotting parameters</h1>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb42-3" title="3"><span class="co">### Plotting parameters par() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb42-5" title="5"></a>
<a class="sourceLine" id="cb42-6" title="6"><span class="co"># e.g. colour, title, margins, plots per device, font</span></a>
<a class="sourceLine" id="cb42-7" title="7"><span class="co"># sizes, etc.</span></a>
<a class="sourceLine" id="cb42-8" title="8"></a>
<a class="sourceLine" id="cb42-9" title="9"><span class="co"># The function par() is used to set the plotting</span></a>
<a class="sourceLine" id="cb42-10" title="10"><span class="co"># parameters.</span></a>
<a class="sourceLine" id="cb42-11" title="11"></a>
<a class="sourceLine" id="cb42-12" title="12"><span class="co"># Calls to par() affect the active plotting device.</span></a>
<a class="sourceLine" id="cb42-13" title="13"></a>
<a class="sourceLine" id="cb42-14" title="14"><span class="co"># Calls to par() may be made before, in-between and</span></a>
<a class="sourceLine" id="cb42-15" title="15"><span class="co"># along with calls to plot(), points, lines() etc.</span></a>
<a class="sourceLine" id="cb42-16" title="16"></a>
<a class="sourceLine" id="cb42-17" title="17"><span class="co"># The changed parameters affect all subsequent commands</span></a>
<a class="sourceLine" id="cb42-18" title="18"><span class="co"># acting on the plot.</span></a>
<a class="sourceLine" id="cb42-19" title="19"></a>
<a class="sourceLine" id="cb42-20" title="20"><span class="co"># help(&quot;par&quot;) lists a lot of parameters that can be set</span></a>
<a class="sourceLine" id="cb42-21" title="21"><span class="co"># via par().</span></a>
<a class="sourceLine" id="cb42-22" title="22"></a>
<a class="sourceLine" id="cb42-23" title="23"><span class="kw">graphics.off</span>();</a>
<a class="sourceLine" id="cb42-24" title="24"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>);</a>
<a class="sourceLine" id="cb42-25" title="25">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>);</a>
<a class="sourceLine" id="cb42-26" title="26"><span class="kw">par</span>(<span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">19</span>));</a>
<a class="sourceLine" id="cb42-27" title="27"><span class="kw">plot</span>(x);</a>
<a class="sourceLine" id="cb42-28" title="28"><span class="co"># Examine the plot here and then proceed.</span></a>
<a class="sourceLine" id="cb42-29" title="29"><span class="kw">par</span>(<span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">20</span>), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>);</a>
<a class="sourceLine" id="cb42-30" title="30"><span class="kw">plot</span>(x, <span class="dt">main =</span> <span class="st">&quot;This time in red&quot;</span>)</a>
<a class="sourceLine" id="cb42-31" title="31"></a>
<a class="sourceLine" id="cb42-32" title="32"></a>
<a class="sourceLine" id="cb42-33" title="33"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb42-34" title="34"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb42-35" title="35"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb42-36" title="36"></a>
<a class="sourceLine" id="cb42-37" title="37"><span class="co"># 1. Get a new plotting device so that all parameters</span></a>
<a class="sourceLine" id="cb42-38" title="38"><span class="co">#    are at their default values.</span></a>
<a class="sourceLine" id="cb42-39" title="39"></a>
<a class="sourceLine" id="cb42-40" title="40"><span class="co"># 2. x &lt;- seq(2,100, by = 2).</span></a>
<a class="sourceLine" id="cb42-41" title="41"></a>
<a class="sourceLine" id="cb42-42" title="42"><span class="co"># 3. Use the pch argument to par to set the plotting</span></a>
<a class="sourceLine" id="cb42-43" title="43"><span class="co">#    character to 19.</span></a>
<a class="sourceLine" id="cb42-44" title="44"></a>
<a class="sourceLine" id="cb42-45" title="45"><span class="co"># 4. Plot x.</span></a>
<a class="sourceLine" id="cb42-46" title="46"></a>
<a class="sourceLine" id="cb42-47" title="47"><span class="co"># 5. Now set the plotting character to 23 and the</span></a>
<a class="sourceLine" id="cb42-48" title="48"><span class="co">#    plotting colour to &quot;darkred&quot; (the argument to par()</span></a>
<a class="sourceLine" id="cb42-49" title="49"><span class="co">#    for setting the colour is col).</span></a>
<a class="sourceLine" id="cb42-50" title="50"></a>
<a class="sourceLine" id="cb42-51" title="51"><span class="co"># 6. points() is used to add points to an existing</span></a>
<a class="sourceLine" id="cb42-52" title="52"><span class="co">#    plot. Use points to add points for x/2 to the plot.</span></a>
<a class="sourceLine" id="cb42-53" title="53"></a>
<a class="sourceLine" id="cb42-54" title="54"><span class="co"># 7. Use points to add points for x/1.75 to the plot</span></a>
<a class="sourceLine" id="cb42-55" title="55"><span class="co">#    but this time use the argument col = &quot;darkgreen&quot; as</span></a>
<a class="sourceLine" id="cb42-56" title="56"><span class="co">#    well so that they get rendered in dark green.</span></a>
<a class="sourceLine" id="cb42-57" title="57"></a>
<a class="sourceLine" id="cb42-58" title="58"></a></code></pre></div>
<!-- >>> -->
<!-- <<< colours.r -->
<h1 id="colours">Colours</h1>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="co">##########################</span></a>
<a class="sourceLine" id="cb43-3" title="3"><span class="co">### Specifying colours </span><span class="al">###</span></a>
<a class="sourceLine" id="cb43-4" title="4"><span class="co">##########################</span></a>
<a class="sourceLine" id="cb43-5" title="5"></a>
<a class="sourceLine" id="cb43-6" title="6"><span class="co"># Using the 10 digits in base 10 (0 to 9), the highest</span></a>
<a class="sourceLine" id="cb43-7" title="7"><span class="co"># two digit number we can express is 99.</span></a>
<a class="sourceLine" id="cb43-8" title="8"></a>
<a class="sourceLine" id="cb43-9" title="9"><span class="dv">10</span><span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb43-10" title="10"></a>
<a class="sourceLine" id="cb43-11" title="11"><span class="co">### Counting in base 16 (hexadecimal or hex) </span><span class="al">###</span></a>
<a class="sourceLine" id="cb43-12" title="12"></a>
<a class="sourceLine" id="cb43-13" title="13"><span class="co"># Using 16 digits in base 16 (0 to 9 then A to F), the</span></a>
<a class="sourceLine" id="cb43-14" title="14"><span class="co"># highest two digit number we can express is 255.</span></a>
<a class="sourceLine" id="cb43-15" title="15"></a>
<a class="sourceLine" id="cb43-16" title="16"><span class="dv">16</span><span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb43-17" title="17"></a>
<a class="sourceLine" id="cb43-18" title="18"><span class="co"># 0 decimal is 00 in hex and 255 decimal is FF in hex.</span></a>
<a class="sourceLine" id="cb43-19" title="19"></a>
<a class="sourceLine" id="cb43-20" title="20"><span class="co"># In binary, we need 8 bits (one byte) to count upto</span></a>
<a class="sourceLine" id="cb43-21" title="21"><span class="co"># 255.</span></a>
<a class="sourceLine" id="cb43-22" title="22"></a>
<a class="sourceLine" id="cb43-23" title="23"><span class="dv">2</span><span class="op">^</span><span class="dv">8</span></a>
<a class="sourceLine" id="cb43-24" title="24"></a>
<a class="sourceLine" id="cb43-25" title="25"><span class="co"># So two hex digits can be used to express all the</span></a>
<a class="sourceLine" id="cb43-26" title="26"><span class="co"># values possible using a single byte (0 to 255)</span></a>
<a class="sourceLine" id="cb43-27" title="27"></a>
<a class="sourceLine" id="cb43-28" title="28"><span class="co">#  Colours are made by mixing red, green and,</span></a>
<a class="sourceLine" id="cb43-29" title="29"><span class="co">#  blue channels.</span></a>
<a class="sourceLine" id="cb43-30" title="30"></a>
<a class="sourceLine" id="cb43-31" title="31"><span class="co">#  Each channel can be anything from 0 to 255</span></a>
<a class="sourceLine" id="cb43-32" title="32"><span class="co">#  (00 to FF in hex).</span></a>
<a class="sourceLine" id="cb43-33" title="33"></a>
<a class="sourceLine" id="cb43-34" title="34"><span class="co"># An alpha channel can be added for controlling</span></a>
<a class="sourceLine" id="cb43-35" title="35"><span class="co"># transparency of the colour.</span></a>
<a class="sourceLine" id="cb43-36" title="36"></a>
<a class="sourceLine" id="cb43-37" title="37"><span class="co">#  Be careful with the spelling of colo(u)r.</span></a>
<a class="sourceLine" id="cb43-38" title="38"></a>
<a class="sourceLine" id="cb43-39" title="39"><span class="co"># The R function rgb() lets you generate colours without</span></a>
<a class="sourceLine" id="cb43-40" title="40"><span class="co"># the need to think in hex or even on a scale of 0 to</span></a>
<a class="sourceLine" id="cb43-41" title="41"><span class="co"># 255.</span></a>
<a class="sourceLine" id="cb43-42" title="42"></a>
<a class="sourceLine" id="cb43-43" title="43"><span class="co"># Fully opaque red.</span></a>
<a class="sourceLine" id="cb43-44" title="44"><span class="kw">rgb</span>(<span class="dv">255</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dt">maxColorValue =</span> <span class="dv">255</span>);</a>
<a class="sourceLine" id="cb43-45" title="45"><span class="kw">rgb</span>(<span class="dv">255</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">255</span>, <span class="dt">maxColorValue =</span> <span class="dv">255</span>);</a>
<a class="sourceLine" id="cb43-46" title="46"></a>
<a class="sourceLine" id="cb43-47" title="47"><span class="co"># Fully opaque green. maxColorValue defaults to 1.</span></a>
<a class="sourceLine" id="cb43-48" title="48"><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>, <span class="dt">maxColorValue =</span> <span class="dv">1</span>);</a>
<a class="sourceLine" id="cb43-49" title="49"><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>, <span class="dt">maxColorValue =</span> <span class="dv">1</span>);</a>
<a class="sourceLine" id="cb43-50" title="50"></a>
<a class="sourceLine" id="cb43-51" title="51"><span class="co"># Find it easier to think in percent?</span></a>
<a class="sourceLine" id="cb43-52" title="52"><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>, <span class="dt">maxColorValue =</span> <span class="dv">100</span>);</a>
<a class="sourceLine" id="cb43-53" title="53"><span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">100</span>, <span class="dt">maxColorValue =</span> <span class="dv">100</span>);</a>
<a class="sourceLine" id="cb43-54" title="54"></a>
<a class="sourceLine" id="cb43-55" title="55"><span class="kw">barplot</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">col =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb43-56" title="56">  <span class="kw">rgb</span>(<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">0</span>, <span class="dt">maxColorValue =</span> <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb43-57" title="57">  <span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">100</span>,<span class="dv">100</span>, <span class="dt">maxColorValue =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb43-58" title="58">));  </a>
<a class="sourceLine" id="cb43-59" title="59"></a>
<a class="sourceLine" id="cb43-60" title="60"></a>
<a class="sourceLine" id="cb43-61" title="61">reds &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="fl">0.05</span>);</a>
<a class="sourceLine" id="cb43-62" title="62">greens &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="fl">0.1</span>, <span class="fl">-0.05</span>);</a>
<a class="sourceLine" id="cb43-63" title="63">blues &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>);</a>
<a class="sourceLine" id="cb43-64" title="64"></a>
<a class="sourceLine" id="cb43-65" title="65">colmix &lt;-<span class="st"> </span><span class="kw">rgb</span>(reds, greens, blues);</a>
<a class="sourceLine" id="cb43-66" title="66"><span class="kw">names</span>(colmix) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;CO&quot;</span>, <span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(colmix)), <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>);</a>
<a class="sourceLine" id="cb43-67" title="67">colmix</a>
<a class="sourceLine" id="cb43-68" title="68">ht &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">19</span>, <span class="dt">min =</span> <span class="dv">5</span>, <span class="dt">max =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb43-69" title="69"><span class="kw">barplot</span>(ht, <span class="dt">col =</span> colmix)</a>
<a class="sourceLine" id="cb43-70" title="70"></a>
<a class="sourceLine" id="cb43-71" title="71"></a>
<a class="sourceLine" id="cb43-72" title="72"><span class="co">### Colour ramp function generator </span><span class="al">###</span></a>
<a class="sourceLine" id="cb43-73" title="73"></a>
<a class="sourceLine" id="cb43-74" title="74">blured.ramp &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="kw">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb43-75" title="75">                           <span class="dt">alpha =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb43-76" title="76"></a>
<a class="sourceLine" id="cb43-77" title="77">blured.ramp &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(<span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb43-78" title="78">                           <span class="dt">alpha =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb43-79" title="79"></a>
<a class="sourceLine" id="cb43-80" title="80"><span class="kw">class</span>(blured.ramp);</a>
<a class="sourceLine" id="cb43-81" title="81"><span class="kw">typeof</span>(blured.ramp);</a>
<a class="sourceLine" id="cb43-82" title="82"></a>
<a class="sourceLine" id="cb43-83" title="83"><span class="kw">blured.ramp</span>(<span class="dv">19</span>)</a>
<a class="sourceLine" id="cb43-84" title="84">ht &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">19</span>, <span class="dt">min =</span> <span class="dv">5</span>, <span class="dt">max =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb43-85" title="85"><span class="kw">barplot</span>(ht, <span class="dt">col =</span> <span class="kw">blured.ramp</span>(<span class="dv">19</span>))</a>
<a class="sourceLine" id="cb43-86" title="86"></a>
<a class="sourceLine" id="cb43-87" title="87"></a>
<a class="sourceLine" id="cb43-88" title="88"></a>
<a class="sourceLine" id="cb43-89" title="89"><span class="co"># colorRampPalette(c(rgb(0,0,1,1), rgb(1,0,0,1)), alpha = TRUE)(19)</span></a>
<a class="sourceLine" id="cb43-90" title="90"></a>
<a class="sourceLine" id="cb43-91" title="91"></a></code></pre></div>
<!-- >>> -->
<!-- <<< ggplot.r -->
<h1 id="ggplot2">ggplot2</h1>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"></a>
<a class="sourceLine" id="cb44-2" title="2"><span class="co">###############</span></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="co">### ggplot2 </span><span class="al">###</span></a>
<a class="sourceLine" id="cb44-4" title="4"><span class="co">###############</span></a>
<a class="sourceLine" id="cb44-5" title="5"></a>
<a class="sourceLine" id="cb44-6" title="6"><span class="co"># Part of a collection of packages called tidyverse.</span></a>
<a class="sourceLine" id="cb44-7" title="7"></a>
<a class="sourceLine" id="cb44-8" title="8"><span class="co"># The &quot;gg&quot; in ggplot2 stands for Grammar of Graphics.</span></a>
<a class="sourceLine" id="cb44-9" title="9"></a>
<a class="sourceLine" id="cb44-10" title="10"><span class="co"># Much more structured and formal than the collection of</span></a>
<a class="sourceLine" id="cb44-11" title="11"><span class="co"># graphics commands in base R.</span></a>
<a class="sourceLine" id="cb44-12" title="12"></a>
<a class="sourceLine" id="cb44-13" title="13"><span class="co">### The essential components of a ggplot </span><span class="al">###</span></a>
<a class="sourceLine" id="cb44-14" title="14"></a>
<a class="sourceLine" id="cb44-15" title="15"><span class="co"># 1. Data. Usually a dataframe or a tibble.</span></a>
<a class="sourceLine" id="cb44-16" title="16"></a>
<a class="sourceLine" id="cb44-17" title="17"><span class="co"># 2. Aesthetic mappings. Think of them as mapping of</span></a>
<a class="sourceLine" id="cb44-18" title="18"><span class="co"># data to axes and colour and shape of points. Function:</span></a>
<a class="sourceLine" id="cb44-19" title="19"><span class="co"># aes().</span></a>
<a class="sourceLine" id="cb44-20" title="20"></a>
<a class="sourceLine" id="cb44-21" title="21"><span class="co"># 3. Layers. Actual rendering on the plotting device.</span></a>
<a class="sourceLine" id="cb44-22" title="22"><span class="co"># Functions: geom_*(). The kind of plot you want.</span></a>
<a class="sourceLine" id="cb44-23" title="23"><span class="co"># Multiple layers are allowed and indeed, common.</span></a>
<a class="sourceLine" id="cb44-24" title="24"></a>
<a class="sourceLine" id="cb44-25" title="25"><span class="co"># 4. Theme. Control the appearance of various components of the</span></a>
<a class="sourceLine" id="cb44-26" title="26"><span class="co"># plot. Functions theme(), theme_*(), set_theme() etc.</span></a>
<a class="sourceLine" id="cb44-27" title="27"></a>
<a class="sourceLine" id="cb44-28" title="28"><span class="co">### Function ggplot() </span><span class="al">###</span></a>
<a class="sourceLine" id="cb44-29" title="29"></a>
<a class="sourceLine" id="cb44-30" title="30"><span class="co"># Usually called with two arguments, data and aesthetic</span></a>
<a class="sourceLine" id="cb44-31" title="31"><span class="co"># mapping.</span></a>
<a class="sourceLine" id="cb44-32" title="32"></a>
<a class="sourceLine" id="cb44-33" title="33"><span class="co"># Data, of course, is your dataframe and you get an</span></a>
<a class="sourceLine" id="cb44-34" title="34"><span class="co"># aesthetic mapping by calling aes(). Calls to aes() can</span></a>
<a class="sourceLine" id="cb44-35" title="35"><span class="co"># be used as argument to ggplot() or to geom_*(). If</span></a>
<a class="sourceLine" id="cb44-36" title="36"><span class="co"># included in ggplot() the values are inherited by all</span></a>
<a class="sourceLine" id="cb44-37" title="37"><span class="co"># layers.</span></a>
<a class="sourceLine" id="cb44-38" title="38"></a>
<a class="sourceLine" id="cb44-39" title="39"><span class="co"># To the result of the call to ggplot() we can add</span></a>
<a class="sourceLine" id="cb44-40" title="40"><span class="co"># layers.</span></a>
<a class="sourceLine" id="cb44-41" title="41"></a>
<a class="sourceLine" id="cb44-42" title="42"><span class="co"># Finally we can add a theme to the plot before rendering it.</span></a>
<a class="sourceLine" id="cb44-43" title="43"><span class="co"># Otherwise the current theme (which we can change) is used for</span></a>
<a class="sourceLine" id="cb44-44" title="44"><span class="co"># rendering the plot.</span></a>
<a class="sourceLine" id="cb44-45" title="45"></a>
<a class="sourceLine" id="cb44-46" title="46"><span class="co">##########################################</span></a>
<a class="sourceLine" id="cb44-47" title="47"></a>
<a class="sourceLine" id="cb44-48" title="48"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb44-49" title="49">df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/tfaG.csv&quot;</span>);</a>
<a class="sourceLine" id="cb44-50" title="50"><span class="kw">head</span>(df);</a>
<a class="sourceLine" id="cb44-51" title="51"></a>
<a class="sourceLine" id="cb44-52" title="52"><span class="co"># Plot</span></a>
<a class="sourceLine" id="cb44-53" title="53"></a>
<a class="sourceLine" id="cb44-54" title="54"><span class="kw">ggplot</span>(df) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-55" title="55"><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(hour, wt), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-56" title="56"><span class="st">  </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(hour, tfaG), <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb44-57" title="57"></a>
<a class="sourceLine" id="cb44-58" title="58"></a>
<a class="sourceLine" id="cb44-59" title="59"><span class="co"># The above is not the best way to organise your data for</span></a>
<a class="sourceLine" id="cb44-60" title="60"><span class="co"># ggplot2. If you have a dataframe like.</span></a>
<a class="sourceLine" id="cb44-61" title="61"><span class="co"># </span></a>
<a class="sourceLine" id="cb44-62" title="62"><span class="co">#   hour       wt     tfaG</span></a>
<a class="sourceLine" id="cb44-63" title="63"><span class="co"># 1    1 2.597158 2.830137</span></a>
<a class="sourceLine" id="cb44-64" title="64"><span class="co"># 2    2 2.636187 2.800135</span></a>
<a class="sourceLine" id="cb44-65" title="65"><span class="co"># 3    3 2.837971 2.917881</span></a>
<a class="sourceLine" id="cb44-66" title="66"><span class="co"># 4    4 2.711013 2.703749</span></a>
<a class="sourceLine" id="cb44-67" title="67"><span class="co"># 5    5 2.882070 2.838809</span></a>
<a class="sourceLine" id="cb44-68" title="68"><span class="co"># 6    6 2.724614 2.028673</span></a>
<a class="sourceLine" id="cb44-69" title="69"></a>
<a class="sourceLine" id="cb44-70" title="70"></a>
<a class="sourceLine" id="cb44-71" title="71"><span class="co"># Reform it to something like this.</span></a>
<a class="sourceLine" id="cb44-72" title="72"></a>
<a class="sourceLine" id="cb44-73" title="73"><span class="co">#     hour strain  logexpr</span></a>
<a class="sourceLine" id="cb44-74" title="74"><span class="co"># 1      1     wt 2.597158</span></a>
<a class="sourceLine" id="cb44-75" title="75"><span class="co"># 2      2     wt 2.636187</span></a>
<a class="sourceLine" id="cb44-76" title="76"><span class="co"># 3      3     wt 2.837971</span></a>
<a class="sourceLine" id="cb44-77" title="77"><span class="co"># ...</span></a>
<a class="sourceLine" id="cb44-78" title="78"><span class="co"># 118   58   tfaG 2.246144</span></a>
<a class="sourceLine" id="cb44-79" title="79"><span class="co"># 119   59   tfaG 2.755333</span></a>
<a class="sourceLine" id="cb44-80" title="80"><span class="co"># 120   60   tfaG 2.775126</span></a>
<a class="sourceLine" id="cb44-81" title="81"></a>
<a class="sourceLine" id="cb44-82" title="82"><span class="co"># Think like this: everything on the x-axis goes in one column no</span></a>
<a class="sourceLine" id="cb44-83" title="83"><span class="co"># matter how many categories those values belong to. The</span></a>
<a class="sourceLine" id="cb44-84" title="84"><span class="co"># categories can be specified (as factors) in other columns.</span></a>
<a class="sourceLine" id="cb44-85" title="85"><span class="co"># Similarly for the values intended for the y-axis.</span></a>
<a class="sourceLine" id="cb44-86" title="86"></a>
<a class="sourceLine" id="cb44-87" title="87"><span class="co"># Below is one way of getting from df to gdf.</span></a>
<a class="sourceLine" id="cb44-88" title="88"></a>
<a class="sourceLine" id="cb44-89" title="89">gdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb44-90" title="90"> <span class="dt">hour =</span> <span class="kw">rep</span>(df<span class="op">$</span>hour, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb44-91" title="91"> <span class="dt">strain =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="kw">colnames</span>(df)[<span class="dv">2</span>], <span class="dv">60</span>), <span class="kw">rep</span>(<span class="kw">colnames</span>(df)[<span class="dv">3</span>], <span class="dv">60</span>)),</a>
<a class="sourceLine" id="cb44-92" title="92"> <span class="dt">logexpr =</span> <span class="kw">c</span>(df<span class="op">$</span>wt, df<span class="op">$</span>tfaG)</a>
<a class="sourceLine" id="cb44-93" title="93">)</a>
<a class="sourceLine" id="cb44-94" title="94"><span class="kw">head</span>(gdf)</a>
<a class="sourceLine" id="cb44-95" title="95"><span class="kw">class</span>(gdf<span class="op">$</span>strain)</a>
<a class="sourceLine" id="cb44-96" title="96"></a>
<a class="sourceLine" id="cb44-97" title="97"><span class="co">### Plotting begins </span><span class="al">###</span></a>
<a class="sourceLine" id="cb44-98" title="98"></a>
<a class="sourceLine" id="cb44-99" title="99"><span class="kw">ggplot</span>(gdf, <span class="kw">aes</span>(hour, logexpr, <span class="dt">colour =</span> strain)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-100" title="100"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb44-101" title="101"><span class="st">  </span><span class="kw">geom_path</span>()</a>
<a class="sourceLine" id="cb44-102" title="102"></a>
<a class="sourceLine" id="cb44-103" title="103"></a>
<a class="sourceLine" id="cb44-104" title="104"><span class="co"># Suppressing some legends.</span></a>
<a class="sourceLine" id="cb44-105" title="105"><span class="kw">ggplot</span>(gdf, <span class="kw">aes</span>(hour, logexpr, <span class="dt">colour =</span> strain)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-106" title="106"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-107" title="107"><span class="st">  </span><span class="kw">geom_path</span>(<span class="dt">size =</span> <span class="fl">1.2</span>, <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-108" title="108"><span class="st">  </span><span class="kw">theme_bw</span>()</a>
<a class="sourceLine" id="cb44-109" title="109"></a>
<a class="sourceLine" id="cb44-110" title="110"></a>
<a class="sourceLine" id="cb44-111" title="111"><span class="co">### You can save intermediate plot objects.</span></a>
<a class="sourceLine" id="cb44-112" title="112"></a>
<a class="sourceLine" id="cb44-113" title="113">gdfcols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#bb0000&quot;</span>, <span class="st">&quot;#00bb00&quot;</span>);</a>
<a class="sourceLine" id="cb44-114" title="114">p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(gdf, <span class="kw">aes</span>(hour, logexpr, <span class="dt">colour =</span> strain)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-115" title="115"><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-116" title="116"><span class="kw">geom_path</span>(<span class="dt">size =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb44-117" title="117"></a>
<a class="sourceLine" id="cb44-118" title="118">p1 &lt;-<span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;tfag deletion&quot;</span>, <span class="st">&quot;m600&quot;</span>),</a>
<a class="sourceLine" id="cb44-119" title="119"><span class="dt">values =</span> <span class="kw">unname</span>(gdfcols), <span class="dt">name =</span> <span class="st">&quot;Strain&quot;</span>)</a>
<a class="sourceLine" id="cb44-120" title="120"></a>
<a class="sourceLine" id="cb44-121" title="121">p1</a>
<a class="sourceLine" id="cb44-122" title="122"></a>
<a class="sourceLine" id="cb44-123" title="123"><span class="co"># Two ways of suppressing the legend.</span></a>
<a class="sourceLine" id="cb44-124" title="124">p1 <span class="op">+</span><span class="st"> </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="st">&quot;none&quot;</span>);</a>
<a class="sourceLine" id="cb44-125" title="125">p1 <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb44-126" title="126"></a>
<a class="sourceLine" id="cb44-127" title="127"></a>
<a class="sourceLine" id="cb44-128" title="128"><span class="co"># Axis labels and grid lines.</span></a>
<a class="sourceLine" id="cb44-129" title="129">yylab =<span class="st"> </span><span class="kw">expression</span>(<span class="kw">bold</span>(<span class="kw">paste</span>(Log[<span class="dv">2</span>], <span class="st">&quot; Expression&quot;</span>))); <span class="co"># help(plotmath)</span></a>
<a class="sourceLine" id="cb44-130" title="130"></a>
<a class="sourceLine" id="cb44-131" title="131">p2 &lt;-<span class="st"> </span>p1 <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Hours of growth&quot;</span>, <span class="dt">y =</span> yylab)</a>
<a class="sourceLine" id="cb44-132" title="132"></a>
<a class="sourceLine" id="cb44-133" title="133">xbr &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dt">by =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb44-134" title="134">p3 &lt;-<span class="st"> </span>p2 <span class="op">+</span></a>
<a class="sourceLine" id="cb44-135" title="135"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> xbr,</a>
<a class="sourceLine" id="cb44-136" title="136">                     <span class="dt">labels =</span> <span class="kw">paste0</span>(xbr, <span class="st">&quot;h&quot;</span>))</a>
<a class="sourceLine" id="cb44-137" title="137"></a>
<a class="sourceLine" id="cb44-138" title="138">p3</a>
<a class="sourceLine" id="cb44-139" title="139"></a>
<a class="sourceLine" id="cb44-140" title="140"><span class="co"># Main title</span></a>
<a class="sourceLine" id="cb44-141" title="141"></a>
<a class="sourceLine" id="cb44-142" title="142">plot.title &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;Expression of SpoF in M600 and&quot;</span>,</a>
<a class="sourceLine" id="cb44-143" title="143"><span class="st">&quot; tfaG deletion strains&quot;</span>);</a>
<a class="sourceLine" id="cb44-144" title="144">plot.subtitle &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;From 0 to 60 hours&quot;</span>);</a>
<a class="sourceLine" id="cb44-145" title="145"></a>
<a class="sourceLine" id="cb44-146" title="146">p4 &lt;-<span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title =</span> plot.title, <span class="dt">subtitle =</span> plot.subtitle);</a>
<a class="sourceLine" id="cb44-147" title="147"><span class="co"># help(&quot;labs&quot;)</span></a>
<a class="sourceLine" id="cb44-148" title="148">p4</a>
<a class="sourceLine" id="cb44-149" title="149"></a>
<a class="sourceLine" id="cb44-150" title="150"></a>
<a class="sourceLine" id="cb44-151" title="151"></a>
<a class="sourceLine" id="cb44-152" title="152"><span class="co"># Theme (addition).</span></a>
<a class="sourceLine" id="cb44-153" title="153"></a>
<a class="sourceLine" id="cb44-154" title="154">p5 &lt;-<span class="st"> </span>p4 <span class="op">+</span></a>
<a class="sourceLine" id="cb44-155" title="155"><span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb44-156" title="156"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">24</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>,</a>
<a class="sourceLine" id="cb44-157" title="157">                                  <span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-158" title="158"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>,</a>
<a class="sourceLine" id="cb44-159" title="159">                                  <span class="dt">vjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-160" title="160"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>, <span class="dt">face =</span> <span class="st">&quot;plain&quot;</span>,</a>
<a class="sourceLine" id="cb44-161" title="161">                                 <span class="dt">vjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-162" title="162"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>,</a>
<a class="sourceLine" id="cb44-163" title="163">                                   <span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-164" title="164"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="dv">15</span>, <span class="st">&quot;mm&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-165" title="165"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>,</a>
<a class="sourceLine" id="cb44-166" title="166">                                    <span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-167" title="167"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-168" title="168"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb44-169" title="169"></a>
<a class="sourceLine" id="cb44-170" title="170">p5</a>
<a class="sourceLine" id="cb44-171" title="171"><span class="kw">ggsave</span>(<span class="st">&quot;../expression.png&quot;</span>, p5)</a>
<a class="sourceLine" id="cb44-172" title="172"></a>
<a class="sourceLine" id="cb44-173" title="173"></a>
<a class="sourceLine" id="cb44-174" title="174"><span class="co"># Theme (set)</span></a>
<a class="sourceLine" id="cb44-175" title="175"></a>
<a class="sourceLine" id="cb44-176" title="176"><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>());</a>
<a class="sourceLine" id="cb44-177" title="177"><span class="kw">theme_update</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">24</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>,</a>
<a class="sourceLine" id="cb44-178" title="178">                                <span class="dt">hjust =</span> <span class="fl">0.5</span>));</a>
<a class="sourceLine" id="cb44-179" title="179"><span class="kw">theme_update</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">15</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>,</a>
<a class="sourceLine" id="cb44-180" title="180">                                <span class="dt">vjust =</span> <span class="fl">0.5</span>));</a>
<a class="sourceLine" id="cb44-181" title="181"><span class="kw">theme_update</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">face =</span> <span class="st">&quot;plain&quot;</span>,</a>
<a class="sourceLine" id="cb44-182" title="182">                                <span class="dt">vjust =</span> <span class="fl">0.5</span>));</a>
<a class="sourceLine" id="cb44-183" title="183"><span class="kw">theme_update</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">face =</span> <span class="st">&quot;plain&quot;</span>,</a>
<a class="sourceLine" id="cb44-184" title="184">                                <span class="dt">vjust =</span> <span class="fl">0.5</span>));</a>
<a class="sourceLine" id="cb44-185" title="185">febtheme &lt;-<span class="st"> </span><span class="kw">theme_get</span>();</a>
<a class="sourceLine" id="cb44-186" title="186"></a>
<a class="sourceLine" id="cb44-187" title="187"><span class="kw">theme_set</span>(<span class="kw">theme_gray</span>());</a>
<a class="sourceLine" id="cb44-188" title="188">p4</a>
<a class="sourceLine" id="cb44-189" title="189"><span class="kw">theme_set</span>(febtheme);</a>
<a class="sourceLine" id="cb44-190" title="190">p4</a>
<a class="sourceLine" id="cb44-191" title="191"><span class="kw">ggsave</span>(<span class="st">&quot;../ourthemeExpression.png&quot;</span>, p4)</a>
<a class="sourceLine" id="cb44-192" title="192"></a>
<a class="sourceLine" id="cb44-193" title="193"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb44-194" title="194"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb44-195" title="195"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb44-196" title="196"></a>
<a class="sourceLine" id="cb44-197" title="197"><span class="co"># Revert to the default theme.</span></a>
<a class="sourceLine" id="cb44-198" title="198"></a>
<a class="sourceLine" id="cb44-199" title="199"><span class="kw">theme_set</span>(<span class="kw">theme_gray</span>());</a>
<a class="sourceLine" id="cb44-200" title="200"></a>
<a class="sourceLine" id="cb44-201" title="201"><span class="co"># A while back we saved a RDS file named</span></a>
<a class="sourceLine" id="cb44-202" title="202"><span class="co"># unsorted_lfc.rds.</span></a>
<a class="sourceLine" id="cb44-203" title="203"></a>
<a class="sourceLine" id="cb44-204" title="204"><span class="co"># Use readRDS() to read this file into an object named</span></a>
<a class="sourceLine" id="cb44-205" title="205"><span class="co"># ulfc. Determine its class and head() it.</span></a>
<a class="sourceLine" id="cb44-206" title="206"></a>
<a class="sourceLine" id="cb44-207" title="207"><span class="co"># Use ggplot() to plot -(log10(PValue)) on the y-axis against logFC</span></a>
<a class="sourceLine" id="cb44-208" title="208"><span class="co"># on the x-axis. Such is plot is commonly known as a volcano plot.</span></a>
<a class="sourceLine" id="cb44-209" title="209"></a>
<a class="sourceLine" id="cb44-210" title="210"><span class="co"># Below a character vector named udu is being made to indicate</span></a>
<a class="sourceLine" id="cb44-211" title="211"><span class="co"># unchanged, upregulated and, downregulated genes.</span></a>
<a class="sourceLine" id="cb44-212" title="212"></a>
<a class="sourceLine" id="cb44-213" title="213">udu &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;unchanged&quot;</span>, <span class="kw">nrow</span>(ulfc));</a>
<a class="sourceLine" id="cb44-214" title="214">udu[ulfc<span class="op">$</span>logFC <span class="op">&gt;=</span><span class="st"> </span><span class="fl">1.5</span> <span class="op">&amp;</span><span class="st"> </span>ulfc<span class="op">$</span>FDR <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;upregulated&quot;</span>;</a>
<a class="sourceLine" id="cb44-215" title="215">udu[ulfc<span class="op">$</span>logFC <span class="op">&lt;=</span><span class="st"> </span><span class="fl">-1.5</span> <span class="op">&amp;</span><span class="st"> </span>ulfc<span class="op">$</span>FDR <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>] &lt;-<span class="st"> &quot;downregulated&quot;</span>;</a>
<a class="sourceLine" id="cb44-216" title="216"></a>
<a class="sourceLine" id="cb44-217" title="217"><span class="co"># Add the vector udu to ulfc as a column named udu.</span></a>
<a class="sourceLine" id="cb44-218" title="218"></a>
<a class="sourceLine" id="cb44-219" title="219"><span class="co"># Make the same volcano plot as above but use the udu column to</span></a>
<a class="sourceLine" id="cb44-220" title="220"><span class="co"># colour the points.</span></a>
<a class="sourceLine" id="cb44-221" title="221"></a>
<a class="sourceLine" id="cb44-222" title="222"><span class="co"># Finally, add the following horizontal and vertical lines to your plot.</span></a>
<a class="sourceLine" id="cb44-223" title="223"></a>
<a class="sourceLine" id="cb44-224" title="224"><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>), <span class="dt">color =</span> <span class="st">&quot;#dd0000&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb44-225" title="225"><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="op">-</span><span class="kw">log10</span>(<span class="fl">0.05</span>), <span class="dt">color =</span> <span class="st">&quot;#00dd00&quot;</span>)</a>
<a class="sourceLine" id="cb44-226" title="226"></a></code></pre></div>
<!-- >>> -->
<!-- <<< sporelens.r -->
<h1 id="spore-lengths">Spore lengths</h1>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="co">#####################</span></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="co">### Spore Lengths </span><span class="al">###</span></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="co">#####################</span></a>
<a class="sourceLine" id="cb45-5" title="5"></a>
<a class="sourceLine" id="cb45-6" title="6"><span class="co"># Spore lengths were measured in 5 mutants (L, S, T, U,</span></a>
<a class="sourceLine" id="cb45-7" title="7"><span class="co"># V) and the WT of a species of Streptomyces grown in 2</span></a>
<a class="sourceLine" id="cb45-8" title="8"><span class="co"># or 3 different growth media. Now we wish to know what</span></a>
<a class="sourceLine" id="cb45-9" title="9"><span class="co"># effect do the mutations and the growth media have on</span></a>
<a class="sourceLine" id="cb45-10" title="10"><span class="co"># spore lengths.</span></a>
<a class="sourceLine" id="cb45-11" title="11"></a>
<a class="sourceLine" id="cb45-12" title="12"><span class="co"># In the directory named spores there are files named</span></a>
<a class="sourceLine" id="cb45-13" title="13"><span class="co"># L1, L2, S1, S2, S3, T1, T2, U1, U2, U3, V1, V2, V3,</span></a>
<a class="sourceLine" id="cb45-14" title="14"><span class="co"># WT1, WT2. The beginning letters of the filename</span></a>
<a class="sourceLine" id="cb45-15" title="15"><span class="co"># represents the strain and the following digit</span></a>
<a class="sourceLine" id="cb45-16" title="16"><span class="co"># represents the growth medium.</span></a>
<a class="sourceLine" id="cb45-17" title="17"><span class="co">#</span></a>
<a class="sourceLine" id="cb45-18" title="18"><span class="co"># All of these files contain just one column containing</span></a>
<a class="sourceLine" id="cb45-19" title="19"><span class="co"># spore lengths.</span></a>
<a class="sourceLine" id="cb45-20" title="20"></a>
<a class="sourceLine" id="cb45-21" title="21"><span class="co"># Please do the following with me.</span></a>
<a class="sourceLine" id="cb45-22" title="22"></a>
<a class="sourceLine" id="cb45-23" title="23"><span class="kw">list.files</span>();</a>
<a class="sourceLine" id="cb45-24" title="24"><span class="kw">list.dirs</span>();</a>
<a class="sourceLine" id="cb45-25" title="25"><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data/spores&quot;</span>);</a>
<a class="sourceLine" id="cb45-26" title="26"><span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data/spores&quot;</span>, <span class="dt">full.names =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb45-27" title="27"><span class="kw">basename</span>(<span class="st">&quot;data/spores/WT1&quot;</span>);</a>
<a class="sourceLine" id="cb45-28" title="28"></a>
<a class="sourceLine" id="cb45-29" title="29">alist &lt;-<span class="st"> </span><span class="kw">list</span>(); <span class="co"># An empty list;</span></a>
<a class="sourceLine" id="cb45-30" title="30"></a>
<a class="sourceLine" id="cb45-31" title="31"><span class="co"># for loop below.</span></a>
<a class="sourceLine" id="cb45-32" title="32"><span class="cf">for</span>(file <span class="cf">in</span> <span class="kw">list.files</span>(<span class="dt">path =</span> <span class="st">&quot;data/spores&quot;</span>, <span class="dt">full.names =</span> T)) {</a>
<a class="sourceLine" id="cb45-33" title="33">  tf &lt;-<span class="st"> </span><span class="kw">read.delim</span>(file, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;spore.length&quot;</span>), <span class="dt">header =</span> F);</a>
<a class="sourceLine" id="cb45-34" title="34">  id.lst &lt;-<span class="st"> </span><span class="kw">basename</span>(file);</a>
<a class="sourceLine" id="cb45-35" title="35">  alist[[id.lst]] &lt;-<span class="st"> </span>tf<span class="op">$</span>spore.length;</a>
<a class="sourceLine" id="cb45-36" title="36">}</a>
<a class="sourceLine" id="cb45-37" title="37"></a>
<a class="sourceLine" id="cb45-38" title="38"><span class="kw">names</span>(alist);</a>
<a class="sourceLine" id="cb45-39" title="39"><span class="kw">head</span>(alist<span class="op">$</span>L1)</a>
<a class="sourceLine" id="cb45-40" title="40"></a>
<a class="sourceLine" id="cb45-41" title="41"><span class="co"># Use of stack() to get data frame of spore lengths and a factor.</span></a>
<a class="sourceLine" id="cb45-42" title="42">sldf &lt;-<span class="st"> </span><span class="kw">stack</span>(alist);</a>
<a class="sourceLine" id="cb45-43" title="43"><span class="kw">head</span>(sldf);</a>
<a class="sourceLine" id="cb45-44" title="44"><span class="co"># stack() used the column names &quot;values&quot; and &quot;ind&quot; by default.</span></a>
<a class="sourceLine" id="cb45-45" title="45"></a>
<a class="sourceLine" id="cb45-46" title="46"><span class="co"># Change column names.</span></a>
<a class="sourceLine" id="cb45-47" title="47"><span class="kw">colnames</span>(sldf) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;spore.len&quot;</span>, <span class="st">&quot;strain&quot;</span>);</a>
<a class="sourceLine" id="cb45-48" title="48"><span class="kw">head</span>(sldf);</a>
<a class="sourceLine" id="cb45-49" title="49"><span class="kw">class</span>(sldf<span class="op">$</span>strain);</a>
<a class="sourceLine" id="cb45-50" title="50"><span class="kw">levels</span>(sldf<span class="op">$</span>strain);</a>
<a class="sourceLine" id="cb45-51" title="51"></a>
<a class="sourceLine" id="cb45-52" title="52"><span class="co"># At this time the &quot;strain&quot; column contains both the strain as</span></a>
<a class="sourceLine" id="cb45-53" title="53"><span class="co"># well as the growth medium information. Below we separate the</span></a>
<a class="sourceLine" id="cb45-54" title="54"><span class="co"># two into two different factors.</span></a>
<a class="sourceLine" id="cb45-55" title="55"></a>
<a class="sourceLine" id="cb45-56" title="56"><span class="co"># Use of regular expressions below.</span></a>
<a class="sourceLine" id="cb45-57" title="57">str &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot;</span><span class="ch">\\</span><span class="st">d+$&quot;</span>, <span class="st">&quot;&quot;</span>, sldf<span class="op">$</span>strain, <span class="dt">perl =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb45-58" title="58">medium &lt;-<span class="st"> </span><span class="kw">sub</span>(<span class="st">&quot;^[A-Z]+&quot;</span>, <span class="st">&quot;M&quot;</span>, sldf<span class="op">$</span>strain, <span class="dt">perl =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb45-59" title="59"></a>
<a class="sourceLine" id="cb45-60" title="60">sldf<span class="op">$</span>strain &lt;-<span class="st"> </span><span class="kw">factor</span>(str);</a>
<a class="sourceLine" id="cb45-61" title="61">sldf<span class="op">$</span>medium &lt;-<span class="st"> </span><span class="kw">factor</span>(medium);</a>
<a class="sourceLine" id="cb45-62" title="62"><span class="kw">head</span>(sldf);</a>
<a class="sourceLine" id="cb45-63" title="63"></a>
<a class="sourceLine" id="cb45-64" title="64"><span class="co"># Now we have the data in a form that can be used in</span></a>
<a class="sourceLine" id="cb45-65" title="65"><span class="co"># function calls. We are going to use this data for plotting</span></a>
<a class="sourceLine" id="cb45-66" title="66"><span class="co"># but this form of data is also the form you need if you</span></a>
<a class="sourceLine" id="cb45-67" title="67"><span class="co"># wish to do ANOVA.</span></a>
<a class="sourceLine" id="cb45-68" title="68"></a>
<a class="sourceLine" id="cb45-69" title="69"><span class="co"># Run aov() and anova()</span></a>
<a class="sourceLine" id="cb45-70" title="70"><span class="co"># medium.aov &lt;- aov(spore.len ~ medium, data = sldf);</span></a>
<a class="sourceLine" id="cb45-71" title="71"><span class="co"># anova(medium.aov);</span></a>
<a class="sourceLine" id="cb45-72" title="72"><span class="co">#</span></a>
<a class="sourceLine" id="cb45-73" title="73"><span class="co"># strain.aov &lt;- aov(spore.len ~ strain, data = sldf);</span></a>
<a class="sourceLine" id="cb45-74" title="74"><span class="co"># anova(strain.aov)</span></a>
<a class="sourceLine" id="cb45-75" title="75"></a>
<a class="sourceLine" id="cb45-76" title="76"></a>
<a class="sourceLine" id="cb45-77" title="77"><span class="co"># Scatter plot spore.len against medium</span></a>
<a class="sourceLine" id="cb45-78" title="78"><span class="kw">ggplot</span>(sldf, <span class="kw">aes</span>(<span class="dt">x =</span> medium, <span class="dt">y =</span> spore.len,</a>
<a class="sourceLine" id="cb45-79" title="79">                 <span class="dt">colour =</span> medium)) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-80" title="80"><span class="st">  </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb45-81" title="81"></a>
<a class="sourceLine" id="cb45-82" title="82"><span class="co"># Scatter plot log2(spore.len) against medium</span></a>
<a class="sourceLine" id="cb45-83" title="83"><span class="kw">ggplot</span>(sldf, <span class="kw">aes</span>(<span class="dt">x =</span> medium, <span class="dt">y =</span> <span class="kw">log2</span>(spore.len),</a>
<a class="sourceLine" id="cb45-84" title="84">                 <span class="dt">colour =</span> medium)) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-85" title="85"><span class="st">  </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb45-86" title="86"></a>
<a class="sourceLine" id="cb45-87" title="87"><span class="co"># Scatter plot log2(spore.len) against strain</span></a>
<a class="sourceLine" id="cb45-88" title="88"><span class="kw">ggplot</span>(sldf, <span class="kw">aes</span>(<span class="dt">x =</span> strain, <span class="dt">y =</span> <span class="kw">log2</span>(spore.len),</a>
<a class="sourceLine" id="cb45-89" title="89">                 <span class="dt">colour =</span> strain)) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-90" title="90"><span class="st">  </span><span class="kw">geom_point</span>()</a>
<a class="sourceLine" id="cb45-91" title="91"></a>
<a class="sourceLine" id="cb45-92" title="92"><span class="co"># Separate boxplots of spore.len against growth medium</span></a>
<a class="sourceLine" id="cb45-93" title="93"><span class="co"># using facet_wrap().</span></a>
<a class="sourceLine" id="cb45-94" title="94"><span class="kw">ggplot</span>(sldf, <span class="kw">aes</span>(<span class="dt">x =</span> medium, <span class="dt">y =</span> <span class="kw">log2</span>(spore.len),</a>
<a class="sourceLine" id="cb45-95" title="95">                 <span class="dt">colour =</span> medium, <span class="dt">fill =</span> medium)) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-96" title="96"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>strain)</a>
<a class="sourceLine" id="cb45-97" title="97"></a>
<a class="sourceLine" id="cb45-98" title="98"></a>
<a class="sourceLine" id="cb45-99" title="99"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb45-100" title="100"><span class="co">### Do the following yourself </span><span class="al">###</span></a>
<a class="sourceLine" id="cb45-101" title="101"><span class="co">#################################</span></a>
<a class="sourceLine" id="cb45-102" title="102"></a>
<a class="sourceLine" id="cb45-103" title="103"><span class="co"># 1. Make a boxplot keeping the x axis as strain but</span></a>
<a class="sourceLine" id="cb45-104" title="104"><span class="co"># changing colour and fill to medium. (Don&#39;t use</span></a>
<a class="sourceLine" id="cb45-105" title="105"><span class="co"># facet_wrap()).</span></a>
<a class="sourceLine" id="cb45-106" title="106"></a>
<a class="sourceLine" id="cb45-107" title="107"><span class="co"># 2. Make another boxplot keeping the x axis as medium</span></a>
<a class="sourceLine" id="cb45-108" title="108"><span class="co"># and changing colour and fill to strain.</span></a>
<a class="sourceLine" id="cb45-109" title="109"></a>
<a class="sourceLine" id="cb45-110" title="110"><span class="co"># 3. How can you keep both the above plots in view so</span></a>
<a class="sourceLine" id="cb45-111" title="111"><span class="co"># that you can compare them?</span></a>
<a class="sourceLine" id="cb45-112" title="112"></a>
<a class="sourceLine" id="cb45-113" title="113"><span class="co"># 4. Try geom_violin() instead of geom_boxplot().</span></a>
<a class="sourceLine" id="cb45-114" title="114"></a>
<a class="sourceLine" id="cb45-115" title="115"></a>
<a class="sourceLine" id="cb45-116" title="116">crpfun &lt;-<span class="st"> </span><span class="kw">colorRampPalette</span>(</a>
<a class="sourceLine" id="cb45-117" title="117">  <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;brown&quot;</span>, <span class="st">&quot;violet&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</a>
<a class="sourceLine" id="cb45-118" title="118">    <span class="dt">alpha =</span> <span class="ot">FALSE</span>, <span class="dt">space =</span> <span class="st">&quot;Lab&quot;</span>);</a>
<a class="sourceLine" id="cb45-119" title="119"><span class="kw">crpfun</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb45-120" title="120"></a>
<a class="sourceLine" id="cb45-121" title="121"><span class="kw">ggplot</span>(sldf, <span class="kw">aes</span>(<span class="dt">x =</span> medium, <span class="dt">y =</span> <span class="kw">log2</span>(spore.len),</a>
<a class="sourceLine" id="cb45-122" title="122">                 <span class="dt">colour =</span> strain, <span class="dt">fill =</span> strain)) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-123" title="123"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb45-124" title="124"><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> (<span class="kw">crpfun</span>(<span class="dv">6</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-125" title="125"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> (<span class="kw">crpfun</span>(<span class="dv">6</span>)))</a>
<a class="sourceLine" id="cb45-126" title="126"></a>
<a class="sourceLine" id="cb45-127" title="127"></a>
<a class="sourceLine" id="cb45-128" title="128"><span class="co"># Do we have enough data? Plotting counts.</span></a>
<a class="sourceLine" id="cb45-129" title="129"><span class="co"># geom_bar() counts.</span></a>
<a class="sourceLine" id="cb45-130" title="130"></a>
<a class="sourceLine" id="cb45-131" title="131"><span class="kw">ggplot</span>(sldf, <span class="kw">aes</span>(<span class="dt">x =</span> medium)) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-132" title="132"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">colour =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-133" title="133"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>strain)</a>
<a class="sourceLine" id="cb45-134" title="134"></a>
<a class="sourceLine" id="cb45-135" title="135"><span class="kw">ggplot</span>(sldf, <span class="kw">aes</span>(<span class="dt">x =</span> strain)) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-136" title="136"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">colour =</span> <span class="st">&quot;brown&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;brown&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-137" title="137"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>medium)</a>
<a class="sourceLine" id="cb45-138" title="138"></a>
<a class="sourceLine" id="cb45-139" title="139"><span class="co"># geom_col() does not count. Use this if you have</span></a>
<a class="sourceLine" id="cb45-140" title="140"><span class="co"># counts.</span></a>
<a class="sourceLine" id="cb45-141" title="141"></a>
<a class="sourceLine" id="cb45-142" title="142">countvec &lt;-<span class="st"> </span><span class="kw">integer</span>();</a>
<a class="sourceLine" id="cb45-143" title="143"><span class="cf">for</span>(s <span class="cf">in</span> <span class="kw">levels</span>(sldf<span class="op">$</span>strain)) {</a>
<a class="sourceLine" id="cb45-144" title="144">s.count &lt;-<span class="st"> </span><span class="kw">nrow</span>(<span class="kw">subset</span>(sldf, strain <span class="op">==</span><span class="st"> </span>s))</a>
<a class="sourceLine" id="cb45-145" title="145">countvec[s] =<span class="st"> </span>s.count;</a>
<a class="sourceLine" id="cb45-146" title="146">}</a>
<a class="sourceLine" id="cb45-147" title="147">countvec</a>
<a class="sourceLine" id="cb45-148" title="148"></a>
<a class="sourceLine" id="cb45-149" title="149">cdf &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">count =</span> countvec, <span class="dt">strain =</span> <span class="kw">names</span>(countvec))</a>
<a class="sourceLine" id="cb45-150" title="150">cdf</a>
<a class="sourceLine" id="cb45-151" title="151"></a>
<a class="sourceLine" id="cb45-152" title="152"><span class="co"># Or</span></a>
<a class="sourceLine" id="cb45-153" title="153">cdf &lt;-<span class="st"> </span><span class="kw">stack</span>(countvec);</a>
<a class="sourceLine" id="cb45-154" title="154"><span class="kw">colnames</span>(cdf) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;count&quot;</span>, <span class="st">&quot;strain&quot;</span>);</a>
<a class="sourceLine" id="cb45-155" title="155">cdf</a>
<a class="sourceLine" id="cb45-156" title="156"></a>
<a class="sourceLine" id="cb45-157" title="157"></a>
<a class="sourceLine" id="cb45-158" title="158"><span class="kw">ggplot</span>(cdf, <span class="kw">aes</span>(<span class="dt">x =</span> strain, <span class="dt">y =</span> count)) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-159" title="159"><span class="st">  </span><span class="kw">geom_col</span>()</a>
<a class="sourceLine" id="cb45-160" title="160"></a>
<a class="sourceLine" id="cb45-161" title="161"></a></code></pre></div>
<!-- >>> -->
<!-- <<< images.r -->
<h1 id="basic-image-manipulation">Basic image manipulation</h1>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1"></a>
<a class="sourceLine" id="cb46-2" title="2"><span class="co">###############</span></a>
<a class="sourceLine" id="cb46-3" title="3"><span class="co">### EBImage </span><span class="al">###</span></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="co">###############</span></a>
<a class="sourceLine" id="cb46-5" title="5"></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="kw">library</span>(<span class="st">&quot;EBImage&quot;</span>);</a>
<a class="sourceLine" id="cb46-7" title="7"></a>
<a class="sourceLine" id="cb46-8" title="8"><span class="kw">options</span>(<span class="dt">EBImage.display =</span> <span class="st">&quot;raster&quot;</span>);</a>
<a class="sourceLine" id="cb46-9" title="9"><span class="kw">x11</span>(<span class="dt">type =</span> <span class="st">&quot;cairo&quot;</span>)</a>
<a class="sourceLine" id="cb46-10" title="10"></a>
<a class="sourceLine" id="cb46-11" title="11">cfinch &lt;-<span class="st"> </span><span class="kw">readImage</span>(<span class="st">&quot;data/goldfinch.jpg&quot;</span>);</a>
<a class="sourceLine" id="cb46-12" title="12">gfinch &lt;-<span class="st"> </span><span class="kw">readImage</span>(<span class="st">&quot;data/grayfinch.jpg&quot;</span>);</a>
<a class="sourceLine" id="cb46-13" title="13"></a>
<a class="sourceLine" id="cb46-14" title="14"><span class="co"># Brightness</span></a>
<a class="sourceLine" id="cb46-15" title="15"></a>
<a class="sourceLine" id="cb46-16" title="16">brighter &lt;-<span class="st"> </span>gfinch <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>;</a>
<a class="sourceLine" id="cb46-17" title="17">darker &lt;-<span class="st"> </span>gfinch <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>;</a>
<a class="sourceLine" id="cb46-18" title="18"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>));</a>
<a class="sourceLine" id="cb46-19" title="19"><span class="kw">display</span>(gfinch);</a>
<a class="sourceLine" id="cb46-20" title="20"><span class="kw">display</span>(brighter);</a>
<a class="sourceLine" id="cb46-21" title="21"><span class="kw">display</span>(darker);</a>
<a class="sourceLine" id="cb46-22" title="22"></a>
<a class="sourceLine" id="cb46-23" title="23">dark1 &lt;-<span class="st"> </span>cfinch <span class="op">-</span><span class="st"> </span><span class="fl">0.1</span>;</a>
<a class="sourceLine" id="cb46-24" title="24">dark2 &lt;-<span class="st"> </span>cfinch <span class="op">-</span><span class="st"> </span><span class="fl">0.2</span>;</a>
<a class="sourceLine" id="cb46-25" title="25"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>));</a>
<a class="sourceLine" id="cb46-26" title="26"><span class="kw">display</span>(cfinch);</a>
<a class="sourceLine" id="cb46-27" title="27"><span class="kw">display</span>(dark1);</a>
<a class="sourceLine" id="cb46-28" title="28"><span class="kw">display</span>(dark2);</a>
<a class="sourceLine" id="cb46-29" title="29"></a>
<a class="sourceLine" id="cb46-30" title="30"><span class="co"># Image object to file</span></a>
<a class="sourceLine" id="cb46-31" title="31"></a>
<a class="sourceLine" id="cb46-32" title="32"><span class="kw">writeImage</span>(dark2, <span class="st">&quot;darkfinch.jpg&quot;</span>, <span class="st">&quot;jpeg&quot;</span>, <span class="dt">quality =</span> <span class="dv">70</span>) </a>
<a class="sourceLine" id="cb46-33" title="33"></a>
<a class="sourceLine" id="cb46-34" title="34"><span class="co"># Cropping</span></a>
<a class="sourceLine" id="cb46-35" title="35"></a>
<a class="sourceLine" id="cb46-36" title="36">headfinch &lt;-<span class="st"> </span>dark1[<span class="dv">100</span><span class="op">:</span><span class="dv">500</span>, <span class="dv">10</span><span class="op">:</span><span class="dv">180</span>,]</a>
<a class="sourceLine" id="cb46-37" title="37"></a>
<a class="sourceLine" id="cb46-38" title="38"><span class="co"># Adding text to image</span></a>
<a class="sourceLine" id="cb46-39" title="39"></a>
<a class="sourceLine" id="cb46-40" title="40"><span class="kw">x11</span>(<span class="dt">type =</span> <span class="st">&quot;cairo&quot;</span>);</a>
<a class="sourceLine" id="cb46-41" title="41"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>));</a>
<a class="sourceLine" id="cb46-42" title="42"><span class="kw">display</span>(dark1)</a>
<a class="sourceLine" id="cb46-43" title="43"><span class="kw">text</span>(<span class="dv">650</span>, <span class="dv">30</span>, <span class="dt">labels =</span> <span class="st">&quot;Goldfinch on wire&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;#eeeeee&quot;</span>,</a>
<a class="sourceLine" id="cb46-44" title="44"><span class="dt">cex =</span> <span class="fl">1.5</span>);</a>
<a class="sourceLine" id="cb46-45" title="45"></a>
<a class="sourceLine" id="cb46-46" title="46"><span class="co"># Display to file</span></a>
<a class="sourceLine" id="cb46-47" title="47"></a>
<a class="sourceLine" id="cb46-48" title="48"><span class="kw">dev.print</span>(jpeg, <span class="dt">filename =</span> <span class="st">&quot;annofinch.jpg&quot;</span>, <span class="dt">width =</span> <span class="kw">dim</span>(dark1)[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb46-49" title="49"><span class="dt">height =</span> <span class="kw">dim</span>(dark1)[<span class="dv">2</span>], <span class="dt">quality =</span> <span class="dv">70</span>);</a>
<a class="sourceLine" id="cb46-50" title="50"></a>
<a class="sourceLine" id="cb46-51" title="51"><span class="co"># Separating channels</span></a>
<a class="sourceLine" id="cb46-52" title="52"></a>
<a class="sourceLine" id="cb46-53" title="53">reds &lt;-<span class="st"> </span><span class="kw">channel</span>(cfinch, <span class="st">&quot;red&quot;</span>);</a>
<a class="sourceLine" id="cb46-54" title="54">greens &lt;-<span class="st"> </span><span class="kw">channel</span>(cfinch, <span class="st">&quot;green&quot;</span>);</a>
<a class="sourceLine" id="cb46-55" title="55">blues &lt;-<span class="st"> </span><span class="kw">channel</span>(cfinch, <span class="st">&quot;blue&quot;</span>);</a>
<a class="sourceLine" id="cb46-56" title="56"></a>
<a class="sourceLine" id="cb46-57" title="57"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>));</a>
<a class="sourceLine" id="cb46-58" title="58"><span class="kw">display</span>(reds);</a>
<a class="sourceLine" id="cb46-59" title="59"><span class="kw">display</span>(greens);</a>
<a class="sourceLine" id="cb46-60" title="60"><span class="kw">display</span>(blues);</a>
<a class="sourceLine" id="cb46-61" title="61"></a>
<a class="sourceLine" id="cb46-62" title="62"><span class="co"># Combining channels</span></a>
<a class="sourceLine" id="cb46-63" title="63"></a>
<a class="sourceLine" id="cb46-64" title="64">blen &lt;-<span class="st"> </span>blues <span class="op">-</span><span class="st"> </span><span class="fl">0.17</span></a>
<a class="sourceLine" id="cb46-65" title="65">blu.en &lt;-<span class="st"> </span><span class="kw">rgbImage</span>(reds, greens, blen);</a>
<a class="sourceLine" id="cb46-66" title="66"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>));</a>
<a class="sourceLine" id="cb46-67" title="67"><span class="kw">display</span>(cfinch)</a>
<a class="sourceLine" id="cb46-68" title="68"><span class="kw">display</span>(blu.en);</a>
<a class="sourceLine" id="cb46-69" title="69"></a></code></pre></div>
<!-- >>> -->
<!-- <<< histograms.r -->
<h1 id="histograms">Histograms</h1>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="co">##################</span></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="co">### Histograms </span><span class="al">###</span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="co">##################</span></a>
<a class="sourceLine" id="cb47-5" title="5"></a>
<a class="sourceLine" id="cb47-6" title="6"><span class="co"># The data in septaldist.csv contains the inter-septal</span></a>
<a class="sourceLine" id="cb47-7" title="7"><span class="co"># distances measured in the wild type and a mutant</span></a>
<a class="sourceLine" id="cb47-8" title="8"><span class="co"># strain of Streptomyces. The first column contains the</span></a>
<a class="sourceLine" id="cb47-9" title="9"><span class="co"># distances in μm and the second column contains either</span></a>
<a class="sourceLine" id="cb47-10" title="10"><span class="co"># &quot;wt&quot; or &quot;mut&quot; (factor).</span></a>
<a class="sourceLine" id="cb47-11" title="11"></a>
<a class="sourceLine" id="cb47-12" title="12"><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>());</a>
<a class="sourceLine" id="cb47-13" title="13"></a>
<a class="sourceLine" id="cb47-14" title="14">df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/septaldist.csv&quot;</span>);</a>
<a class="sourceLine" id="cb47-15" title="15"><span class="kw">head</span>(df)</a>
<a class="sourceLine" id="cb47-16" title="16"><span class="kw">tail</span>(df)</a>
<a class="sourceLine" id="cb47-17" title="17">wt &lt;-<span class="st"> </span>df[df<span class="op">$</span>strain <span class="op">==</span><span class="st"> &quot;wt&quot;</span>, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb47-18" title="18">mut &lt;-<span class="st"> </span>df[df<span class="op">$</span>strain <span class="op">==</span><span class="st"> &quot;mut&quot;</span>, <span class="dv">1</span>]</a>
<a class="sourceLine" id="cb47-19" title="19"></a>
<a class="sourceLine" id="cb47-20" title="20"><span class="co"># We have the two vectors made above and we wish to plot</span></a>
<a class="sourceLine" id="cb47-21" title="21"><span class="co"># their histograms next to each other so that we can see</span></a>
<a class="sourceLine" id="cb47-22" title="22"><span class="co"># the overlap between them. hist() has an argument named</span></a>
<a class="sourceLine" id="cb47-23" title="23"><span class="co"># add which adds to an existing histogram rather than</span></a>
<a class="sourceLine" id="cb47-24" title="24"><span class="co"># plot a new one. So we decide to use this.</span></a>
<a class="sourceLine" id="cb47-25" title="25"></a>
<a class="sourceLine" id="cb47-26" title="26"><span class="kw">hist</span>(wt, <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="st">&quot;#00009955&quot;</span>,</a>
<a class="sourceLine" id="cb47-27" title="27">     <span class="dt">main =</span> <span class="st">&quot;Histograms of WT and Mutant&quot;</span>);</a>
<a class="sourceLine" id="cb47-28" title="28"></a>
<a class="sourceLine" id="cb47-29" title="29"><span class="co"># Notice the add argument below.</span></a>
<a class="sourceLine" id="cb47-30" title="30"><span class="kw">hist</span>(mut, <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="st">&quot;#00990055&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb47-31" title="31"></a>
<a class="sourceLine" id="cb47-32" title="32"></a>
<a class="sourceLine" id="cb47-33" title="33"><span class="co"># Most of the histogram for the mutant is beyond the</span></a>
<a class="sourceLine" id="cb47-34" title="34"><span class="co"># limit of the x axis. So we decide to extend the limits</span></a>
<a class="sourceLine" id="cb47-35" title="35"><span class="co"># of the x-axis.</span></a>
<a class="sourceLine" id="cb47-36" title="36"></a>
<a class="sourceLine" id="cb47-37" title="37"><span class="kw">hist</span>(wt, <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="st">&quot;#00009955&quot;</span>,</a>
<a class="sourceLine" id="cb47-38" title="38">     <span class="dt">xlim =</span> <span class="kw">c</span>( <span class="kw">min</span>(<span class="kw">c</span>(wt,mut)), <span class="kw">max</span>(<span class="kw">c</span>(wt,mut)) ),</a>
<a class="sourceLine" id="cb47-39" title="39">     <span class="dt">main =</span> <span class="st">&quot;Histograms of WT and Mutant&quot;</span>);</a>
<a class="sourceLine" id="cb47-40" title="40"><span class="kw">hist</span>(mut, <span class="dt">breaks =</span> <span class="dv">30</span>, <span class="dt">col =</span> <span class="st">&quot;#00990055&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb47-41" title="41"></a>
<a class="sourceLine" id="cb47-42" title="42"><span class="co"># Now we are losing the tops of the central bars of the</span></a>
<a class="sourceLine" id="cb47-43" title="43"><span class="co"># mutant histogram. So we need to extend the y-axis as</span></a>
<a class="sourceLine" id="cb47-44" title="44"><span class="co"># well. The problem is that the y-axis range gets</span></a>
<a class="sourceLine" id="cb47-45" title="45"><span class="co"># decided in the call to hist(). It cannot be determined</span></a>
<a class="sourceLine" id="cb47-46" title="46"><span class="co"># by the looking at data.</span></a>
<a class="sourceLine" id="cb47-47" title="47"></a>
<a class="sourceLine" id="cb47-48" title="48"><span class="co"># We need to find out the height of the tallest bar in</span></a>
<a class="sourceLine" id="cb47-49" title="49"><span class="co"># the histogram and adjust the upper limit of the y-axis</span></a>
<a class="sourceLine" id="cb47-50" title="50"><span class="co"># before the histogram is actually drawn. For this we</span></a>
<a class="sourceLine" id="cb47-51" title="51"><span class="co"># need to save the return values of the calls to hist()</span></a>
<a class="sourceLine" id="cb47-52" title="52"><span class="co"># and also suppress actual plotting when hist() is</span></a>
<a class="sourceLine" id="cb47-53" title="53"><span class="co"># called.</span></a>
<a class="sourceLine" id="cb47-54" title="54"></a>
<a class="sourceLine" id="cb47-55" title="55">hwt &lt;-<span class="st"> </span><span class="kw">hist</span>(wt, <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb47-56" title="56">hmut &lt;-<span class="st"> </span><span class="kw">hist</span>(mut, <span class="dt">breaks =</span> <span class="dv">30</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>);</a>
<a class="sourceLine" id="cb47-57" title="57"></a>
<a class="sourceLine" id="cb47-58" title="58"><span class="co"># Examine hwt and hmut here.</span></a>
<a class="sourceLine" id="cb47-59" title="59"></a>
<a class="sourceLine" id="cb47-60" title="60">xlm &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">min</span>(<span class="kw">c</span>(wt,mut)), <span class="kw">max</span>(<span class="kw">c</span>(wt,mut)) );</a>
<a class="sourceLine" id="cb47-61" title="61">ylm &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">min</span>(<span class="kw">c</span>(hwt<span class="op">$</span>counts, hmut<span class="op">$</span>counts)), <span class="kw">max</span>(<span class="kw">c</span>(hwt<span class="op">$</span>counts, hmut<span class="op">$</span>counts)) );</a>
<a class="sourceLine" id="cb47-62" title="62"></a>
<a class="sourceLine" id="cb47-63" title="63"><span class="kw">plot</span>(hwt, <span class="dt">col =</span> <span class="st">&quot;#00009955&quot;</span>,</a>
<a class="sourceLine" id="cb47-64" title="64">     <span class="dt">xlim =</span> xlm, <span class="dt">ylim =</span> ylm, <span class="dt">xlab =</span> <span class="st">&quot;Septal distance&quot;</span>,</a>
<a class="sourceLine" id="cb47-65" title="65">     <span class="dt">main =</span> <span class="st">&quot;Histograms of WT and Mutant&quot;</span></a>
<a class="sourceLine" id="cb47-66" title="66">);</a>
<a class="sourceLine" id="cb47-67" title="67"></a>
<a class="sourceLine" id="cb47-68" title="68"><span class="kw">plot</span>(hmut, <span class="dt">col =</span> <span class="st">&quot;#00990055&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb47-69" title="69"></a>
<a class="sourceLine" id="cb47-70" title="70"><span class="co">### Putting the final plot in a png file.</span></a>
<a class="sourceLine" id="cb47-71" title="71"></a>
<a class="sourceLine" id="cb47-72" title="72"><span class="kw">png</span>(<span class="dt">filename =</span> <span class="st">&quot;../intersept.png&quot;</span>, <span class="dt">width =</span> <span class="dv">1200</span>, <span class="dt">height =</span> <span class="dv">800</span>);</a>
<a class="sourceLine" id="cb47-73" title="73"><span class="kw">plot</span>(hwt, <span class="dt">col =</span> <span class="st">&quot;#00009955&quot;</span>,</a>
<a class="sourceLine" id="cb47-74" title="74">     <span class="dt">xlim =</span> xlm, <span class="dt">ylim =</span> ylm, <span class="dt">xlab =</span> <span class="st">&quot;Septal distance&quot;</span>,</a>
<a class="sourceLine" id="cb47-75" title="75">     <span class="dt">main =</span> <span class="st">&quot;Histograms of WT and Mutant&quot;</span></a>
<a class="sourceLine" id="cb47-76" title="76">);</a>
<a class="sourceLine" id="cb47-77" title="77"></a>
<a class="sourceLine" id="cb47-78" title="78"><span class="kw">plot</span>(hmut, <span class="dt">col =</span> <span class="st">&quot;#00990055&quot;</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>);</a>
<a class="sourceLine" id="cb47-79" title="79"><span class="kw">dev.off</span>()</a>
<a class="sourceLine" id="cb47-80" title="80"></a>
<a class="sourceLine" id="cb47-81" title="81"><span class="co"># There are similar functions for jpeg, tiff, pdf,</span></a>
<a class="sourceLine" id="cb47-82" title="82"><span class="co"># postscript (ps) etc.</span></a>
<a class="sourceLine" id="cb47-83" title="83"><span class="co">#</span></a>
<a class="sourceLine" id="cb47-84" title="84"><span class="co"># Journals often want Encapsulated Postscript (eps) files.</span></a>
<a class="sourceLine" id="cb47-85" title="85"><span class="co"># setEPS() calls ps.options() with reasonable defaults.</span></a>
<a class="sourceLine" id="cb47-86" title="86"><span class="co"># Then you can call postscript() just like you called</span></a>
<a class="sourceLine" id="cb47-87" title="87"><span class="co"># png() above to get an eps file of your plot.</span></a>
<a class="sourceLine" id="cb47-88" title="88"></a>
<a class="sourceLine" id="cb47-89" title="89"></a>
<a class="sourceLine" id="cb47-90" title="90"><span class="co">### Using ggplot2 </span><span class="al">###</span></a>
<a class="sourceLine" id="cb47-91" title="91"></a>
<a class="sourceLine" id="cb47-92" title="92"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(sep.dist, <span class="dt">fill =</span> strain)) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-93" title="93"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">bins =</span> <span class="dv">60</span>, <span class="dt">colour =</span> <span class="st">&quot;grey80&quot;</span>)</a>
<a class="sourceLine" id="cb47-94" title="94"></a>
<a class="sourceLine" id="cb47-95" title="95"><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(sep.dist, <span class="dt">fill =</span> strain)) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-96" title="96"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">bins =</span> <span class="dv">40</span>, <span class="dt">colour =</span> <span class="st">&quot;grey80&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-97" title="97"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>strain)</a>
<a class="sourceLine" id="cb47-98" title="98"></a>
<a class="sourceLine" id="cb47-99" title="99"></a>
<a class="sourceLine" id="cb47-100" title="100">h1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(sep.dist, <span class="dt">fill =</span> strain)) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-101" title="101"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">bins =</span> <span class="dv">60</span>, <span class="dt">color =</span> <span class="st">&quot;grey70&quot;</span>)</a>
<a class="sourceLine" id="cb47-102" title="102">h1</a>
<a class="sourceLine" id="cb47-103" title="103"></a>
<a class="sourceLine" id="cb47-104" title="104"></a>
<a class="sourceLine" id="cb47-105" title="105"><span class="co"># Main title</span></a>
<a class="sourceLine" id="cb47-106" title="106">mt &lt;-<span class="st"> &quot;Histogram of interseptal distances in mutant&quot;</span></a>
<a class="sourceLine" id="cb47-107" title="107">mt &lt;-<span class="st"> </span><span class="kw">paste</span>(mt, <span class="st">&quot;and wild type strains&quot;</span>);</a>
<a class="sourceLine" id="cb47-108" title="108"></a>
<a class="sourceLine" id="cb47-109" title="109"><span class="co"># Axis labels</span></a>
<a class="sourceLine" id="cb47-110" title="110">h1 &lt;-<span class="st"> </span>h1 <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Interseptal Distance&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Count&quot;</span>,</a>
<a class="sourceLine" id="cb47-111" title="111">                <span class="dt">title =</span> mt);</a>
<a class="sourceLine" id="cb47-112" title="112">h1</a>
<a class="sourceLine" id="cb47-113" title="113"></a>
<a class="sourceLine" id="cb47-114" title="114">h2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(strain, sep.dist, <span class="dt">colour =</span> strain)) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-115" title="115"><span class="st">  </span><span class="kw">geom_boxplot</span>()</a>
<a class="sourceLine" id="cb47-116" title="116"></a>
<a class="sourceLine" id="cb47-117" title="117">h3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(strain, sep.dist, <span class="dt">colour =</span> strain)) <span class="op">+</span></a>
<a class="sourceLine" id="cb47-118" title="118"><span class="st">  </span><span class="kw">geom_violin</span>()</a>
<a class="sourceLine" id="cb47-119" title="119"></a>
<a class="sourceLine" id="cb47-120" title="120"></a>
<a class="sourceLine" id="cb47-121" title="121"><span class="co"># Writing ggplot2 objects to a file.</span></a>
<a class="sourceLine" id="cb47-122" title="122"></a>
<a class="sourceLine" id="cb47-123" title="123">pdffn &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;../hist123.pdf&quot;</span>);</a>
<a class="sourceLine" id="cb47-124" title="124"><span class="kw">pdf</span>(pdffn)</a>
<a class="sourceLine" id="cb47-125" title="125"><span class="kw">print</span>(h1)</a>
<a class="sourceLine" id="cb47-126" title="126"><span class="kw">print</span>(h2)</a>
<a class="sourceLine" id="cb47-127" title="127"><span class="kw">print</span>(h3)</a>
<a class="sourceLine" id="cb47-128" title="128"><span class="kw">dev.off</span>()</a>
<a class="sourceLine" id="cb47-129" title="129"></a>
<a class="sourceLine" id="cb47-130" title="130"><span class="co"># ggsave()</span></a>
<a class="sourceLine" id="cb47-131" title="131"></a>
<a class="sourceLine" id="cb47-132" title="132">pdffn &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;../hist1.pdf&quot;</span>);</a>
<a class="sourceLine" id="cb47-133" title="133"><span class="kw">ggsave</span>(pdffn, h1) <span class="co"># One plot only.</span></a></code></pre></div>
<!-- >>> -->
<!-- <<< close.md -->
<h1 id="closing-comments">Closing comments</h1>
<ul>
<li><p>R is not the most convenient environment for all kinds of data processing.</p></li>
<li><p>Some things might be easier to do in a general purpose programming language such as Perl or Python.</p></li>
<li><p>You can find plenty of help and support for Python and Perl around the NRP.</p></li>
<li><p>Ability to read documentation quickly is more important than you think. Not just in R.</p></li>
<li><p><a href="https://cran.r-project.org/manuals.html">R manuals webpage</a></p></li>
<li><p><a href="https://cran.r-project.org/doc/manuals/r-release/R-intro.pdf">PDF of the Introduction to R book</a></p></li>
<li><p><a href="https://www.tidyverse.org/">Tidyverse (dplyr, tibbles, ggplot and more) documentation</a></p></li>
<li><p><a href="https://f1000research.com/articles/5-1438">RNA-Seq data analysis using edgeR</a></p></li>
</ul>
<!-- >>> -->
<!-- vim: tw=60 nosmartindent fmr=<<<,>>> cms=<!--%s-->
<hr />
</body>
</html>

